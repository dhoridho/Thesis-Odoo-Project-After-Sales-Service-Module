<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<record id="view_assembly_dashboard" model="ir.ui.view">
		<field name="name">view.assembly.dashboard</field>
		<field name="model">product.product</field>
		<field name="priority" eval="500"/>
		<field name="arch" type="xml">
			<tree string="Assembly Production" create="0" edit="1" delete="0" expand="true" js_class="assembly_dashboard_list_view" editable="bottom">
				<field name="id" invisible="1"/>
				<field name="default_code" readonly="1"/>
				<field name="name" string="Product" readonly="1"/>
				<field name="assembly_bom_id" string="Bill of Materials"/>
				<field name="assembly_safety_stock_qty" string="Safety Stock" readonly="1"/>
				<field name="qty_available" string="Available Quantity" optional="show" readonly="1"/>
				<field name="virtual_available" string="Virtual Available" optional="hide" readonly="1"/>
				<field name="free_qty" string="Free Quantity" optional="hide" readonly="1"/>
				<field name="incoming_qty" string="Forecasted Incoming" optional="hide" readonly="1"/>
				<field name="outgoing_qty" string="Forecasted Outgoing" readonly="1"/>
				<field name="uom_id" readonly="1" string="UoM"/>
				<field name="assembly_to_produce_qty" string="To Assembly" readonly="1"/>
				<field name="stock_move_ids" invisible="1">
					<tree>
						<field name="product_qty"/>
						<field name="state"/>
					</tree>
				</field>
				<button name="action_assembly" type="object" string="Assembly" class="btn-primary"/>
			</tree>
		</field>
	</record>

	<record id="view_disassembly_dashboard" model="ir.ui.view">
		<field name="name">view.disassembly.dashboard</field>
		<field name="model">product.product</field>
		<field name="inherit_id" ref="equip3_assembly_operations.view_assembly_dashboard"/>
		<field name="mode">primary</field>
		<field name="priority" eval="500"/>
		<field name="arch" type="xml">
			<xpath expr="//tree" position="attributes">
				<attribute name="string">Disassembly Production</attribute>
			</xpath>
			<xpath expr="//field[@name='assembly_to_produce_qty']" position="attributes">
				<attribute name="invisible">1</attribute>
			</xpath>
			<xpath expr="//button[@name='action_assembly']" position="attributes">
				<attribute name="attrs">{'invisible': [(1, '=', 1)]}</attribute>
			</xpath>
			<xpath expr="//button[@name='action_assembly']" position="after">
				<button name="action_disassembly" type="object" string="Disassembly" class="btn-primary"/>
			</xpath>
		</field>
	</record>

	<record id="view_assembly_dashboard_filter" model="ir.ui.view">
		<field name="name">view.assembly.dashboard.filter</field>
		<field name="model">product.product</field>
		<field name="arch" type="xml">
			<search string="Search Products">
				<field name="produceable_in_assembly"/>
				<filter name="group_product_tmpl_id" string="Variants" context="{'group_by': 'product_tmpl_id'}"/>
		   </search>
		</field>
	</record>

	<record id="action_view_dashboard_assembly" model="ir.actions.act_window">
		<field name="name">Assembly</field>
		<field name="type">ir.actions.act_window</field>
		<field name="res_model">product.product</field>
		<field name="view_mode">tree</field>
		<field name="view_id" ref="equip3_assembly_operations.view_assembly_dashboard"/>
		<field name="search_view_id" ref="equip3_assembly_operations.view_assembly_dashboard_filter"/>
		<field name="target">main</field>
		<field name="context">{
			'from_date': context_today().strftime('%Y-%m-%d'),
			'to_date': (context_today() + relativedelta(days=7)).strftime('%Y-%m-%d'),
			'default_record_type': 'assembly'
		}</field>
		<field name="domain">[('id', 'in', [])]</field>
		<field name="help" type="html">
			<p class="o_view_nocontent_empty_folder">
				No data to display
			</p>
			<p>
				Try to change the period or warehouse, or make sure there is assembly products on product settings.
			</p>
		</field>
	</record>

	<record id="action_view_dashboard_disassembly" model="ir.actions.act_window">
		<field name="name">Disassembly</field>
		<field name="type">ir.actions.act_window</field>
		<field name="res_model">product.product</field>
		<field name="view_mode">tree</field>
		<field name="view_id" ref="equip3_assembly_operations.view_disassembly_dashboard"/>
		<field name="search_view_id" ref="equip3_assembly_operations.view_assembly_dashboard_filter"/>
		<field name="target">main</field>
		<field name="context">{
			'from_date': context_today().strftime('%Y-%m-%d'),
			'to_date': (context_today() + relativedelta(days=7)).strftime('%Y-%m-%d'),
			'default_record_type': 'disassembly'
		}</field>
		<field name="domain">[('id', 'in', [])]</field>
		<field name="help" type="html">
			<p class="o_view_nocontent_empty_folder">
				No data to display
			</p>
			<p>
				Try to change the period or warehouse, or make sure there is disassembly products on product settings.
			</p>
		</field>
	</record>
</odoo>