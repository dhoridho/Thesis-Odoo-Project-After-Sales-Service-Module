<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="view_mrp_resource_calendar_search" model="ir.ui.view">
        <field name="name">view.mrp.resource.calendar.search</field>
        <field name="model">resource.calendar</field>
        <field name="arch" type="xml">
            <search string="Search Working Time">
               <field name="name" string="Working Time"/>
               <field name="company_id" groups="base.group_multi_company"/>
               <separator/>
               <filter string="Archived" name="inactive" domain="[('active', '=', False)]"/>
           </search>
        </field>
    </record>

    <record id="view_mrp_resource_calendar_form" model="ir.ui.view">
        <field name="name">view.mrp.resource.calendar.form</field>
        <field name="model">resource.calendar</field>
        <field name="priority" eval="1000"/>
        <field name="arch" type="xml">
            <form string="Working Time">
                <sheet string="Working Time">
                    <widget name="web_ribbon" text="Archived" bg_color="bg-danger" attrs="{'invisible': [('active', '=', True)]}"/>
                    <div class="oe_button_box" name="button_box">
                        <button name="%(resource.resource_calendar_leaves_action_from_calendar)d" type="action"
                                string="Time Off" icon="fa-plane"
                                class="oe_stat_button"
                                groups="base.group_no_one"/>
                        <button name="%(resource.resource_resource_action_from_calendar)d" type="action"
                                string="Work Resources" icon="fa-cogs"
                                class="oe_stat_button"
                                groups="base.group_user"/>
                    </div>
                    <h1>
                        <field name="name"/>
                    </h1>
                    <group name="resource_details">
                        <group>
                            <field name="active" invisible="1"/>
                            <field name="calendar_type" invisible="1"/>
                            <field name="company_id" groups="base.group_multi_company" invisible="1"/>
                            <field name="mrp_company_id" groups="base.group_multi_company" string="Company"/>
                            <field name="hours_per_day" widget="float_time"/>
                            <field name="tz"/>
                            <field name="source_calendar_id" string="Source Working Times" domain="[('calendar_type', '=', 'default')]"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Working Hours" name="working_hours">
                        <button name="switch_calendar_type" attrs="{'invisible':[('two_weeks_calendar', '=', True)]}" string="Switch to 2 weeks calendar" type="object" confirm="Are you sure you want to switch this calendar to 2 weeks calendar ? All entries will be lost"/>
                        <button name="switch_calendar_type" attrs="{'invisible':[('two_weeks_calendar', '=', False)]}" string="Switch to 1 week calendar" type="object" confirm="Are you sure you want to switch this calendar to 1 week calendar ? All entries will be lost"/>
                        <field name="two_weeks_calendar" invisible="1"/>

                        <group attrs="{'invisible':[('two_weeks_calendar', '=', False)]}">
                            <field name="two_weeks_explanation" nolabel="1"/>
                        </group>
                            <field name="attendance_ids" widget="section_one2many"/>
                        </page>
                        <page string="Global Time Off" name="global_leaves">
                            <field name="global_leave_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="date_from"/>
                                    <field name="date_to"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_mrp_resource_calendar_tree" model="ir.ui.view">
        <field name="name">view.mrp.resource.calendar.tree</field>
        <field name="model">resource.calendar</field>
        <field name="arch" type="xml">
            <tree string="Working Time">
                <field name="name" string="Working Time"/>
                <field name="company_id" groups="base.group_multi_company"/>
                <field name="source_calendar_id" string="Source Working Times"/>
            </tree>
        </field>
    </record>

    <record id="action_view_mrp_resource_calendar" model="ir.actions.act_window">
        <field name="name">MRP Working Times</field>
        <field name="res_model">resource.calendar</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" eval="False"/>
        <field name="search_view_id" ref="view_mrp_resource_calendar_search"/>
        <field name="domain">[('calendar_type', '=', 'mrp')]</field>
        <field name="context">{'default_calendar_type': 'mrp'}</field>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Define working hours and time table that could be scheduled to your project members
          </p>
        </field>
    </record>

    <record id="act_view_mrp_resource_calendar_tree" model="ir.actions.act_window.view">
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_mrp_resource_calendar_tree"/>
        <field name="act_window_id" ref="action_view_mrp_resource_calendar"/>
    </record>

    <record id="act_view_mrp_resource_calendar_form" model="ir.actions.act_window.view">
        <field name="sequence" eval="1"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="view_mrp_resource_calendar_form"/>
        <field name="act_window_id" ref="action_view_mrp_resource_calendar"/>
    </record>

    <menuitem id="menu_action_view_mrp_resource_calendar"
        parent="resource.menu_resource_config"
        action="action_view_mrp_resource_calendar"
        sequence="1"/>

    <record id="resource.action_resource_calendar_form" model="ir.actions.act_window">
        <field name="domain">[('calendar_type', '=', 'default')]</field>
        <field name="context">{'default_calendar_type': 'default'}</field>
    </record>

    <record id="resource_calendar_form_flexible_calendar_schedule" model="ir.ui.view">
        <field name="name">Working Schedule - Flexible Schedule options</field>
        <field name="model">resource.calendar</field>
        <field name="inherit_id" ref="equip3_hr_working_schedule.resource_calendar_form_flexible_calendar_schedule"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='company_id']" position="after">
                <field name="calendar_type" invisible="1"/>
            </xpath>
        </field>
    </record>

</odoo>