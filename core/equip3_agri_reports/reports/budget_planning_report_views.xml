<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="budget_planning_report_document">
        <t t-call="web.internal_layout">
            <div class="page">

                <div class="oe_structure"/>

                <h3><span t-esc="doc.company_id.name"/>: Activity Budget Planning Report</h3>
                <br></br>

                <table class="o_budget_planning_report_header">
                    <tbody>
                        <tr>
                            <td>Estate</td>
                            <td>: <t t-esc="doc.estate_id.display_name"/></td>
                            <td>Company</td>
                            <td>: <t t-esc="doc.company_id.display_name"/></td>
                        </tr>
                        <tr>
                            <td>Division</td>
                            <td>: <t t-esc="doc.division_id.display_name"/></td>
                            <td>Branch</td>
                            <td>: <t t-esc="doc.branch_id.display_name"/></td>
                        </tr>
                        <tr>
                            <td>Year</td>
                            <td>: <t t-esc="doc.year"/></td>
                            <td>Created On</td>
                            <td>: <t t-esc="doc.create_date" t-options="{'widget': 'date'}"/></td>
                        </tr>
                        <tr>
                            <td>Responsible</td>
                            <td>: <t t-esc="doc.user_id.display_name"/></td>
                            <td>Created By</td>
                            <td>: <t t-esc="doc.create_uid.display_name"/></td>
                        </tr>
                    </tbody>
                </table>

                <table class="table table-bordered o_budget_planning_report_line">
                    <thead>
                        <tr>
                            <th>ACTIVITY</th>
                            <th>JANUARY</th>
                            <th>FEBRUARY</th>
                            <th>MARCH</th>
                            <th>APRIL</th>
                            <th>MAY</th>
                            <th>JUNE</th>
                            <th>JULY</th>
                            <th>AUGUST</th>
                            <th>SEPTEMBER</th>
                            <th>OCTOBER</th>
                            <th>NOVEMBER</th>
                            <th>DECEMBER</th>
                            <th class="o_total">TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="total" t-value="{
                            'jan': 0.0, 'feb': 0.0, 'mar': 0.0, 'apr': 0.0, 'may': 0.0, 'jun': 0.0,
                            'jul': 0.0, 'aug': 0.0, 'sep': 0.0, 'oct': 0.0, 'nov': 0.0, 'dec': 0.0,
                            'total': 0.0
                        }"/>
                        <t t-foreach="doc.month_ids" t-as="month">
                            <tr>
                                <td><t t-esc="month.activity_id.display_name"/></td>
                                <td class="o_value"><t t-esc="month.val_jan" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_feb" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_mar" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_apr" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_may" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_jun" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_jul" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_aug" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_sep" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_oct" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_nov" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value"><t t-esc="month.val_dec" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                                <td class="o_value o_total"><t t-esc="month.total" t-options="{'widget': 'monetary', 'display_currency': month.currency_id}"/></td>
                            </tr>
                            <t t-set="total" t-value="{
                                'jan': total['jan'] + month.val_jan, 'feb': total['feb'] + month.val_feb, 'mar': total['mar'] + month.val_mar, 
                                'apr': total['apr'] + month.val_apr, 'may': total['may'] + month.val_may, 'jun': total['jun'] + month.val_jun, 
                                'jul': total['jul'] + month.val_jul, 'aug': total['aug'] + month.val_aug, 'sep': total['sep'] + month.val_sep, 
                                'oct': total['oct'] + month.val_oct, 'nov': total['nov'] + month.val_nov, 'dec': total['dec'] + month.val_dec, 
                                'total': total['total'] + month.total
                            }"/>
                        </t>
                        <tr>
                            <t t-foreach="['', 'jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec', 'total']" t-as="key">
                                <t t-if="key">
                                    <td class="o_value o_total"><t t-esc="total[key]" t-options="{'widget': 'monetary', 'display_currency': doc.company_id.currency_id}"/></td>
                                </t>
                                <t t-else="">
                                    <td class="o_total"><t t-esc="'Total'"/></td>
                                </t>
                            </t>
                        </tr>
                    </tbody>
                </table>

            </div>

            <div class="oe_structure"/>
        </t>
    </template>

    <template id="budget_planning_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="equip3_agri_reports.budget_planning_report_document"/>
            </t>
        </t>
    </template>

    <record id="paperformat_agriculture_budget_planning_report" model="report.paperformat">
        <field name="name">Activity Budget Planning Report Paper</field>
        <field name="format">A4</field>
        <field name="orientation">Landscape</field>
        <field name="margin_top">20</field>
        <field name="margin_bottom">10</field>
        <field name="margin_left">10</field>
        <field name="margin_right">10</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">10</field>
        <field name="dpi">110</field>
    </record>

    <record id="action_print_agriculture_budget_planning_report" model="ir.actions.report">
        <field name="name">Activity Budget Planning Report</field>
        <field name="model">agriculture.budget.planning</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">equip3_agri_reports.budget_planning_report</field>
        <field name="report_file">equip3_agri_reports.budget_planning_report</field>
        <field name="print_report_name">'Activity Budget Planning Report'</field>
        <field name="binding_model_id" ref="equip3_agri_operations.model_agriculture_budget_planning"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="equip3_agri_reports.paperformat_agriculture_budget_planning_report"/>
    </record>

</odoo>