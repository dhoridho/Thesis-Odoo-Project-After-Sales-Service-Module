<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    
    <record id="view_mrp_production_form" model="ir.ui.view">
        <field name="name">view.mrp.production.form</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="equip3_manuf_operations_contd.equip3_mrp_production_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']" position="inside">
                <button string="Journal Entries" type="object"
                    name="action_view_account_moves"
                    class="oe_stat_button" icon="fa-dollar" groups="base.group_no_one"
                    attrs="{'invisible': [('show_valuation', '=', False)]}" />
            </xpath>

            <xpath expr="//group[@name='group_col_2']" position="inside">
                <field name="analytic_tag_ids" optional="hide" groups="analytic.group_analytic_tags" widget="many2many_tags" string= "Analytic Group" required="1" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create': True, 'no_create_edit':True}"/>
            </xpath>
            
            <xpath expr="//notebook" position="inside">
                <page name="cost_details" string="Cost Details" groups="equip3_manuf_accessright_settings.group_mrp_accountant" attrs="{'invisible': [('stock_valuation_layer_ids', '=', [])]}">
                    <field name="stock_valuation_layer_ids">
                        <tree string="Cost Details" default_order="sequence_type,mrp_workorder_id,mrp_consumption_id">
                            <field name="sequence_type" invisible="1"/>
                            <field name="mrp_workorder_id"/>
                            <field name="mrp_consumption_id"/>
                            <field name="type"/>
                            <field name="product_id"/>
                            <field name="currency_id" invisible="1"/>
                            <field name="value" string="Value" sum="Value"/>
                            <field name="account_move_id" invisible="1"/>
                            <field name="description" optional="hide"/>
                        </tree>
                    </field>
                </page>
            </xpath>

            <xpath expr="//field[@name='move_finished_ids']/tree" position="inside">
                <field name="allocated_cost"/>
                <field name="price_unit"/>
            </xpath>

            <xpath expr="//field[@name='move_finished_only_ids']//field[@name='product_uom']" position="before">
                <field name="allocated_cost"/>
                <field name="price_unit" string="Price Unit" optional="hide"/>
            </xpath>

            <xpath expr="//page[@name='miscellaneous']" position="after">
                <page name="estimated_cost" string="Estimated Cost">
                    <field name="estimated_cost_ids" force_save="1">
                        <tree string="Estimated Cost" decoration-bold="type == 'finished'">
                            <field name="plan_id" invisible="1"/>
                            <field name="production_id" invisible="1"/>
                            <field name="company_id" invisible="1"/>
                            <field name="currency_id" invisible="1"/>
                            <field name="level" invisible="1"/>
                            <field name="name" string=" "/>
                            <field name="product_id" optional="hide"/>
                            <field name="operation_id" optional="hide"/>
                            <field name="user_id" optional="hide"/>
                            <field name="type" optional="hide"/>
                            <field name="product_qty" optional="hide"/>
                            <field name="qty"/>
                            <field name="uom_name" string="UoM"/>
                            <field name="total_cost"/>
                        </tree>
                    </field>
                </page>
            </xpath>

            <xpath expr="//field[@name='move_byproduct_ids']//field[@name='product_uom']" position="after">
                <field name="allocated_cost"/>
                <field name="price_unit" string="Price Unit" optional="hide"/>
            </xpath>
        </field>
    </record>

</odoo>