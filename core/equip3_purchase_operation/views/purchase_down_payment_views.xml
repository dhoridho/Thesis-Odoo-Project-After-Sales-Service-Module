<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="form_dev_purchase_down_payment" model="ir.ui.view">
        <field name="name">form.dev.purchase.down.payment</field>
        <field name="model">purchase.down.payment</field>
        <field name="inherit_id" ref="dev_purchase_down_payment.form_dev_purchase_down_payment"/>
        <field name="arch" type="xml">
            <xpath expr="//div" position="after">
                <field name="is_services_orders" invisible="1"/>
                <field name="purchase_id" invisible="1"/>
                <field name="is_service_work_order" invisible="1"/>
                <field name="swo_ids" widget="many2many_tags" attrs="{'invisible': ['|','|',('is_services_orders','=',False),('down_payment_by','not in',('dont_deduct_down_payment', 'deduct_down_payment')),('is_service_work_order','=',False)] , 'required': [('is_services_orders','=',True),('down_payment_by','in',('dont_deduct_down_payment', 'deduct_down_payment')),('is_service_work_order','=',True)]}" domain="[('state', '=', 'done'),('purchase_order_id','=',purchase_id),('invoiced','=',False)]" options="{'no_open':True,'no_create':1,'no_create_edit':1}"/>
                <field name="payable_progress" attrs="{'invisible': ['|','|',('is_services_orders','=',False),('down_payment_by','not in',('dont_deduct_down_payment', 'deduct_down_payment')),('is_service_work_order','=',False)] , 'required': [('is_services_orders','=',True),('down_payment_by','in',('dont_deduct_down_payment', 'deduct_down_payment')),('is_service_work_order','=',True)]}"/>
            </xpath>
            <xpath expr="//footer/button[@name='create_bill']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//footer/button[@name='create_bill']" position="after">
                <button string='Create and View Bill' name="create_bill2" type="object" class="oe_highlight" context="{'create_bill':True}"/>
            </xpath>
        </field>
    </record>
    <record id="purchase_form_dev_purchase_down_payment_inherited" model="ir.ui.view">
        <field name="name">purchase.form.dev.purchase.down.payment.inherited</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="dp" invisible="1"/>
                <field name="list_available_products" invisible="1"/>
            </field>
            <xpath expr="//header//button[@name='%(dev_purchase_down_payment.action_dev_purchase_down_payment)d']" position="after">
                <button name="wizard_close_purchase_order" class="btn-primary" string="Close" type="object" attrs="{'invisible': [('state','!=','purchase')]}"/>
                <button name="action_dev_purchase_down_payment"
                        string="Create Bill"
                        type="object"
                        context="{'create_bill':True}"
                        class="btn-primary"
                        attrs="{'invisible': ['|', '|', '|','|',('total_down_payment_amount','=',0), ('amount_total', '=', 0), ('state', '!=', 'purchase'), ('dp', '=', True), ('hide_create_bill', '=', True)]}"/>
            </xpath>
            <xpath expr="//header//button[@name='%(dev_purchase_down_payment.action_dev_purchase_down_payment)d']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>
</odoo>