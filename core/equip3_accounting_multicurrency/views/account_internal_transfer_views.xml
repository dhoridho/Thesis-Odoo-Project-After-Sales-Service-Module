<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_form_account_internal_transfer_purchase_currency" model="ir.ui.view">
        <field name="name">account.internal.transfer.purchase.currency.form</field>
        <field name="model">account.internal.transfer</field>
        <field name="inherit_id" ref="equip3_accounting_operation.view_form_account_internal_transfer"/>
        <field name="arch" type="xml">
<!-- 
            <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="force_save">1</attribute>
            </xpath> -->

            <xpath expr="//sheet/div[@class='oe_title']" position="replace">
                <div class="oe_title">
                   <h3>
                        <span attrs="{'invisible': [('type_curr', 'not in', ['bank_cash'])]}">Transfer Reference</span>
                        <span attrs="{'invisible': [('type_curr', 'not in', ['purchase_currency'])]}">Purchase Currency</span>                    
                    </h3>
                    <h2>
                        <field name="name"/>
                    </h2>
                    <field name="type_curr" invisible='1'/>            
                </div>
                
            </xpath>

            <!-- <xpath expr="//sheet/group/group[2]/field[@name='transfer_amount']" position="after">
                <field name="administration" attrs="{'invisible' : [('type_curr', '=', 'bank_cash')], 'readonly': [('state', '!=', 'draft')]}" groups="account.group_account_manager"/>
                <field name="administration_account" attrs="{'invisible' : [('administration', '=', False)], 'required' : [('administration', '=', True)],'readonly': [('state', '!=', 'draft')]}" groups="account.group_account_manager"/>
                <field name="administration_fee" attrs="{'invisible' : [('administration', '=', False)], 'required' : [('administration', '=', True)],'readonly': [('state', '!=', 'draft')]}" groups="account.group_account_manager"/>
            </xpath>-->

            <xpath expr="//sheet/group/group[1]/field[@name='bank_to_journal_id']" position="after">
                <field name="currency_id" force_save='1' required="1" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                <field name="apply_manual_currency_exchange" string="Set Currency Exchange" />
                <field name="manual_currency_exchange_rate" string="Currency Rate" force_save='1' attrs="{'invisible':[('apply_manual_currency_exchange','=',False)], 'readonly':[('state','!=','draft')]}"/>
                <field name="manual_currency_exchange_inverse_rate" attrs="{'invisible':[('apply_manual_currency_exchange','=',False)], 'readonly':[('state','!=','draft')]}" />
            </xpath> 

        </field>
    </record>

    <record id="view_int_trans_pur_currency_tree" model="ir.ui.view">
        <field name="name">view.account.int.trans.pur.currency.tree</field>
        <field name="model">account.internal.transfer</field>
        <field name="arch" type="xml">
            <tree string="Purchase currencys" >
                <field name="name"/>
                <field name="bank_from_journal_id" string="Sold Currency"/>
                <field name="bank_to_journal_id" string="Purchased Currency"/>
                <field name="transfer_amount"/>
                <field name="transfer_date"/>
                <field name="state"/>
                <field name="type_curr" invisible ='1'/>
            </tree>
        </field>
    </record>

    <record id="action_int_trans_pur_currency" model="ir.actions.act_window">
        <field name="name">Purchase Currency</field>
        <field name="res_model">account.internal.transfer</field>
        <field name="view_mode">tree,kanban,form,graph</field>
        <field name="domain">[('type_curr', '=', 'purchase_currency')]</field>
        <field name="context">{'default_type_curr': 'purchase_currency'}</field>
        <field name="view_id" ref="view_int_trans_pur_currency_tree"/>
    </record>

    <record id="view_tree_account_internal_transfer" model="ir.ui.view">
        <field name="name">account.internal.transfer.tree</field>
        <field name="model">account.internal.transfer</field>
        <field name="inherit_id" ref="equip3_accounting_operation.view_tree_account_internal_transfer"/>
        <field name="arch" type="xml">
            <xpath expr="//tree/field[@name='transfer_amount']" position="after">
                <field name="type_curr" invisible ='1'/>
            </xpath>
        </field>
    </record>

    <record id="equip3_accounting_operation.action_account_internal_transfer" model="ir.actions.act_window">
        <field name="name">Internal Cash/Bank Transfer</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">account.internal.transfer</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('type_curr', '=', 'bank_cash')]</field>
        <field name="context">{'default_type_curr': 'bank_cash'}</field>
    </record>

    <menuitem
        id="menu_action_action_int_trans_pur_currency"
        name="Purchase Currency"
        parent="equip3_accounting_operation.internal_cash_bank_transfer_menu"
        action="action_int_trans_pur_currency"
        sequence="2"/>

</odoo>
