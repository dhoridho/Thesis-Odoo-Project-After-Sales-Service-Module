<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="job_estimate_existing_quotation_const" model="ir.ui.view">
        <field name="name">job.estimate.existing.quotation.const</field>
        <field name="model">job.estimate.existing.quotation.const</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group invisible="1">
                        <field name="job_estimate_id"/>    
                        <field name="contract_category"/>
                    </group>
                    <separator string="Existing Quotation to Update:"/>
                    <group>
                        <field name="so_cons_id"/>
                    </group>
                    <newline/>
                    <separator string="New Quotation Details:"/>
                    <newline/>
                    <group>
                        <field name="project_id" readonly="1" force_save="1"/>
                        <field name="customer_id" readonly="1" force_save="1"/>
                        <field name="total_variation_order_material" class="oe_inline" widget="monetary" invisible="1" options="{'currency_field': 'currency_id'}" force_save='1'/>
                        <field name="total_variation_order_labour" class="oe_inline" widget="monetary" invisible="1" options="{'currency_field': 'currency_id'}" force_save='1'/>
                        <field name="total_variation_order_overhead" class="oe_inline" widget="monetary" invisible="1" options="{'currency_field': 'currency_id'}" force_save='1'/>
                        <field name="total_variation_order_subcon" class="oe_inline" widget="monetary" invisible="1" options="{'currency_field': 'currency_id'}" force_save='1'/>
                        <field name="total_variation_order_asset" class="oe_inline" widget="monetary" invisible="1" options="{'currency_field': 'currency_id'}" force_save='1'/>
                        <field name="total_variation_order_equipment" class="oe_inline" widget="monetary" invisible="1" options="{'currency_field': 'currency_id'}" force_save='1'/>
                        <field name="total_variation_order" readonly="1" force_save="1" widget="monetary"
                               options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('contract_category', '!=', 'var')]}"/>
                    </group>
                    <newline/>
                    <notebook>
                        <page string="Project Scope" name="project_scope">
                            <field name="project_scope_wiz" widget="one2many_list">
                                <tree string="Project Scope" editable="bottom" create="false" delete="false">
                                    <field name="sequence" invisible="1"/>
                                    <field name="sr_no" invisible="1"/>
                                    <field name="is_active"/>
                                    <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                    <field name="project_scope" readonly="1" force_save="1"/>
                                    <field name="description" readonly="0"/>
                                    <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="currency_id" force_save="1" invisible="1"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Section" name="section">
                            <field name="section_wiz" widget="one2many_list">
                                <tree string="Section" editable="bottom" create="false" delete="false">
                                    <field name="sequence" invisible="1"/>
                                    <field name="sr_no" invisible="1"/>
                                    <field name="is_active"/>
                                    <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                    <field name="project_scope" readonly="1" force_save="1"/>
                                    <field name="section_name" readonly="1" force_save="1"/>
                                    <field name="description" readonly="0"/>
                                    <field name="quantity" readonly="1" force_save="1"/>
                                    <field name="uom_id" readonly="1" force_save="1"/>
                                    <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="currency_id" force_save="1" invisible="1"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Variable" name="variable" invisible='1'> 
                            <field name="variable_wiz" widget="one2many_list">
                                <tree string="Variable" editable="bottom" create="false" delete="false">
                                    <field name="sequence" invisible="1"/>
                                    <field name="sr_no" invisible="1"/>
                                    <field name="is_active"/>
                                    <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                    <field name="project_scope" readonly="1" force_save="1"/>
                                    <field name="section_name" readonly="1" force_save="1"/>
                                    <field name="variable_name" readonly="1" force_save="1"/>
                                    <field name="variable_quantity" readonly="1" force_save="1" />
                                    <field name="variable_uom" readonly="1" force_save="1"/>
                                    <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                           options="{'currency_field': 'currency_id'}"/>
                                    <field name="currency_id" invisible="1"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Estimation" name="estimation">
                            <notebook>
                                <page string="Material Estimation" name="material_estimation">
                                    <field name="material_estimation_wiz" widget="one2many_list">
                                        <tree string="Material Estimation" editable="bottom" create="false" delete="false">
                                            <field name="sequence" invisible="1"/>
                                            <field name="sr_no" invisible="1"/>
                                            <field name="is_active"/>
                                            <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                            <field name="project_scope" readonly="1" force_save="1"/>
                                            <field name="section_name" readonly="1" force_save="1"/>
                                            <field name="variable_ref" readonly="1" force_save="1" invisible='1'/>
                                            <field name="group_of_product" readonly="1" force_save="1"/>
                                            <field name="product_id" readonly="1" force_save="1"/>
                                            <field name="description" readonly="0"/>
                                            <field name="analytic_ids" string='Analytic Group' readonly="1" force_save="1" optional="show" widget="many2many_tags"/>
                                            <field name="budget_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}" optional="hide"/>
                                            <field name="current_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}"/>
                                            <field name="quantity" readonly="1" force_save="1"/>
                                            <field name="uom_id" readonly="1" force_save="1"/>
                                            <field name="unit_price" readonly="1" force_save="1" widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                            <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                            <field name="currency_id" invisible="1"/>
                                        </tree>
                                    </field>
                                </page>
                                <page string="Labour Estimation" name="manpower_estimation">
                                    <field name="labour_estimation_wiz" widget="one2many_list">
                                        <tree string="Labour Estimation" editable="bottom" create="false" delete="false">
                                            <field name="sequence" invisible="1"/>
                                            <field name="sr_no" invisible="1"/>
                                            <field name="is_active"/>
                                            <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                            <field name="project_scope" readonly="1" force_save="1"/>
                                            <field name="section_name" readonly="1" force_save="1"/>
                                            <field name="variable_ref" readonly="1" force_save="1" invisible='1'/>
                                            <field name="group_of_product" readonly="1" force_save="1"/>
                                            <field name="product_id" readonly="1" force_save="1"/>
                                            <field name="description" readonly="0"/>
                                            <field name="analytic_ids" string='Analytic Group' readonly="1" force_save="1" optional="show" widget="many2many_tags"/>
                                            <field name="budget_contractors" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}" optional="hide"/>
                                            <field name="current_contractors" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}"/>
                                            <field name="budget_time" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}" optional="hide"/>
                                            <field name="current_time" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}"/>
                                            <field name="contractors" readonly="1" force_save="1"/>
                                            <field name="time" readonly="1" force_save="1"/>
                                            <field name="quantity" readonly="1" force_save="1" invisible="1"/>
                                            <field name="uom_id" readonly="1" force_save="1"/>
                                            <field name="unit_price" readonly="1" force_save="1" widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                            <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                            <field name="currency_id" invisible="1"/>
                                        </tree>
                                    </field>
                                </page>
                                <page string="Overhead Estimation" name="overhead_estimation">
                                    <field name="overhead_estimation_wiz" widget="one2many_list">
                                        <tree string="Overhead Estimation" editable="bottom" create="false" delete="false">
                                            <field name="sequence" invisible="1"/>
                                            <field name="sr_no" invisible="1"/>
                                            <field name="is_active"/>
                                            <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                            <field name="project_scope" readonly="1" force_save="1"/>
                                            <field name="section_name" readonly="1" force_save="1"/>
                                            <field name="variable_ref" readonly="1" force_save="1" invisible='1'/>
                                            <field name="overhead_catagory" readonly="1" force_save="1"/>
                                            <field name="group_of_product" readonly="1" force_save="1"/>
                                            <field name="product_id" readonly="1" force_save="1"/>
                                            <field name="description" readonly="0"/>
                                            <field name="analytic_ids" string='Analytic Group' readonly="1" force_save="1" optional="show" widget="many2many_tags"/>
                                            <field name="budget_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}" optional="hide"/>
                                            <field name="current_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}"/>
                                            <field name="quantity" readonly="1" force_save="1"/>
                                            <field name="uom_id" readonly="1" force_save="1"/>
                                            <field name="unit_price" readonly="1" force_save="1" widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                            <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                            <field name="currency_id" invisible="1"/>
                                        </tree>
                                    </field>
                                </page>
                                <page string="Asset Estimation" name="asset_estimation">
                                    <notebook>
                                        <page string="Internal Asset Estimation" name="internal_asset_estimation">
                                            <field name="internal_asset_wiz" widget="one2many_list">
                                                <tree string="Internal Asset Estimation" editable="bottom" create="false" delete="false">
                                                    <field name="sequence" invisible="1"/>
                                                    <field name="sr_no" invisible="1"/>
                                                    <field name="is_active"/>
                                                    <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                                    <field name="project_scope" readonly="1" force_save="1"/>
                                                    <field name="section_name" readonly="1" force_save="1"/>
                                                    <field name="variable_ref" readonly="1" force_save="1" invisible='1'/>
                                                    <field name="asset_category_id" readonly="1" force_save="1"/>
                                                    <field name="asset_id" readonly="1" force_save="1"/>
                                                    <field name="description" readonly="0"/>
                                                    <field name="analytic_ids" string='Analytic Group' readonly="1" force_save="1" optional="show" widget="many2many_tags"/>
                                                    <field name="budget_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}" optional="hide"/>
                                                    <field name="current_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}"/>
                                                    <field name="quantity" readonly="1" force_save="1"/>
                                                    <field name="uom_id" readonly="1" force_save="1"/>
                                                    <field name="unit_price" readonly="1" force_save="1" widget="monetary"
                                                           options="{'currency_field': 'currency_id'}"/>
                                                    <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                                           options="{'currency_field': 'currency_id'}"/>
                                                    <field name="currency_id" invisible="1"/>
                                                </tree>
                                            </field>
                                        </page>
                                        <page string="Equipment Estimation" name="equipment_estimation">
                                            <field name="equipment_estimation_wiz" widget="one2many_list">
                                                <tree string="Equipment Estimation" editable="bottom" create="false" delete="false">
                                                    <field name="sequence" invisible="1"/>
                                                    <field name="sr_no" invisible="1"/>
                                                    <field name="is_active"/>
                                                    <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                                    <field name="project_scope" readonly="1" force_save="1"/>
                                                    <field name="section_name" readonly="1" force_save="1"/>
                                                    <field name="variable_ref" readonly="1" force_save="1" invisible='1'/>
                                                    <field name="group_of_product" readonly="1" force_save="1"/>
                                                    <field name="product_id" readonly="1" force_save="1"/>
                                                    <field name="description" readonly="0"/>
                                                    <field name="analytic_ids" string='Analytic Group' readonly="1" force_save="1" optional="show" widget="many2many_tags"/>
                                                    <field name="budget_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}" optional="hide"/>
                                                    <field name="current_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}"/>
                                                    <field name="quantity" readonly="1" force_save="1"/>
                                                    <field name="uom_id" readonly="1" force_save="1"/>
                                                    <field name="unit_price" readonly="1" force_save="1" widget="monetary"
                                                           options="{'currency_field': 'currency_id'}"/>
                                                    <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                                           options="{'currency_field': 'currency_id'}"/>
                                                    <field name="currency_id" invisible="1"/>
                                                </tree>
                                            </field>
                                        </page>
                                    </notebook>
                                </page>
                                <page string="Subcon Estimation" name="subcon_estimation">
                                    <field name="subcon_estimation_wiz" widget="one2many_list">
                                        <tree string="Subcon Estimation" editable="bottom" create="false" delete="false">
                                            <field name="sequence" invisible="1"/>
                                            <field name="sr_no" invisible="1"/>
                                            <field name="is_active"/>
                                            <field name="job_estimate_id" invisible="1" readonly="1" force_save="1"/>
                                            <field name="project_scope" readonly="1" force_save="1"/>
                                            <field name="section_name" readonly="1" force_save="1"/>
                                            <field name="variable_ref" readonly="1" force_save="1" invisible='1'/>
                                            <field name="variable" readonly="1" force_save="1"/>
                                            <field name="description" readonly="0"/>
                                            <field name="analytic_ids" string='Analytic Group' readonly="1" force_save="1" optional="show" widget="many2many_tags"/>
                                            <field name="budget_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}" optional="hide"/>
                                            <field name="current_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.contract_category','!=','var')]}"/>
                                            <field name="quantity" readonly="1" force_save="1"/>
                                            <field name="uom_id" readonly="1" force_save="1"/>
                                            <field name="unit_price" readonly="1" force_save="1" widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                            <field name="subtotal" readonly="1" force_save="1" widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                            <field name="currency_id" invisible="1"/>
                                        </tree>
                                    </field>
                                </page>
                            </notebook>
                        </page>
                    </notebook>
                    <newline/>
                    <footer>
                        <button name="action_confirm" string="Create New Quotation" type="object" class="oe_highlight" context="{'create_new':True}"/>
                        <button name="action_confirm" string="Use Existing Quotation" type="object" class="oe_highlight"
                                attrs="{'invisible':[('so_cons_id', '=', False)]}" context="{'create_new':False}"/>
                        <button special="cancel" string="Cancel" class="oe_link"/>
                    </footer>
                </sheet>
            </form>
        </field>
    </record>

</odoo>