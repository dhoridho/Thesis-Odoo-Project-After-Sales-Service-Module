<odoo>
    <data>
        <record id="stock_scrape_request_inherit_form_inherit" model="ir.ui.view">
            <field name="name">stock.scrap.request.inherit.form</field>
            <field name="model">stock.scrap.request</field>
            <field name="inherit_id" ref="equip3_inventory_control.stock_scrap_request_form_view"/>
            <field name="arch" type="xml">
                <!-- <xpath expr="//button[@name='action_request_validated']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//button[@name='action_request_validated']" position="after">
                    <button name="action_request_validated2" string="Validate" type="object" class="oe_highlight" attrs="{'invisible': [('state', 'not in', ('confirmed', 'approved'))]}"/>
                </xpath>        -->
                <!-- <xpath expr="//button[@name='action_cancel']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath> -->
                <!-- <xpath expr="//button[@name='action_cancel']" position="after">
                    <button name="action_cancel2" string="Cancel" type="object" class="oe_highlight" states="confirmed,validated"/>
                </xpath> -->

                <xpath expr="//field[@name='scrap_request_name']" position="after">
                    <field name="project" 
                           options="{'no_create': True, 'no_quick_create':True,'no_create_edit':True}"/>
                    <field name="contract" invisible='1'/>
                    <field name="job_estimate" invisible='1'/>
                    <field name="cost_sheet" force_save="1" readonly='1'
                            attrs="{'invisible': [('project', '=', False)]}"/>
                    <field name="budgeting_method" 
                            attrs="{'invisible': [('project', '=', False)]}"/>
                    <field name="budgeting_period" invisible="1"/>
                    <field name="department_type" invisible="1"/>
                    <field name="project_budget" force_save="1"
                           options="{'no_create': True, 'no_quick_create':True,'no_create_edit':True}" 
                           attrs="{'invisible': ['|', ('project', '=', False), ('budgeting_period', '=', 'project')], 'required': [('project', '!=', False), ('budgeting_period', '!=', 'project')]}"/>
                    <field name="actualization_project_budget" force_save="1"
                           options="{'no_create': True, 'no_quick_create':True,'no_create_edit':True}" 
                           attrs="{'invisible': ['|', ('project', '=', False), ('budgeting_period', '=', 'project')], 'required': [('project', '!=', False), ('budgeting_period', '!=', 'project')]}"/>
                    <field name="material_type" 
                           attrs="{'invisible': [('project', '=', False)], 'required': [('project', '!=', False)]}"
                           string='Type of Product' />
                    <field name="work_orders"
                           options="{'no_create': True, 'no_quick_create':True,'no_create_edit':True}" 
                           attrs="{'invisible': [('project', '=', False)], 'required': [('project', '!=', False)]}"/>
                    <field name="progress_id"
                           options="{'no_create': True, 'no_quick_create':True,'no_create_edit':True}"
                           attrs="{'invisible': [('project', '=', False)], 'required': [('project', '!=', False)]}"/>
                    <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>    
                </xpath>
                <xpath expr="//field[@name='scrap_ids']/tree//field[@name='location_id']" position="after">
                    <field name="con_material_id" invisible="1" force_save="1"/>
                    <field name="con_labour_id" invisible="1" force_save="1"/>
                    <field name="con_overhead_id" invisible="1" force_save="1"/>
                    <field name="con_equipment_id" invisible="1" force_save="1"/>

                    <field name="cs_material_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', ('parent.project', '=', False), ('parent.material_type', '!=', 'material')]}"/>
                    <field name="cs_labour_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', ('parent.project', '=', False), ('parent.material_type', '!=', 'labour')]}"/>
                    <field name="cs_overhead_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', ('parent.project', '=', False), ('parent.material_type', '!=', 'overhead')]}"/>
                    <field name="cs_equipment_id" invisible='1' force_save="1"/>

                    <field name="bd_material_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', ('parent.project', '=', False), ('parent.budgeting_period', '=', 'project'), ('parent.material_type', '!=', 'material')]}"/>
                    <field name="bd_labour_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', ('parent.project', '=', False), ('parent.budgeting_period', '=', 'project'), ('parent.material_type', '!=', 'labour')]}"/>
                    <field name="bd_overhead_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', ('parent.project', '=', False), ('parent.budgeting_period', '=', 'project'), ('parent.material_type', '!=', 'overhead')]}"/>
                    <field name="bd_equipment_id" invisible='1' force_save="1"/>

                    <field name="cs_material_gop_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', ('parent.project', '=', False), ('parent.budgeting_method', '!=', 'gop_budget'), ('parent.material_type', '!=', 'material')]}"/>
                    <field name="cs_labour_gop_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', ('parent.project', '=', False), ('parent.budgeting_method', '!=', 'gop_budget'), ('parent.material_type', '!=', 'labour')]}"/>
                    <field name="cs_overhead_gop_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', ('parent.project', '=', False), ('parent.budgeting_method', '!=', 'gop_budget'), ('parent.material_type', '!=', 'overhead')]}"/>
                    <field name="cs_equipment_gop_id" invisible='1' force_save="1"/>

                    <field name="bd_material_gop_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', '|', ('parent.project', '=', False), ('parent.budgeting_period', '=', 'project'), ('parent.budgeting_method', '!=', 'gop_budget'), ('parent.material_type', '!=', 'material')]}"/>
                    <field name="bd_labour_gop_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', '|', ('parent.project', '=', False), ('parent.budgeting_period', '=', 'project'), ('parent.budgeting_method', '!=', 'gop_budget'), ('parent.material_type', '!=', 'labour')]}"/>
                    <field name="bd_overhead_gop_id" optional="hide" force_save="1" readonly='1'
                           attrs="{'column_invisible': ['|', '|', '|', ('parent.project', '=', False), ('parent.budgeting_period', '=', 'project'), ('parent.budgeting_method', '!=', 'gop_budget'), ('parent.material_type', '!=', 'overhead')]}"/>
                    <field name="bd_equipment_gop_id" invisible='1' force_save="1"/>

                    <field name="project" invisible='1'/>
                    <field name="budgeting_method" invisible="1"/>
                    <field name="budgeting_period" invisible="1"/>
                    <field name="material_type" invisible="1"/>
                    <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]"
                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                           attrs="{'column_invisible': [('parent.project', '=', False)], 'required': [('parent.project', '!=', False)]}"/>
                    <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                    <field name="section" domain="[('id','in',project_section_computed)]"
                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                           attrs="{'column_invisible': [('parent.project', '=', False)], 'required': [('parent.project', '!=', False)]}"/>
                    <field name="variable" optional="hide"
                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                           attrs="{'column_invisible': [('parent.project', '=', False)], 'required': [('parent.project', '!=', False)]}"/>
                    <field name="group_of_product" 
                           attrs="{'column_invisible': [('parent.project', '=', False)], 'required': [('parent.project', '!=', False)]}"/>
                    <field name="subcon" invisible='1'
                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                </xpath>
                <xpath expr="//field[@name='scrap_ids']/tree//field[@name='product_uom_id']" position="after">
                    <field name="budget_qty" readonly="1" force_save="1"
                           attrs="{'column_invisible': ['|', ('parent.project', '=', False), ('parent.budgeting_method', 'in', ('gop_budget','total_budget'))]}"/>
                    <field name="on_hand_qty_converted" force_save="1"
                           attrs="{'column_invisible': [('parent.project', '=', False)]}"/>
                     <field name="base_product_uom_id" force_save="1"
                           attrs="{'column_invisible': [('parent.project', '=', False)]}"/>
                     <field name="prev_product_uom_id" invisible="1" />
                     
                </xpath>
                <xpath expr="//field[@name='scrap_ids']/tree//field[@name='product_uom_id']" position="before">
                    <field name="product_uom_category_id" invisible='1'/>
                </xpath>
                <xpath expr="//field[@name='scrap_ids']/tree//field[@name='product_uom_id']" position="attributes">
                    <attribute name="domain">[('category_id', '=', product_uom_category_id)]</attribute>
                </xpath>
                <xpath expr="//field[@name='schedule_date']" position="attributes">
                    <attribute name="attrs">{'required': 1}</attribute>
                </xpath>
            </field>
        </record>
        
        <!-- stock.scrap.request inherit tree view -->
        <record id="edit_view_product_usage" model="ir.ui.view">
            <field name="name">stock.scrap.request.inherit.view.tree</field>
            <field name="model">stock.scrap.request</field>
            <field name="inherit_id" ref="equip3_inventory_control.stock_scrap_request_tree_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='warehouse_id']" position="before">
                    <field name="company_id" position="move"/>
                </xpath>
                <xpath expr="//field[@name='warehouse_id']" position="after">
                    <field name="material_type"/>
                </xpath>
            </field>
        </record>
    </data>
</odoo>
    