<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- SUB RFQ & PO ACTION WINDOW -->
        <record id="equip3_purchase_operation.product_requests_for_quotation_services" model="ir.actions.act_window">
            <field name="name">Requests for Quotation</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="view_mode">tree,kanban,form,pivot,graph,calendar,activity</field>
            <field name="view_id" ref="purchase.purchase_order_kpis_tree"/>
            <field name="domain">[('state', 'in', ['draft', 'sent', 'cancel', 'waiting_for_approve', 'reject', 'rfq_approved']),('po', '=', False), ('is_subcontracting', '=', True)]</field>
            <field name="search_view_id" ref="purchase.view_purchase_order_filter"/>
            <field name="context">{'orders': 1, 'goods_order': 1, 'default_is_goods_orders' : True ,'search_default_project' : 1}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                No request for quotation found. Let's create one!
                </p><p>
                Requests for quotation are documents that will be sent to your suppliers to request prices for different products you consider buying.
                Once an agreement has been found with the supplier, they will be confirmed and turned into purchase orders.
                </p>
            </field>
        </record>

        <record id="purchase_order_kpis_tree_cons_inherit" model="ir.ui.view">
            <field name="name">purchase.order.inherit.purchase.order.tree.cons.inherit</field>
            <field name="model">purchase.order</field>
            <field name="arch" type="xml">
                <tree string="Purchase Order" multi_edit="1" decoration-bf="message_unread==True"
                      class="o_purchase_order" js_class="purchase_list_dashboard" sample="1">
                    <header>
                        <button name="action_create_invoice" type="object" string="Create Bills"/>
                    </header>
                    <field name="priority" optional="show" widget="priority" nolabel="1"/>
                    <field name="message_unread" invisible="1"/>
                    <field name="partner_ref" optional="hide"/>
                    <field name="name" string="Reference" readonly="1" decoration-bf="1"/>
                    <field name="agreement_id" optional="hide"/>
                    <field name="date_approve" widget="date" invisible="context.get('quotation_only', False)" optional="hide"/>
                    <field name="partner_id"/>
                    <field name="project"/>
                    <field name="purchase_tag_ids" groups="sh_all_in_one_purchase_tools.sh_purchase_tags_user_id" widget="many2many_tags" options="{'color_field': 'color', 'no_create_edit': True}" optional="hide"/>
                    <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}" optional="hide"/>
                    <field name="branch_id" optional="hide"/>
                    <field name="date_planned" invisible="context.get('quotation_only', False)" string='Expected Date' optional="hide"/>
                    <field name="user_id" widget="many2one_avatar_user" optional="show"/>
                    <field name="date_order" invisible="not context.get('quotation_only', False)" optional="show"/>
                    <field name="activity_ids" widget="list_activity" optional="hide"/>
                    <field name="origin" optional="show"/>
                    <field name="amount_untaxed" sum="Total Untaxed amount" string="Untaxed" widget="monetary" optional="hide"/>
                    <field name="total_all" sum="Grand Total" widget="monetary" optional="show" decoration-bf="1"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="state" />
                    <field name="custom_checklist" widget="progressbar" groups="sh_all_in_one_purchase_tools.group_enable_purchase_checklist" optional="hide"/>
                    <field name="invoice_status" widget="badge" decoration-success="invoice_status == 'invoiced'" decoration-info="invoice_status == 'to invoice'" optional="hide"/>
                    <field name="sh_partially_ship"  optional="hide"/>
                    <field name="sh_fully_ship"  optional="hide"/>
                    <field name="sh_partially_paid"  optional="hide"/>
                    <field name="sh_fully_paid"  optional="hide"/>
                    <field name="sh_hidden_compute_field" invisible="1" />
                </tree>
            </field>
        </record>

        <record id="view_task_tree_request_purchase_orders_services_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="purchase_order_kpis_tree_cons_inherit"/>
            <field name="act_window_id" ref="equip3_purchase_operation.product_requests_for_quotation_services"/>
        </record>


        <!-- NAMBAHIN GROUP BY DI RFQ & PURCHASE ORDERS-->   
        <record id="purchase_order_view_search" model="ir.ui.view">
            <field name="name">purchase_order_view_search</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_view_search"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='order_date']" position="after">
                    <filter string="Project" name="project" domain="[]" context="{'group_by': 'project'}"/>
                </xpath>
            </field>
        </record>
<!-- 
        NAMBAHIN GROUP BY DI RFQ SUBCON   
        <record id="view_purchase_order_filter" model="ir.ui.view">
            <field name="name">view_purchase_order_filter</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.view_purchase_order_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='date_order']" position="after">
                    <filter string="Project" name="project" domain="[]" context="{'group_by': 'project'}"/>
                </xpath>
            </field>
        </record> -->

        <!-- PURCHASE ORDER TREE VIEW -->
        <record id="purchase_order_view_tree_inherited_purchase" model="ir.ui.view">
            <field name="name">purchase.order.tree.inherited.purchase</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_view_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//tree/field[@name='company_id']" position="after">
                    <field name="project"/>
                </xpath>
            </field>
        </record>

        <record id="purchase_order_view_tree_subcon_cons" model="ir.ui.view">
            <field name="name">purchase.order.view.tree</field>
            <field name="model">purchase.order</field>
            <field name="arch" type="xml">
                <tree decoration-bf="message_unread==True"
                    decoration-muted="state=='cancel'"
                    decoration-info="state in ('wait','confirmed')"
                    string="Purchase Order"
                    class="o_purchase_order"
                    sample="1">
                    <header>
                        <button name="action_create_invoice" type="object" string="Create Bills"/>
                    </header>
                    <field name="priority" optional="show" widget="priority" nolabel="1"/>
                    <field name="message_unread" invisible="1"/>
                    <field name="partner_ref" optional="hide"/>
                    <field name="name" string="Reference" readonly="1" decoration-bf="1"/>
                    <field name="agreement_id" optional="hide"/>
                    <field name="date_approve" widget="date" invisible="context.get('quotation_only', False)" optional="hide"/>
                    <field name="partner_id"/>
                    <field name="project"/>
                    <field name="purchase_tag_ids" groups="sh_all_in_one_purchase_tools.sh_purchase_tags_user_id" widget="many2many_tags" options="{'color_field': 'color', 'no_create_edit': True}" optional="hide"/>
                    <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}" optional="hide"/>
                    <field name="branch_id" optional="hide"/>
                    <field name="date_planned" invisible="context.get('quotation_only', False)" string='Expected Date' optional="show"/>
                    <field name="user_id" widget="many2one_avatar_user" optional="show"/>
                    <field name="date_order" invisible="not context.get('quotation_only', False)" optional="show"/>
                    <field name="activity_ids" widget="list_activity" optional="hide"/>
                    <field name="origin" optional="show"/>
                    <field name="amount_untaxed" sum="Total Untaxed amount" string="Untaxed" widget="monetary" optional="hide"/>
                    <field name="total_all" sum="Grand Total" widget="monetary" optional="show" decoration-bf="1"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="state" />
                    <field name="custom_checklist" widget="progressbar" groups="sh_all_in_one_purchase_tools.group_enable_purchase_checklist" optional="hide"/>
                    <field name="invoice_status" widget="badge" decoration-success="invoice_status == 'invoiced'" decoration-info="invoice_status == 'to invoice'" optional="show"/>
                    <field name="sh_partially_ship" />
                    <field name="sh_fully_ship" />
                    <field name="sh_partially_paid" />
                    <field name="sh_fully_paid" />
                    <field name="sh_hidden_compute_field" invisible="1" />
                </tree>
            </field>
        </record>

        <record id="all_po_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="purchase_order_view_tree_subcon_cons"/>
            <field name="act_window_id" ref="equip3_purchase_other_operation.rfq_tender_submission_all_orders_action"/>
        </record>

        <record id="subcon_po_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="purchase_order_view_tree_subcon_cons"/>
            <field name="act_window_id" ref="equip3_purchase_other_operation.rfq_tender_submission_services_action"/>
        </record>

        <record id="view_task_tree_purchase_orders_services_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="purchase_order_view_tree_subcon_cons"/>
            <field name="act_window_id" ref="equip3_purchase_operation.product_purchase_orders_services"/>
        </record>

        <!-- RFQ & PURCHASE ORDER FORM VIEW -->
        <record id="direct_purchase_form_view_equip3_purchase_other_operation_const_rfq_1" model="ir.ui.view">
            <field name="name">direct.purchase.form.view.equip3.purchase.other.operation.const.rfq.1</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//sheet/div[@name='button_box']" position="inside">
                    <button type="object" class="oe_stat_button" icon="o-hm-smart-construction-claim"
                            name="action_job_order_subcon" attrs="{'invisible' : [('count_subcon', '=', 0)]}">
                        <field name="count_subcon" string="Job Subcon" widget="statinfo"/>
                    </button>
                </xpath>

                <xpath expr="//field[@name='partner_id']" position="before">
                    <field name="project"/>
                    <field name="budgeting_method" attrs="{'invisible': [('project', '=', False)]}"/>
                    <field name="budgeting_period" invisible="1" readonly="1"/>
                    <field name="cost_sheet" domain="[('project_id', '=', project)]" force_save="1" attrs="{'required':[('project','!=',False)], 'readonly': True, 'invisible': [('project', '=', False)]}"/>
                    <field name="project_budget" force_save="1" attrs="{'invisible': ['|', '|', ('is_multiple_budget', '=', True),('budgeting_period', '=', 'project'), ('project', '=', False)]}"/>
                    <field name="is_multiple_budget_procurement" invisible='1'/>
                    <label for="is_multiple_budget" attrs="{'invisible': ['|', '|', ('project', '=', False), ('is_multiple_budget_procurement', '=', False), ('budgeting_period', '=', 'project')]}"/>
                    <div name="multiple_budget_div" class="d-flex" attrs="{'invisible': ['|', '|', ('project', '=', False), ('is_multiple_budget_procurement', '=', False), ('budgeting_period', '=', 'project')]}">
                        <field name="is_multiple_budget" nolabel="1"/>
                        <field name="multiple_budget_ids" widget="many2many_tags"
                        attrs="{'required': [('is_multiple_budget', '!=', False)]}" nolabel="1"/>
                    </div>
                    <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>  
                </xpath>
                <xpath expr="//field[@name='branch_id']" position="attributes">
                    <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved']), ('project', '!=', False)]}</attribute>
                </xpath>
                <xpath expr="//field[@name='date_order']" position="after">
                    <field name="count_contract" invisible="1"/>
                    <field name="use_dp" invisible="1"/>
                    <field name="use_retention" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='date_order']" position="before">
                    <field name="contract_customer" 
                           attrs="{'invisible': [('is_subcontracting', '=', False)]}"
                           domain="[('project_id', '=', project), ('vo_payment_type', '=', 'split'), ('state', '=', 'sale')]"/>
                    <field name="subcon_contract" 
                           domain="[('project', '=', project), ('is_subcontracting', '=', True)]" 
                           attrs="{'invisible':[('is_material_orders','!=',True), ('project', '=', False)]}"/>                    
                </xpath>
                <xpath expr="//field[@name='sh_sale_order_id']" position="attributes">
                    <attribute name="attrs">{'invisible': [('is_subcontracting', '=', True)]}</attribute>
                </xpath>
                <xpath expr="//field[@name='analytic_account_group_ids']" position="after">
                    <field name="addendum_payment_method" invisible="1" force_save="1"/>
                    <field name="is_subcontracting" force_save="1" invisible="1"/>
                    <field name="is_material_orders" invisible="1" force_save="1"/>
                    <field name="is_orders" invisible="1" force_save="1"/>
                    <field name="is_asset_cons_order" invisible="1" force_save="1"/>
                    <field name="is_continue_over_budget" invisible="1" force_save="1"/>
                </xpath>
                <xpath expr="//page[1]" position="attributes">
                    <attribute name="attrs">{'invisible':[('is_subcontracting','=',True)]}</attribute>
                </xpath>
                <xpath expr="//field[@name ='order_line']" position="attributes">
                    <attribute name="class">o_purchase_order_line o_po_product_line</attribute>
                </xpath>
                <xpath expr="//field[@name ='order_line']//tree/field[@name='product_template_id']" position="before">
                    <field name="is_default_unit_price_budget" invisible="1" readonly="1" force_save="1"/>
                    <field name="cs_material_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': [('parent.project','=',False)]}"/>
                    <field name="cs_labour_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': [('parent.project','=',False)]}"/>
                    <field name="cs_overhead_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': [('parent.project','=',False)]}"/>
                    <field name="cs_equipment_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': [('parent.project','=',False)]}"/>
                    
                    <field name="cs_material_gop_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget')]}"/>
                    <field name="cs_labour_gop_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget')]}"/>
                    <field name="cs_overhead_gop_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget')]}"/>
                    <field name="cs_equipment_gop_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget')]}"/>
                    
                    <field name="bd_material_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', ('parent.project','=',False), ('parent.project_budget','=', False), ('parent.is_multiple_budget','=',True)]}"/>
                    <field name="bd_labour_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', ('parent.project','=',False), ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                    <field name="bd_overhead_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', ('parent.project','=',False), ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                    <field name="bd_equipment_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', ('parent.project','=',False), ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                    
                    <field name="bd_material_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', ('parent.project','=',False), ('parent.multiple_budget_ids','=', False), ('parent.is_multiple_budget','=',False)]}"/>
                    <field name="bd_labour_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', ('parent.project','=',False), ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>
                    <field name="bd_overhead_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', ('parent.project','=',False), ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>
                    <field name="bd_equipment_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', ('parent.project','=',False), ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>
                    
                    <field name="bd_material_gop_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', '|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget',), ('parent.project_budget','=', False), ('parent.is_multiple_budget','=',True)]}"/>
                    <field name="bd_labour_gop_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', '|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget',), ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                    <field name="bd_overhead_gop_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', '|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget',), ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                    <field name="bd_equipment_gop_id" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', '|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget',), ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                    
                    <field name="bd_material_gop_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', '|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget',), ('parent.multiple_budget_ids','=', False), ('parent.is_multiple_budget','=',False)]}"/>
                    <field name="bd_labour_gop_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', '|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget',), ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>
                    <field name="bd_overhead_gop_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', '|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget',), ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>
                    <field name="bd_equipment_gop_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', '|', '|', ('parent.project','=',False), ('parent.budgeting_method','!=','gop_budget',), ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>

                    <field name="type" force_save="1" attrs="{'column_invisible': [('parent.project', '=', False)]}"/>
                    <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]" attrs="{'required': [('parent.project', '!=', False)], 'readonly': [('type', '=', False)], 'column_invisible': [('parent.project', '=', False)]}"
                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                    <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                    <field name="section" domain="[('id','in',project_section_computed)]" attrs="{'required': [('parent.project', '!=', False)], 'readonly': [('project_scope', '=', False)], 'column_invisible': [('parent.project', '=', False)]}"
                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                    <field name="group_of_product" force_save="1" attrs="{'required': [('parent.project', '!=', False)], 'readonly': [('section', '=', False)], 'column_invisible': [('parent.project', '=', False)]}"/>
                </xpath>
                <xpath expr="//field[@name ='order_line']//tree/field[@name='product_template_id']" position="attributes">
                    <attribute name="attrs">{'readonly': [('group_of_product', '=', False), ('parent.project', '!=', False)]}</attribute>
                </xpath>
                <xpath expr="//field[@name ='order_line']//tree/field[@name='product_qty']" position="before">
                    <field name="budget_quantity" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.project', '=', False)]}"/>
                </xpath>
                <xpath expr="//field[@name ='order_line']//tree/field[@name='price_unit']" position="after">
                    <field name="budget_unit_price" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.project', '=', False)]}"/>
                </xpath>
                <xpath expr="//field[@name ='order_line']//tree/field[@name='price_subtotal']" position="after">
                    <field name="remining_budget_amount" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.project', '=', False)]}"/>
                    <field name="billed_amt" widget="monetary" invisible='1'/>
                    <field name="paid_amt" widget="monetary" invisible='1'/>
                    <field name="is_reserved" optional="hide" force_save='1'/>
                    <button name="purchase_order_line_cancel" type="object" attrs="{'invisible': ['|','|','|', ('parent.state', '!=', 'purchase'), ('state', '=', 'cancel'), ('parent.project', '=', False), ('qty_received', '!=', 0)]}" string="Cancel" class="btn btn-primary"/>
                </xpath>
            </field>
        </record>

        <!-- Add Line Varibale, Service, & Material -->
        <record id="direct_purchase_form_view_equip3_purchase_other_operation_const_rfq_2" model="ir.ui.view">
            <field name="name">direct.purchase.form.view.equip3.purchase.other.operation.const.rfq.2</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//page[@name='products']" position="before" attrs="{'invisible':[('is_subcontracting','=', True)]}">
                    <!-- Add Variable Line Start -->
                    <page name="gop_line" string="Group of Product Budget" attrs="{'invisible':['|', '|', ('project','=',False), ('budgeting_method','!=', 'gop_budget'), ('is_subcontracting','=', True)]}">
                        <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>  
                        <field name="gop_budget_ids" class="o_rfq_variable_line" readonly="1" force_save="1">
                            <tree editable="bottom">
                                <field name="sr_no"/>
                                
                                <field name="cs_material_gop_id" optional="hide" readonly="1" force_save="1" />
                                <field name="cs_labour_gop_id" optional="hide" readonly="1" force_save="1" />
                                <field name="cs_overhead_gop_id" optional="hide" readonly="1" force_save="1" />
                                <field name="cs_equipment_gop_id" optional="hide" readonly="1" force_save="1" />

                                <field name="bd_material_gop_id" optional="hide" readonly="1" force_save="1" attrs="{'column_invisible': ['|', ('parent.project_budget','=', False), ('parent.is_multiple_budget','=',True)]}"/>
                                <field name="bd_labour_gop_id" optional="hide" readonly="1" force_save="1" attrs="{'column_invisible': ['|', ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                                <field name="bd_overhead_gop_id" optional="hide" readonly="1" force_save="1" attrs="{'column_invisible': ['|', ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                                <field name="bd_equipment_gop_id" optional="hide" readonly="1" force_save="1" attrs="{'column_invisible': ['|', ('parent.project_budget','=',False), ('parent.is_multiple_budget','=',True)]}"/>
                                
                                <field name="bd_material_gop_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', ('parent.multiple_budget_ids','=', False), ('parent.is_multiple_budget','=',False)]}"/>
                                <field name="bd_labour_gop_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>
                                <field name="bd_overhead_gop_ids" widget="many2many_tags" optional="hide" readonly='1' force_save="1" attrs="{'column_invisible': ['|', ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>
                                <field name="bd_equipment_gop_ids" widget="many2many_tags" optional="hide" readonly="1" force_save="1" attrs="{'column_invisible': ['|', ('parent.multiple_budget_ids','=',False), ('parent.is_multiple_budget','=',False)]}"/>
                                
                                <field name="type" force_save="1"/>
                                <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]"
                                       options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}" force_save="1"/>
                                <field name="project_section_computed" widget="many2many_tags" invisible="1" force_save="1"/>
                                <field name="section_name" domain="[('id','in',project_section_computed)]"
                                       options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}" force_save="1"/>
                                <field name="variable_ref" invisible='1' force_save="1"
                                       options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                                <field name="group_of_product" force_save="1"/>
                                <field name="gop_amount_total" force_save="1"/>
                                <field name="budgeted_amt_left" force_save="1"/>
                                <field name="billed_amt" force_save="1" invisible='1'/>
                                <field name="purchased_amt" force_save="1" invisible='1'/>
                                <field name="is_reserved" optional="hide" force_save='1'/>
                            </tree>
                        </field>
                    </page>
                    <page name="variable_line" string="Job Subcon" attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                        <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>
                        <field name="report_street" invisible="1"/>
                        <field name="report_country" invisible="1"/>
                        <field name="report_taxes" invisible="1"/>
                        <field name="report_title" invisible="1"/>
                        <field name="variable_line_ids" class="o_rfq_variable_line" attrs="{'readonly': [('state','not in', ('draft','sent'))]}">
                            <tree editable='bottom'>
                                <control>
                                    <create name="add_variable_control" string="Add a variable"/>
                                </control>
                                <field name="sequence" widget="handle"/>
                                <field name="sr_no"/>
                                <field name="cs_subcon_id" readonly='1' optional="hide" force_save="1" />
                                <field name="bd_subcon_id" readonly='1' optional="hide" force_save="1" attrs="{'column_invisible': [('parent.is_multiple_budget','=',True)]}"/>
                                <field name="bd_subcon_ids" readonly='1' optional="hide" force_save="1" attrs="{'column_invisible': [('parent.is_multiple_budget','=',False)]}"/>
                                <field name="purchase_agreement" readonly="1" force_save="1"/>
                                <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]"
                                       options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                                <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                                <field name="section" domain="[('id','in',project_section_computed)]"
                                       options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                                <field name="variable" required="1"
                                       options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                                <field name="quantity" attrs="{'readonly':[('purchase_agreement','!=',False)]}" force_save='1'/>
                                <field name="budget_quantity" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}"/>
                                <field name="uom"/>
                                <field name="sub_total" attrs="{'readonly': [('is_subtotal_readonly','=',True)]}"/>
                                <field name="budget_amount" readonly="1"/>
                                <field name="discount_method" attrs="{'column_invisible': [('parent.discount_type','!=','line')]}"/>
                                <field name="discount_amount" attrs="{'column_invisible': [('parent.discount_type','!=','line')]}"/>
                                <field name="tax_id" widget="many2many_tags"/>
                                <field name="tax_amount" force_save='1'/>
                                <field name="total" force_save='1'/>
                                <field name="budget_amount_total" readonly="1" force_save='1' attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}"/>
                                <field name="state" readonly="1" force_save='1'/>
                                <field name="progressive_claim_perc" invisible="1"/>
                                <field name="dp_amount_percentage" string='Percentage Line (%)' optional="hide" force_save='1' widget="percentage"/>
                                <field name="dp_amount" optional="hide" force_save='1' invisible="1"/>
                                <field name="retention_amount_percentage" optional="hide" force_save='1' widget="percentage" invisible="1"/>
                                <field name="retention_amount" optional="hide" force_save='1' invisible="1"/>
                                <field name="retention_2_amount_percentage" optional="hide" force_save='1' widget="percentage" invisible="1"/>
                                <field name="retention_2_amount" optional="hide" force_save='1' invisible="1"/>
                                <field name="is_reserved" optional="hide" force_save='1'/>
                                <field name="is_subtotal_readonly" invisible="1"/>
                            </tree>
                        </field>
                        <group>
                            <group class="oe_left" attrs="{'invisible':['|', ('is_subcontracting','!=',True), ('discount_type','!=','global')]}" string="Discount">
                                <label for="discount_method_global" string="Method" attrs="{'invisible': [('discount_type','!=','global')]}"/>
                                <div>
                                    <field name="discount_method_global" class="oe_inline" attrs="{'invisible': [('discount_type','!=','global')]}"/>
                                </div>
                                <label for="discount_amount_global" string="Amount" attrs="{'invisible': [('discount_type','!=','global')]}"/>
                                <div>
                                    <field name="discount_amount_global" class="oe_inline" attrs="{'invisible': [('discount_type','!=','global')]}"/>
                                    <label for="discount_amount_global" string="%%" attrs="{'invisible': [('discount_method_global', '!=', 'per')]}" class="oe_inline"/>
                                </div>
                            </group>
                            <group class="oe_subtotal_footer oe_right">
                                <field name="material_total" widget="monetary" options="{'currency_field': 'currency_id'}" invisible='1'/>
                                <field name="service_total" widget="monetary" options="{'currency_field': 'currency_id'}" invisible='1'/>
                                <field name="equipment_total" widget="monetary" options="{'currency_field': 'currency_id'}" invisible='1'/>
                                <field name="labour_total" widget="monetary" options="{'currency_field': 'currency_id'}" invisible='1'/>
                                <field name="overhead_total" widget="monetary" options="{'currency_field': 'currency_id'}" invisible='1'/>

                                <field name="total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <field name="discount_amount" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                    <label for="discounted_total"/>
                                </div>
                                <field name="discounted_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <field name="tax_amount" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                    <label for="total_all"/>
                                </div>
                                <field name="total_all" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </group>
                        </group>
                    </page>
                    <!-- Add Variable Line End -->

                    <page string="Related Contracts" name="related_contract_ids" attrs="{'invisible': ['|', '|', ('is_subcontracting','=',False), ('addendum_payment_method','!=','split_payment'), ('count_contract', '&lt;', 2)]}">
                        <group> 
                            <field name="related_contract_ids" widget="many2many_list" nolabel="1" readonly="1" force_save="1"/>
                        </group>
                    </page>
                </xpath>
                <xpath expr="//page[@name='purchase_delivery_invoice']" position="before">
                    <page name="penalty_line" string ="Penalty" class="o_rfq_line" attrs="{'invisible': [('is_subcontracting', '!=', True)]}">
                        <div>
                            <br/>
                            <div width="100%">
                                <div>
                                    <h3>
                                        <b>Penalty Details</b>
                                    </h3>
                                    <hr/>
                                </div>
                            </div>
                            <br/>
                            <div>
                                <field name="diff_penalty" attrs="{'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                <label for="diff_penalty"/>
                            </div>
                            <group>
                                <group>
                                    <div width="100%" attrs="{'invisible': [('diff_penalty', '=', False)]}">
                                        <div>
                                            <h3>
                                                <b>Contractor</b>
                                            </h3>
                                            <hr/>
                                        </div>
                                    </div>
                                    <field name="method" attrs="{'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                    <label for="amount"/>
                                    <div name="amount_div" class="o_row">
                                        <field name="amount" attrs="{'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                        <label for="amount" string="%"
                                               attrs="{'invisible': [('method', '=', 'fix')]}"/>
                                    </div>
                                </group>
                                <group attrs="{'invisible': [('diff_penalty', '=', False)]}">
                                    <div width="100%">
                                        <div>
                                            <h3>
                                                <b>Vendor</b>
                                            </h3>
                                            <hr/>
                                        </div>
                                    </div>
                                    <field name="method_client" attrs="{'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                    <label for="amount_client"/>
                                    <div name="amount_div" class="o_row">
                                        <field name="amount_client" attrs="{'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                        <label for="amount_client" string="%"
                                               attrs="{'invisible': [('method_client', '=', 'fix')]}"/>
                                    </div>
                                </group>
                            </group>
                            <br/>
                        </div>
                    </page>
                </xpath>

                <xpath expr="//page[@name='variable_line']" position="before">
                    <page name="project_details" string="Contract Details" attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                        <group>
                            <group>
                                <field name="start_date" attrs="{'required':[('is_subcontracting','=',True)]}" />
                                <field name="end_date" attrs="{'required':[('is_subcontracting','=',True)]}"/>
                                <field name="duration" force_save="1"/>
                                <field name="sub_contracting" readonly='1' attrs="{'invisible':[('is_subcontracting','=',False)], 'required':[('is_subcontracting','=',True)]}" force_save="1"/>
                                <field name="main_po_reference" attrs="{'invisible':[('sub_contracting','!=','addendum')], 'required':[('sub_contracting','=','addendum')]}" readonly='1'/>
                                <field name="addendum_payment_method" force_save='1' readonly='1'
                                       attrs="{'invisible': [('sub_contracting','!=', 'addendum')]}" />
                                <field name="contract_parent_po" force_save="1" options="{'no_create': True, 'no_quick_create': True, 'no_create_edit':True}"
                                    attrs="{'invisible': ['|', ('is_subcontracting', '=', False), ('addendum_payment_method','!=', 'join_payment')], 'required':[('addendum_payment_method', '=', 'join_payment')]}" 
                                    domain="[('is_subcontracting', '=', True), ('project', '=', project), ('addendum_payment_method', '=', 'split_payment'), ('state', '=', 'purchase')]"/>
                                <field name="split_material"/>
                                <field name="split_po" widget="many2many_tags" attrs="{'invisible':[('split_material','=',False)]}" readonly="1" force_save="1"/>
                            </group>
                            <group>
                                <label for="down_payment" string="Down Payment" attrs="{'invisible':[('is_subcontracting','=',False)]}"/>
                                    <div class="d-flex" attrs="{'invisible':[('is_subcontracting','=',False)]}">
                                        <field name="down_payment_method" force_save="1" attrs="{'required':[('is_subcontracting','=',True)], 'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"
                                            placeholder="Method"/>
                                        <span attrs="{'invisible':[('is_subcontracting','=',False)]}" class="oe_inline o_form_label mx-3 oe_read_only"> Amount </span>
                                        <span attrs="{'invisible':[('is_subcontracting','=',False)]}" class="oe_inline o_form_label mr-3 ml-3 oe_edit_only"> Amount </span>
                                        <field name="down_payment" force_save="1" attrs="{'required':[('is_subcontracting','=',True)], 'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"
                                            placeholder="Amount"/>
                                        <label for="down_payment" string="%%"  class="oe_inline"
                                                                attrs="{'invisible': [('down_payment_method', '!=', 'per')]}"/>
                                    </div>
                                <field name="dp_amount" invisible="1" force_save="1"/>
                                <field name="retention_1" attrs="{'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                <field name="retention_1_date" invisible="1" attrs="{'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                <field name="retention_term_1" attrs="{'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                <field name="retention_2" attrs="{'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                <field name="retention_2_date" invisible="1" attrs="{'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                <field name="retention_term_2" attrs="{'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                <field name="tax_id" widget="many2many_tags" attrs="{'invisible':[('is_subcontracting','=',False)], 'readonly':['|', ('state', '!=', 'draft'), ('addendum_payment_method', '!=', 'split_payment')]}"/>
                                <field name="count_contract" invisible="1"/>
                            </group>
                        </group>
                    </page>
                </xpath>

                <!-- Add Page Estimation -->
                <xpath expr="//page[@name='variable_line']" position="after">
                    <page name="estimation" string="Estimation" attrs="{'invisible':[('is_subcontracting','!=',True)]}"/>
                </xpath>

                <!-- Add page inside estimation -->
                <xpath expr="//page[@name='estimation']" position="inside">
                    <notebook>
                        <!-- Add Material Line Start -->
                        <page name="material_line" string="Material" attrs="{'invisible':['|',('is_subcontracting','!=',True), ('split_material','=',True)]}">
                            <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>  
                            <field name="material_line_ids" class="o_rfq_line" attrs="{'readonly': [('state','not in', ('draft','sent'))]}">
                                <tree editable='bottom' create="0">
                                    <control>
                                        <create name="add_material_control" string="Add a material"/>
                                        <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                                        <create name="add_note_control" string="Add a note" context="{'default_display_type': 'line_note'}"/>
                                    </control>
                                    <field name="sequence" widget="handle"/>
                                    <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                                    <field name="section" domain="[('id','in',project_section_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="variable" string='Job Subcon'
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="product" required='1'/>
                                    <field name="description" widget="section_and_note_text"/>
                                    <field name="purchase_tender" readonly="1" invisible='1'/>
                                    <field name="receipt_date" invisible='1'/>
                                    <field name="destination_warehouse" invisible='1'/>
                                    <field name="analytic_group" widget="many2many_tags" optional='hide'/>
                                    <field name="discount_method" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="discount_amount" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="note_comment" invisible='1'/>
                                    <field name="quantity" required='1'/>
                                    <field name="budget_quantity" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="uom" required='1'/>
                                    <field name="secondary_quantity" readonly="1" invisible='1'/>
                                    <field name="secondary_uom" readonly="1" invisible='1'/>
                                    <field name="unit_price" required='1'/>
                                    <field name="budget_unit_price" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="taxes" widget="many2many_tags"/>
                                    <field name="lpp" readonly="1" invisible='1'/>
                                    <field name="lpp_of_vendor" readonly="1" invisible='1'/>
                                    <field name="subtotal" widget="monetary"/>
                                    <field name="remining_budget_amount" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right">
                                    <field name="ml_amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="ml_discount_amt" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <field name="ml_discount_amt_line" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','global')]}"/>
                                    <field name="ml_amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="ml_amount_total"/>
                                    </div>
                                    <field name="ml_amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </group>
                            <group style="width: 65%;">
                                <span>Payment Terms</span>
                                <div>
                                    <field name="payment_term_id" class="oe_inline"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Method</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_method_ml" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Amount</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_amount_ml" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <span string="%%" attrs="{'invisible': [('discount_method_ml', '!=', 'percentage')]}" class="oe_inline"/>
                                </div>
                                <span>Terms and Conditions</span>
                                <div>
                                    <field name="term_condition" class="oe_inline"/>
                                </div>
                            </group>
                            <group attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                                <group class="oe_subtotal_footer oe_right">
                                    <field name="material_total" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible':[('split_material','=',True)]}"/>
                                    <field name="service_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="equipment_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="labour_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="overhead_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                        <label for="total_all_estimation"/>
                                    </div>
                                    <field name="total_all_estimation" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                            <group name="note_group" col="6" class="mt-2 mt-md-0">
                                <group colspan="4">
                                    <div>
                                        <div>
                                        <field name="term_condition_box" nolabel="1" readonly="0" placeholder="Define your terms and conditions ..."/>
                                        </div>
                                    </div>
                                </group>
                                <group colspan="2">
                                </group>
                            </group>
                        </page>
                        <!-- Add Material Line End -->

                        <!-- Add Labour Line Start -->
                        <page name="labour_line" string="Labour" attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                            <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>  
                            <field name="labour_line_ids" class="o_rfq_line" attrs="{'readonly': [('state','not in', ('draft','sent'))]}">
                                <tree editable='bottom' create="0">
                                    <control>
                                        <create name="add_labour_control" string="Add a labour"/>
                                        <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                                        <create name="add_note_control" string="Add a note" context="{'default_display_type': 'line_note'}"/>
                                    </control>
                                    <field name="sequence" widget="handle"/>
                                    <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                                    <field name="section" domain="[('id','in',project_section_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="variable" string='Job Subcon'
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="product" required='1'/>
                                    <field name="description" widget="section_and_note_text"/>
                                    <field name="purchase_tender" readonly="1" invisible='1'/>
                                    <field name="receipt_date" invisible='1'/>
                                    <field name="destination_warehouse" invisible='1'/>
                                    <field name="analytic_group" widget="many2many_tags" optional='hide'/>
                                    <field name="discount_method" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="discount_amount" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="note_comment" invisible='1'/>
                                    <field name="quantity" required='1'/>
                                    <field name="budget_quantity" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="uom" required='1'/>
                                    <field name="secondary_quantity" readonly="1" invisible='1'/>
                                    <field name="secondary_uom" readonly="1" invisible='1'/>
                                    <field name="unit_price" required='1'/>
                                    <field name="budget_unit_price" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="taxes" widget="many2many_tags"/>
                                    <field name="lpp" readonly="1" invisible='1'/>
                                    <field name="lpp_of_vendor" readonly="1" invisible='1'/>
                                    <field name="subtotal" widget="monetary" />
                                    <field name="remining_budget_amount" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right">
                                    <field name="ll_amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="ll_discount_amt" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <field name="ll_discount_amt_line" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','global')]}"/>
                                    <field name="ll_amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="ll_amount_total"/>
                                    </div>
                                    <field name="ll_amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </group>
                            <group style="width: 65%;">
                                <span>Payment Terms</span>
                                <div>
                                    <field name="payment_term_id" class="oe_inline"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Method</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_method_ll" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Amount</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_amount_ll" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <span string="%%" attrs="{'invisible': [('discount_method_ll', '!=', 'percentage')]}" class="oe_inline"/>
                                </div>
                                <span>Terms and Conditions</span>
                                <div>
                                    <field name="term_condition" class="oe_inline"/>
                                </div>
                            </group>
                            <group attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                                <group class="oe_subtotal_footer oe_right">
                                    <field name="material_total" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible':[('split_material','=',True)]}"/>
                                    <field name="service_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="equipment_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="labour_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="overhead_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                        <label for="total_all_estimation"/>
                                    </div>
                                    <field name="total_all_estimation" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                            <group name="note_group" col="6" class="mt-2 mt-md-0">
                                <group colspan="4">
                                    <div>
                                        <div>
                                        <field name="term_condition_box" nolabel="1" readonly="0" placeholder="Define your terms and conditions ..."/>
                                        </div>
                                    </div>
                                </group>
                                <group colspan="2">
                                </group>
                            </group>
                        </page>
                        <!-- Add Labour Line End -->

                        <!-- Add Service Line Start -->
                        <page name="service_line" string="Service" attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                            <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>  
                            <field name="service_line_ids" class="o_rfq_line" attrs="{'readonly': [('state','not in', ('draft','sent'))]}">
                                <tree editable='bottom' create="0">
                                    <control>
                                        <create name="add_service_control" string="Add a service"/>
                                        <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                                        <create name="add_note_control" string="Add a note" context="{'default_display_type': 'line_note'}"/>
                                    </control>
                                    <field name="sequence" widget="handle"/>
                                    <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                                    <field name="section" domain="[('id','in',project_section_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="variable" string='Job Subcon'
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="product" required='1'/>
                                    <field name="description" widget="section_and_note_text"/>
                                    <field name="purchase_tender" readonly="1" invisible='1'/>
                                    <field name="receipt_date" invisible='1'/>
                                    <field name="destination_warehouse" invisible='1'/>
                                    <field name="analytic_group" widget="many2many_tags" optional='hide'/>
                                    <field name="discount_method" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="discount_amount" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="note_comment" invisible='1'/>
                                    <field name="quantity" required='1'/>
                                    <field name="budget_quantity" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="uom" required='1'/>
                                    <field name="secondary_quantity" readonly="1" invisible='1'/>
                                    <field name="secondary_uom" readonly="1" invisible='1'/>
                                    <field name="unit_price" required='1'/>
                                    <field name="budget_unit_price" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="taxes" widget="many2many_tags"/>
                                    <field name="lpp" readonly="1" invisible='1'/>
                                    <field name="lpp_of_vendor" readonly="1" invisible='1'/>
                                    <field name="subtotal" widget="monetary"/>
                                    <field name="remining_budget_amount" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right">
                                    <field name="sl_amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="sl_discount_amt" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <field name="sl_discount_amt_line" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','global')]}"/>
                                    <field name="sl_amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="sl_amount_total"/>
                                    </div>
                                    <field name="sl_amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </group>
                            <group style="width: 65%;">
                                <span>Payment Terms</span>
                                <div>
                                    <field name="payment_term_id" class="oe_inline"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Method</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_method_sl" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Amount</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_amount_sl" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <span string="%%" attrs="{'invisible': [('discount_method_sl', '!=', 'percentage')]}" class="oe_inline"/>
                                </div>
                                <span>Terms and Conditions</span>
                                <div>
                                    <field name="term_condition" class="oe_inline"/>
                                </div>
                            </group>
                            <group>
                                <group class="oe_subtotal_footer oe_right">
                                    <field name="material_total" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible':[('split_material','=',True)]}"/>
                                    <field name="service_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="equipment_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="labour_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="overhead_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                        <label for="total_all_estimation"/>
                                    </div>
                                    <field name="total_all_estimation" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                            <group name="note_group" col="6" class="mt-2 mt-md-0">
                                <group colspan="4">
                                    <div>
                                        <div>
                                        <field name="term_condition_box" nolabel="1" readonly="0" placeholder="Define your terms and conditions ..."/>
                                        </div>
                                    </div>
                                </group>
                                <group colspan="2">
                                </group>
                            </group>
                        </page>
                        <!-- Add Service Line End -->

                        <!-- Add Overhead Line Start -->
                        <page name="overhead_line" string="Overhead" attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                            <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>  
                            <field name="overhead_line_ids" class="o_rfq_line" attrs="{'readonly': [('state','not in', ('draft','sent'))]}">
                                <tree editable='bottom' create="0">
                                    <control>
                                        <create name="add_overhead_control" string="Add a overhead"/>
                                        <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                                        <create name="add_note_control" string="Add a note" context="{'default_display_type': 'line_note'}"/>
                                    </control>
                                    <field name="sequence" widget="handle"/>
                                    <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                                    <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                                    <field name="section" domain="[('id','in',project_section_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                                    <field name="variable" string='Job Subcon'
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"/>
                                    <field name="product" required='1'/>
                                    <field name="description" widget="section_and_note_text"/>
                                    <field name="purchase_tender" readonly="1" invisible='1'/>
                                    <field name="receipt_date" invisible='1'/>
                                    <field name="destination_warehouse" invisible='1'/>
                                    <field name="analytic_group" widget="many2many_tags" optional='hide'/>
                                    <field name="discount_method" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="discount_amount" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="note_comment" invisible='1'/>
                                    <field name="quantity" required='1'/>
                                    <field name="budget_quantity" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="uom" required='1'/>
                                    <field name="secondary_quantity" readonly="1" invisible='1'/>
                                    <field name="secondary_uom" readonly="1" invisible='1'/>
                                    <field name="unit_price" required='1'/>
                                    <field name="budget_unit_price" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="taxes" widget="many2many_tags"/>
                                    <field name="lpp" readonly="1" invisible='1'/>
                                    <field name="lpp_of_vendor" readonly="1" invisible='1'/>
                                    <field name="subtotal" widget="monetary"/>
                                    <field name="remining_budget_amount" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right">
                                    <field name="ol_amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="ol_discount_amt" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <field name="ol_discount_amt_line" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','global')]}"/>
                                    <field name="ol_amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="ol_amount_total"/>
                                    </div>
                                    <field name="ol_amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </group>
                            <group style="width: 65%;">
                                <span>Payment Terms</span>
                                <div>
                                    <field name="payment_term_id" class="oe_inline"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Method</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_method_ol" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Amount</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_amount_ol" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <span string="%%" attrs="{'invisible': [('discount_method_ol', '!=', 'percentage')]}" class="oe_inline"/>
                                </div>
                                <span>Terms and Conditions</span>
                                <div>
                                    <field name="term_condition" class="oe_inline"/>
                                </div>
                            </group>
                            <group attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                                <group class="oe_subtotal_footer oe_right">
                                    <field name="material_total" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible':[('split_material','=',True)]}"/>
                                    <field name="service_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="equipment_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="labour_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="overhead_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                        <label for="total_all_estimation"/>
                                    </div>
                                    <field name="total_all_estimation" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                            <group name="note_group" col="6" class="mt-2 mt-md-0">
                                <group colspan="4">
                                    <div>
                                        <div>
                                        <field name="term_condition_box" nolabel="1" readonly="0" placeholder="Define your terms and conditions ..."/>
                                        </div>
                                    </div>
                                </group>
                                <group colspan="2">
                                </group>
                            </group>
                        </page>
                        <!-- Add Overhead Line End -->

                        <!-- Add Equipment Line Start -->
                        <page name="equipment_line" string="Equipment" attrs="{'invisible':[('is_subcontracting','!=',True)]}">
                            <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>  
                            <field name="equipment_line_ids" class="o_rfq_line" attrs="{'readonly': [('state','not in', ('draft','sent'))]}">
                                <tree editable='bottom' create="0">
                                    <control>
                                        <create name="add_equipment_control" string="Add a equipment"/>
                                        <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                                        <create name="add_note_control" string="Add a note" context="{'default_display_type': 'line_note'}"/>
                                    </control>
                                    <field name="sequence" widget="handle"/>
                                    <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                                    <field name="section" domain="[('id','in',project_section_computed)]"
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="variable" string='Job Subcon'
                                           options="{'no_create':True, 'no_quick_create':True, 'no_create_edit':True}"
                                           required='1'/>
                                    <field name="product" required='1'/>
                                    <field name="description" widget="section_and_note_text"/>
                                    <field name="purchase_tender" readonly="1" invisible='1'/>
                                    <field name="receipt_date" invisible='1' />
                                    <field name="destination_warehouse" invisible='1' />
                                    <field name="analytic_group" widget="many2many_tags" optional='hide'/>
                                    <field name="discount_method" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="discount_amount" attrs="{'readonly':[('parent.discount_type','=','global')]}" force_save='1' invisible='1'/>
                                    <field name="note_comment" invisible='1'/>
                                    <field name="quantity" required='1' />
                                    <field name="budget_quantity" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="uom" required='1'/>
                                    <field name="secondary_quantity" readonly="1" invisible='1'/>
                                    <field name="secondary_uom" readonly="1" invisible='1'/>
                                    <field name="unit_price" required='1'/>
                                    <field name="budget_unit_price" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                    <field name="taxes" widget="many2many_tags"/>
                                    <field name="lpp" readonly="1" invisible='1'/>
                                    <field name="lpp_of_vendor" readonly="1" invisible='1'/>
                                    <field name="subtotal" widget="monetary"/>
                                    <field name="remining_budget_amount" readonly="1" attrs="{'column_invisible': [('parent.budgeting_method', '!=', 'product_budget')]}" invisible='1'/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right">
                                    <field name="el_amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="el_discount_amt" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <field name="el_discount_amt_line" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible': [('discount_type','=','global')]}"/>
                                    <field name="el_amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="el_amount_total"/>
                                    </div>
                                    <field name="el_amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </group>
                            <group style="width: 65%;">
                                <span>Payment Terms</span>
                                <div>
                                    <field name="payment_term_id" class="oe_inline"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Method</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_method_el" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                </div>
                                <span attrs="{'invisible': [('discount_type','=','line')]}">Discount Amount</span>
                                <div attrs="{'invisible': [('discount_type','=','line')]}">
                                    <field name="discount_amount_el" class="oe_inline" attrs="{'invisible': [('discount_type','=','line')]}"/>
                                    <span string="%%" attrs="{'invisible': [('discount_method_el', '!=', 'percentage')]}" class="oe_inline"/>
                                </div>
                                <span>Terms and Conditions</span>
                                <div>
                                    <field name="term_condition" class="oe_inline"/>
                                </div>
                            </group>
                            <group>
                                <group class="oe_subtotal_footer oe_right">
                                    <field name="material_total" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'invisible':[('split_material','=',True)]}"/>
                                    <field name="service_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="equipment_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="labour_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="overhead_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                        <label for="total_all_estimation"/>
                                    </div>
                                    <field name="total_all_estimation" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                            <group name="note_group" col="6" class="mt-2 mt-md-0">
                                <group colspan="4">
                                    <div>
                                        <div>
                                        <field name="term_condition_box" nolabel="1" readonly="0" placeholder="Define your terms and conditions ..."/>
                                        </div>
                                    </div>
                                </group>
                                <group colspan="2">
                                </group>
                            </group>
                        </page>
                        <!-- Add Equipment Line End -->

                    </notebook>
                </xpath>
            </field>
        </record>  
    </data>
</odoo>
