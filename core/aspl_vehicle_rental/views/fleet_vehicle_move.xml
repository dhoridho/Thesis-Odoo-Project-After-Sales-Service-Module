<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <data>

        <record id="fleet_vehicle_move_search" model="ir.ui.view">
            <field name="name">Vehicle Move</field>
            <field name="model">fleet.vehicle.move</field>
            <field name="arch" type="xml">
                <search>
                    <field name="ref_number" filter_domain="[('name','ilike',self)]" string="Name"/>
                    <field name="move_type" filter_domain="[('move_type','ilike',self)]" string="Type of Operation"/>
                    <filter string="Un Done" name="undone" domain="[('state','not in',['done','inspection'])]"/>
                    <filter string="Type of Operation" name="move_type" domain="[]"
                            context="{'group_by': 'move_type'}"/>
                    <filter string="Source Document" name="source_document" domain="[]"
                            context="{'group_by':'source_document'}"/>
                </search>
            </field>
        </record>

        <record id="fleet_vehicle_move_form_id" model="ir.ui.view">
            <field name="name">Vehicle Move</field>
            <field name="model">fleet.vehicle.move</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <field name="state" widget="statusbar"/>
                        <button name="incoming" string="Receive" type="object" class="oe_highlight" states="on_rent"/>
                        <button name="delivery" string="Deliver Car" type="object" class="oe_highlight"
                                states="ready,partial"/>
                        <button name="%(aspl_vehicle_rental.action_fleet_inspection_move)d" string="Inspections Created"
                                type="action" class="oe_highlight" states="inspection"/>
                        <button name="move" string="Move to Parking" type="object" class="oe_highlight"
                                states="service"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button type="object" class="oe_stat_button" icon="fa-book"
                                    name="action_view_move_contract"
                                    attrs="{'invisible': [('contract_count','=',0)]}">
                                <div class="o_form_field o_stat_info">
                                    <span class="o_stat_value">
                                        <field name="contract_count"/>
                                    </span>
                                    <span class="o_stat_text">Contract</span>
                                </div>
                            </button>
                        </div>
                        <div class="oe_title">
                            <h1>
                                <field name="ref_number" placeholder="New"/>
                                <field name="vehicle_order_rel_id" invisible="1"/>
                                <field name="currency_id" invisible="1"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="customer_id"/>
                                <field name="from_date"/>
                                <field name="is_delayed" states="on_rent"/>
                                <field name="station_id"/>
                                <field name="fuel_level" attrs="{'invisible': [('state', 'in', ('partial', 'on_rent', 'inspection', 'service', 'done'))]}"/>
                            </group>
                            <group>
                                <field name="scheduled_date"/>
                                <field name="to_date"/>
                                <field name="source_document"/>
                                <field name="move_type"/>
                                <field name="is_fuel_charge" invisible="1"/>
                                <field name="return_fuel_level" attrs="{'invisible': [('state', 'in', ('partial', 'ready', 'inspection', 'service', 'done'))]}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Operations">
                                <group>
                                    <field name="vehicle_move_line_id" nolabel="1">
                                        <tree editable="bottom">
                                            <field name="vehicle_move_id" invisible="1"/>
                                            <field name="vehicle_id"/>
                                            <field name="current_odometer"/>
                                            <field name="tools_ids" widget='many2many_tags'/>
                                            <field name="vehicles_checked"/>
                                        </tree>
                                    </field>
                                </group>
                            </page>
                            <page string="Additional Info">
                                <group>
                                    <group>
                                        <field name="source_location"/>
                                    </group>
                                    <group>
                                        <field name="destination_location"/>
                                    </group>
                                </group>
                            </page>
                            <page string="Delayed Hours" attrs="{'invisible':[('is_delayed','=',False)]}">
                                <group>
                                    <field name="vehicle_delay_line_ids" nolabel="1">
                                        <tree editable="bottom">
                                            <field name="vehicle_delay_id" invisible="1"/>
                                            <field name="vehicle_id"/>
                                            <field name="delay_cost_per_hour"/>
                                            <field name="delayed_hours" widget="float_time"/>
                                            <field name="currency_id" invisible="1"/>
                                            <field name="sub_total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                        </tree>
                                    </field>
                                </group>
                                <group class="oe_subtotal_footer oe_right" colspan="2" name="delay_cost_total">
                                    <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                        <label for="total_amount"/>
                                    </div>
                                    <field name="total_amount" nolabel="1" class="oe_subtotal_footer_separator"
                                           widget='monetary'/>
                                </group>
                            </page>
                            <page string="Fuel Charge" attrs="{'invisible':[('is_fuel_charge','=',False)]}">
                                <group>
                                    <field name="fuel_charge_line_ids" nolabel="1">
                                        <tree editable="bottom">
                                            <field name="vehicle_fuel_id" invisible="1"/>
                                            <field name="name"/>
                                            <field name="fuel_charge_amount"/>
                                        </tree>
                                    </field>
                                </group>
                                <group class="oe_subtotal_footer oe_right" colspan="2" name="delay_cost_total">
                                    <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                        <label for="total_amount"/>
                                    </div>
                                    <field name="total_amount" nolabel="1" class="oe_subtotal_footer_separator"
                                           widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="fleet_vehicle_move_tree_id" model="ir.ui.view">
            <field name="name">Vehicle Move</field>
            <field name="model">fleet.vehicle.move</field>
            <field name="arch" type="xml">
                <tree decoration-danger="state!='done'" decoration-muted="state in ['done','inspection']">
                    <field name="ref_number"/>
                    <field name="customer_id"/>
                    <field name="scheduled_date"/>
                    <field name="source_document"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="fleet_vehicle_logs_form_id" model="ir.ui.view">
            <field name="name">Vehicle Logs</field>
            <field name="model">fleet.vehicle.logs</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="vehicle_id"/>
                                <field name="customer_id"/>
                                <field name="odometer"/>
                                <field name="odometer_unit"/>
                                <field name="from_date"/>
                                <field name="to_date"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="fleet_vehicle_logs_tree_id" model="ir.ui.view">
            <field name="name">Vehicle Logs</field>
            <field name="model">fleet.vehicle.logs</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="vehicle_id"/>
                    <field name="customer_id"/>
                    <field name="odometer"/>
                    <field name="odometer_unit"/>
                    <field name="from_date"/>
                    <field name="to_date"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_vehicle_logs_pivot">
            <field name="name">Vehicles Logs</field>
            <field name="model">fleet.vehicle.logs</field>
            <field name="arch" type="xml">
                <pivot string="Vehicle Logs">
                    <field name="vehicle_id" type="row"/>
                    <field name="from_date" type="col"/>
                </pivot>
            </field>
        </record>

        <record model="ir.ui.view" id="view_vehicle_logs_graph">
            <field name="name">Vehicles Logs</field>
            <field name="model">fleet.vehicle.logs</field>
            <field name="arch" type="xml">
                <graph string="Vehicle Logs">
                    <field name="vehicle_id" type="row"/>
                    <field name="from_date" type="col"/>
                </graph>
            </field>
        </record>

        <record id="action_fleet_vehicle_logs" model="ir.actions.act_window">
            <field name="name">Vehicle Logs</field>
            <field name="res_model">fleet.vehicle.logs</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_fleet_vehicle_logs_analysis" model="ir.actions.act_window">
            <field name="name">Vehicle Logs</field>
            <field name="res_model">fleet.vehicle.logs</field>
            <field name="view_mode">graph,pivot</field>
        </record>

        <record id="action_fleet_vehicle_move" model="ir.actions.act_window">
            <field name="name">Vehicle Move</field>
            <field name="res_model">fleet.vehicle.move</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_undone': 1}</field>
        </record>

        <record id="action_rental_move_view_tree" model="ir.actions.act_window">
            <field name="name">Fleet Vehicle Move</field>
            <field name="res_model">fleet.vehicle.move</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="fleet_vehicle_move_tree_id"/>
            <field name="domain">[('state', 'not in', ['draft', 'close'])]</field>
        </record>

        <menuitem id="feet_vehicle_move_sub_menu" name="Vehicle Move" parent="fleet_vehicle_booking_menu"
                  action="action_fleet_vehicle_move"/>
        <menuitem id="feet_vehicle_logs_menu" name="Vehicle Logs" parent="fleet_vehicle_booking_menu"
                  action="action_fleet_vehicle_logs"/>
        <menuitem id="feet_vehicle_logs_analysis" name="Vehicles Log" parent="fleet_vehicle_analysis"
                  action="action_fleet_vehicle_logs_analysis"/>

    </data>
</odoo>
