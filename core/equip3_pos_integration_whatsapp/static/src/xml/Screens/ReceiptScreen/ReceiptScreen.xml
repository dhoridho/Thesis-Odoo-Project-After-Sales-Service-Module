<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-name="ReceiptScreen" t-inherit="point_of_sale.ReceiptScreen" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[hasclass('receipt-screen')]" position="attributes">
            <attribute name="t-att-class">{ pos_whatsapp: env.pos.company.pos_whatsapp_notification_for_receipt,oe_hidden: !props.isShown}</attribute>
        </xpath>
        <xpath expr="//form[hasclass('send-email')]" position="before">

            <!-- cache image -->
            <!-- <div class="cache_images_for_faster_load_at_css">
                <img src="/equip3_pos_integration_whatsapp/static/src/img/check-circle-fill-tosca.svg" style="display:none;"/>
                <img src="/equip3_pos_integration_whatsapp/static/src/img/check-circle-fill-white.svg" style="display:none;"/>
                <img src="/equip3_pos_integration_whatsapp/static/src/img/email-tosca.svg" style="display:none;"/>
                <img src="/equip3_pos_integration_whatsapp/static/src/img/email-white.svg" style="display:none;"/>
                <img src="/equip3_pos_integration_whatsapp/static/src/img/whatsapp-tosca.svg" style="display:none;"/>
                <img src="/equip3_pos_integration_whatsapp/static/src/img/whatsapp-white.svg" style="display:none;"/>
            </div> -->

            <div class="buttons buttons-send-receipt-mode" style="width: 100%;" t-att-mode="orderUiState.sendReceiptMode" t-if="env.pos.company.pos_whatsapp_notification_for_receipt">
                <div class="button send-receipt-mode" mode="whatsapp" t-on-click="changeSendReceiptMode('whatsapp')">
                    <i class="fa fa-whatsapp"></i><span>Whatsapp</span>
                </div>
                <div class="button send-receipt-mode" mode="email" t-on-click="changeSendReceiptMode('email')">
                    <i class="fa fa-envelope"></i><span>E-mail</span>
                </div>
            </div> 
        </xpath>

        <xpath expr="//form[hasclass('send-email')]" position="after">
            <form t-on-submit.prevent="onSumbitSendWhatsappMessage" class="send-whatsapp" t-if="env.pos.company.pos_whatsapp_notification_for_receipt">
                <!-- <div class="whatsapp-icon"><i class="fa fa-whatsapp" aria-hidden="true"></i></div> -->
                <div class="input-whatsapp">
                    <input type="number" placeholder="Input your phone number (ex: 6281xxxxxxxxx)" 
                        t-model="orderUiState.inputWhatsappNumber" />
                    <button class="send" type="submit">Send</button>
                </div>

                <t t-if="orderUiState.whatsappSuccessful !== null">
                    <t t-set="_add_class" t-value="orderUiState.whatsappSuccessful"/>
                    <div class="notice notice-right" t-attf-class="{{ orderUiState.whatsappSuccessful ? 'successful ' + _add_class : 'failed'}}">
                        <t t-if="orderUiState.whatsappSuccessful == 'process_sending_message'">
                            <span class="fa fa-spinner"></span>
                        </t>
                        <span><t t-esc="orderUiState.whatsappNotice"></t></span>
                    </div>
                </t>
            </form>
        </xpath>

        <xpath expr="//form[hasclass('send-email')]" position="inside">
            <t t-if="orderUiState.emailSuccessful !== null">
                <div class="notice notice-right" t-attf-class="{{ orderUiState.emailSuccessful ? 'successful' : 'failed' }}">
                    <t t-esc="orderUiState.emailNotice"></t>
                </div>
            </t>
        </xpath>

    </t>

</templates>