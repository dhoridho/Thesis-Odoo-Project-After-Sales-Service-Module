<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<template id="report_profit_loss">
			<t t-call="web.html_container">
				<t t-call="web.basic_layout"> 
					<div class="header" t-att-style="'font-family:'+user_id.company_id.font_id.family+';font-size:'+str(user_id.company_id.font_size)+'px;'">  
                        <table border="0" cellpadding="0" cellspacing="0" style="line-height: 15px;" width="100%">
                            <tr>
                                <td align="left" style="color:#4D4D4F; padding:0px 15px; border-right: 1px solid #D4D1D1; width:30%; vertical-align: middle!important;">
                                    <img style="max-height:50px; display:inline-block; width:auto;" t-att-src="'data:image/png;base64,%s' % to_text(user_id.company_id.logo)"/> 
                                </td>
                                <td style="padding:15px; width:70% vertical-align: middle!important;font-size:14px;"> 
                                    <!--<p t-attf-style="text-transform:capitalize; color: #{theme_color or '#ffffff'}; font-weight:bold;margin:0; margin-bottom:5px;">Address</p>-->
                                    <!--<t t-call="general_template.templates_company_details"/>-->
                                    <div style="color: #51565b;">
                                      <div><strong>Address:</strong></div>
                                      <div t-field="user_id.company_id.partner_id"/>
                                      <t t-if="user_id.company_id.partner_id.street">
                                          <div>
                                              <span t-esc="user_id.company_id.partner_id.street"/>
                                              <br/>
                                          </div>
                                      </t>
                                      <t t-if="user_id.company_id.partner_id.mobile">
                                          <strong>Mobile:</strong>
                                          <span t-field="user_id.company_id.partner_id.mobile"/>
                                          <br/>
                                      </t>
                                      <t t-if="user_id.company_id.partner_id.email">
                                          <strong>Email:</strong>
                                          <span t-field="user_id.company_id.partner_id.email"/> 
                                      </t>
                                    </div>
                                </td>
                            </tr>
                        </table> 
                    </div>

					<div class="page">
						<div style="padding-top:1px;border:1px solid black;color:#ffffff; background-color: #333333;" class='text-center'>
							<h2>Profit-Loss Report</h2>
						</div>
						<br/>						
						<div class="container">		
							<div>
								<span >Report Date time :</span> 
								<span style="margin-left:70%;">
									<t t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M %p')" />
								</span><br/>
							</div>
							<div>
								<span >Start Date : </span>
								<span style="margin-left:75%;"><t t-esc="start_dt"/></span>
								<br/>
							</div>
							<div>
								<span >End Date : </span>
								<span style="margin-left:76%;"><t t-esc="end_dt"/></span>
							</div>
							<br/>							
							<table class="table table-sm">
								<tbody>
									<t t-set="grand_total" t-value="0.0" />
									<t t-set="grand_qty" t-value="0.0" />
									<t t-set="grand_unitprice" t-value="0.0" />
									<t t-set="grand_discount" t-value="0.0" />
									<t t-set="grand_taxes" t-value="0.0" />
									<t t-set="grand_costprice" t-value="0.0" />
									<t t-set="grand_grossprofit" t-value="0.0" />
									<tr t-attf-style="page-break-inside: avoid !important;background-color: #333333 ;">												
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" colspan="3" >Product Name</td>
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" >Quantity</td>
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" >Unit</td>
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" >Unit Price</td>
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" >Discount</td>
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" >Taxes</td>
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" >Amount w/o  Tax</td>
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" >Cost Price</td>
										<td align="center" t-attf-style="padding:5px 10px;border:1px solid #{theme_color or '#000000'} !important; border-right:0px solid; color: #ffffff; font-weight:bold" >Gross Profit/Loss</td>
									</tr>											
									<t t-foreach="prod_data" t-as="u">
										<tr>
											<td colspan="3"><t t-esc="u['product_name']"/></td>
											<td style="text-align:right;"><t t-esc="u['qty']"/></td>
											<td style="text-align:right;"><t t-esc="u['uom_name']"/></td>
											<td style="text-align:right;">
												<t t-esc="'%.2f'% u['price_unit']" />
											</td>
											<td style="text-align:right;">
												<t t-esc="'%.2f'% u['discount']" />
											</td>
											<td style="text-align:right;">
												<t t-esc="'%.2f'% u['taxes']" />
											</td>
											<td style="text-align:right;">
												<t t-esc="'%.2f'% u['price_subtotal']" />
											</td>
											<td style="text-align:right;">
												<t t-esc="'%.2f'% u['cost_price']" />
											</td>
											<td style="text-align:right;">
												<t t-esc="'%.2f'% u['gross_profit']" />
											</td>
										</tr>
										<t t-set="grand_total" t-value="grand_total + u['price_subtotal']"/>
										<t t-set="grand_qty" t-value="grand_qty + u['qty']"/>
										<t t-set="grand_unitprice" t-value="grand_unitprice + float (u['price_unit'])"/>	
										<t t-set="grand_discount" t-value="grand_discount + float (u['discount'])"/>
										<t t-set="grand_taxes" t-value="grand_taxes + float (u['taxes'])"/>
										<t t-set="grand_costprice" t-value="grand_costprice + float (u['cost_price'])"/>	
										<t t-set="grand_grossprofit" t-value="grand_grossprofit + float (u['gross_profit'])"/>			
									</t>
									<tr style="border-top: 2px solid black !important;">
										<td colspan="3" style="font-weight:bold"><strong>Total</strong></td>
										<td style="text-align:right; font-weight:bold">	<t t-esc="'%.2f'% grand_qty"/></td>
									  	<!--  <td style="text-align:right;">  <t t-esc="'{:,}'.format(grand_qty).split('.')[0]"/></td> -->
									   	<td style="text-align:right; style="></td>
								  		<td style="text-align:right; font-weight:bold"><t t-esc="'%.2f'% grand_unitprice" /></td>
								  		<td style="text-align:right; font-weight:bold"><t t-esc="'%.2f'% grand_discount" /></td>
										<td style="text-align:right; font-weight:bold"><t t-esc="'%.2f'% grand_taxes" /></td>
										<td style="text-align:right; font-weight:bold"><t t-esc="'%.2f'% grand_total" /></td>
										<td style="text-align:right; font-weight:bold"><t t-esc="'%.2f'% grand_costprice" /></td>
										<td style="text-align:right; font-weight:bold"><t t-esc="'%.2f'% grand_grossprofit" /></td>
									</tr>
								</tbody>
							</table>							
						</div>
						<hr/>
					</div>

					<div class="footer" t-att-style="'font-family:'+user_id.company_id.font_id.family+';font-size:'+str(user_id.company_id.font_size)+'px;'" t-if="user_id.company_id.report_footer_selection == 'standard'">
                        <div class="text-center" style="border-top: 1px solid black;">
                            <ul class="list-inline mb4">
                                <li t-if="user_id.company_id.phone">Phone: 
                                    <span t-field="user_id.company_id.phone"/></li>
                                <li t-if="user_id.company_id.email">Email: 
                                    <span t-field="user_id.company_id.email"/></li>
                                <li t-if="user_id.company_id.website">Web: 
                                    <span t-field="user_id.company_id.website"/></li>
                                <li t-if="user_id.company_id.vat">
                                    <t t-esc="user_id.company_id.country_id.vat_label or 'TIN'"/>: 
                                    <span t-field="user_id.company_id.vat"/></li>
                            </ul>
                            <div name="financial_infos">
                                <span t-field="user_id.company_id.report_footer"/>
                            </div>
                            <div class="text-muted">Page: 
                                <span class="page"/>
                                / 
                                <span class="topage"/></div>
                        </div>
                    </div>
				</t>
			</t>
		</template>

		<record id="pos_profit_paper_format" model="report.paperformat">
			<field name="name">Sales Details (w)</field>
			<field name="default" eval="True" />
			<field name="format">custom</field>			
			<field name="margin_top">30</field>
			<field name="margin_bottom">10</field>
			<field name="margin_left">5</field>
			<field name="margin_right">5</field>
			<field name="header_line" eval="False" />
			<field name="orientation">Portrait</field>
			<field name="header_spacing">26</field>
			<field name="dpi">110</field>
		</record>

	</data>
</odoo>
