<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- school.intake -->
        <!-- views -->
            <!-- form -->
            <record id="view_school_standard_form_inherit" model="ir.ui.view">
                <field name="model">school.standard</field>
                <field name="inherit_id" ref="school.view_school_standard_form"/>
                <field name="arch" type="xml">
                    <xpath expr="//form" position="replace">
                        <form string="Standard Information">
                            <header>
                                <button string="Group Class" name="button_generate_group_class" type="object" class="oe_highlight"/>
                            </header>
                            <sheet>
                                <div class="oe_button_box" name="button_box">
                                    <button name="action_group_class" type="object">
                                        <i class="o-hm-icon o-hm-smart-hrm-group-day" style="font-size:30px;padding-left:4px;"/>
                                        <span style="margin-top: -16px;margin-left: 8px;">Group Class</span>
                                    </button>
                                    <button name="action_admisson_register" type="object">
                                        <i class="o-hm-icon o-hm-sidebar-main-school-admission-register" style="font-size:30px;margin-left:2px;"/>
                                        <span style="margin-top: -16px;margin-left: 8px;">Admission Register</span>
                                    </button>
                                    <button name="action_classes" type="object">
                                        <i class="o-hm-icon o-hm-smart-school-classes" style="font-size:30px;margin-left:4px;"/>
                                        <span style="margin-top: -16px;margin-left: 8px;">Classes</span>
                                    </button>
                                </div>
                                <br/>
                                <br/>
                                <separator string="Standard Information" />
                                <group>
                                    <group>
                                        <field name="name" required="1"/>
                                        <field name="active" invisible="1"/>
                                        <field name="school_id" placeholder="School" options="{'no_quick_create': True, 'no_create_edit': True}"/>
                                        <field name="branch_id" invisible="1"/>
                                        <field name="start_year"/>
                                        <field name="start_date"/>
                                        <field name="total_students"/>
                                        <field name="related_program_ids" invisible="1"/>
                                    </group>
                                    <group>
                                        <field name="standard_id" required="1" domain="[('id', 'in', related_program_ids)]" string="Program" placeholder="Program"/>
                                        <field name="fees_ids" readonly="1"/>
                                        <field name="user_id" placeholder="Select PIC Name" domain="[('program_id', '=', standard_id)]"/>
                                        <field name="capacity"/>
                                        <field name="remaining_seats"/>
                                    </group>
                                </group>
                                <notebook>
                                    <page string="done student ids" invisible="1">
                                        <field name="done_student_ids" invisible="1">
                                            <tree>
                                                <field name="name"></field>
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Student">
                                        <field name="intake_student_line_ids" readonly="1" force_save="1">
                                            <tree editable="bottom" create="0" delete="0">
                                                <field name="student_id" options="{'no_create_edit': True}"></field>
                                                <field name="group_class_id" options="{'no_create_edit': True}"></field>
                                            </tree>
                                            <form>
                                                <sheet>
                                                    <group>
                                                        <field name="student_id"></field>
                                                        <field name="group_class_id"></field>
                                                    </group>
                                                </sheet>
                                            </form>
                                        </field>
                                    </page>
                                    <page string="Subject">
                                        <field name='intake_subject_line_ids'>
                                            <tree editable="bottom" string="Subject">
                                                <field name="related_subject_ids" widget="many2many_tags" invisible="1"/>
                                                <field name="year"/>
                                                <field name="subject_id" domain="[('id', 'in', related_subject_ids)]"/>
                                                <field name="subject_type"/>
                                                <field name="year_id" string="Academic Year" required="1"/>
                                                <field name="term_id" string="Term" domain="[('year_id', '=', year_id)]" required="1"/>
                                            </tree>
                                            <form>
                                                <sheet>
                                                    <group>
                                                        <field name="related_subject_ids" widget="many2many_tags" invisible="1"/>
                                                        <field name="year"/>
                                                        <field name="subject_id" domain="[('id', 'in', related_subject_ids)]"/>
                                                        <field name="subject_type"/>
                                                        <field name="year_id" string="Academic Year" required="1"/>
                                                        <field name="term_id" string="Term" domain="[('year_id', '=', year_id)]" required="1"/>
                                                    </group>
                                                </sheet>
                                            </form>
                                        </field>
                                    </page>
                                </notebook>
                                <div class="oe_chatter">
                                    <field name="message_follower_ids"/>
                                    <field name="activity_ids"/>
                                    <field name="message_ids"/>
                                </div>
                            </sheet>
                        </form>
                    </xpath>
                </field>
            </record>

            <!-- tree -->
            <record id="view_school_standard_tree_inherit" model="ir.ui.view">
                <field name="model">school.standard</field>
                <field name="inherit_id" ref="school.view_school_standard_tree"/>
                <field name="arch" type="xml">
                    <xpath expr="//field[@name='standard_id']" position="before">
                        <field name="name"/>
                        <field name="active" invisible="1"/>
                    </xpath>
                    <xpath expr="//field[@name='division_id']" position="attributes">
                        <attribute name="invisible">1</attribute>
                    </xpath>
                    <xpath expr="//field[@name='medium_id']" position="attributes">
                        <attribute name="invisible">1</attribute>
                    </xpath>
                </field>
            </record>


            <!-- add pivot view for School Hierarchy/intake to use in change view main menu-->
            <record id="school_intake_view_pivot" model="ir.ui.view">
                <field name="name">school_intake.view.pivot</field>
                <field name="model">school.standard</field>
                <field name="arch" type="xml">
                    <pivot string="Intake" display_quantity="1">
                        <field name="color" invisible="1"/>
                        <field name="course_id" invisible="1"/>
                        <field name="create_uid" invisible="1"/>
                        <field name="division_id" invisible="1"/>
                        <field name="write_uid" invisible="1"/>
                        <field name="message_main_attachment_id" invisible="1"/>
                        <field name="medium_id" invisible="1"/>
                        <field name="name" invisible="1"/>
                        <field name="user_id" invisible="1"/>
                        <field name="standard_id" invisible="1"/>
                        <field name="status" invisible="1"/>
                        <field name="create_date" invisible="1"/>
                        <field name="write_date" invisible="1"/>
                        <field name="remaining_seats" invisible="1"/>
                        <field name="remaining_seats" type="measure"/>
                        <field name="capacity" invisible="1"/>
                        <field name="capacity" type="measure"/>
                        <field name="total_students" invisible="1"/>
                        <field name="total_students" type="measure"/>
                        
                    </pivot>
                </field>
            </record>

            <record id="school_standard_graph_view" model="ir.ui.view">
                <field name="name">school.standard.tree.view.graph</field>
                <field name="model">school.standard</field>
                <field name="arch" type="xml">
                    <graph string='Intake Graph'>
                        <field name="name"/>                
                        <field name="remaining_seats" type='measure'/>
                    </graph>
                </field>
            </record>

        <!-- action -->
            <!--button form view intake-->
            <record id="action_school_standard_form_btn" model="ir.actions.act_window">
                <field name="name">Intake</field>
                <field name="res_model">school.standard</field>
                <field name="view_mode">tree,form,pivot</field>
                <field name="context">{'search_default_is_active': 1}</field>
            </record>
            
            <record id="action_school_standard_pivot_view" model="ir.actions.act_window.view">
                <field name="view_mode">pivot</field>
                <field eval="22" name="sequence" />
                <field name="view_id" ref="school_intake_view_pivot" />
                <field name="act_window_id" ref="school.action_school_standard_form" />
            </record>

            <record id="action_standard_standard_graph_view" model="ir.actions.act_window.view">
                <field name="view_mode">graph</field>
                <field eval="23" name="sequence" />
                <field name="view_id" ref="school_standard_graph_view" />
                <field name="act_window_id" ref="school.action_school_standard_form" />
            </record>

</odoo>
