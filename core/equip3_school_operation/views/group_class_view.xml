<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <!-- group.class form view -->
  <record id="group_class_view_form" model="ir.ui.view">
    <field name="name">Group Class Form</field>
    <field name="model">group.class</field>
    <field name="arch" type="xml">
      <form string="Group Class">
        <header>
            <button string="Validate" name="button_validate" type="object" class="oe_highlight" states="draft"/>
            <button string="Generate Subject Weightage" name="generate_subject_weightage" type="object" class="oe_highlight" states="validated"/>
          <field name="state" widget="statusbar"></field>
        </header>
        <sheet>
          <div class="oe_button_box" name="button_box">
              <button name="action_subject_weightage_btn" type="object" attrs="{'invisible': [('subject_weightage_already_generated', '=', False)]}">
                <i class="o-hm-icon o-hm-smart-school-scoring" style="font-size:30px;padding-left: 16px;"/>
                <span style="margin-top: -16px;margin-left: 8px;">Subject Weightage</span>
              </button>
              <button name="action_classes_btn" type="object">
                <i class="o-hm-icon o-hm-smart-school-classes" style="font-size:30px;padding-left: 16px;"/>
                <span style="margin-top: -16px;margin-left: 8px;">Classes</span>
              </button>
          </div>
          <group>
              <group>
                <field name="name" required="1" attrs="{'readonly': [('state', '=', 'validated')]}"/>
                <field name="active" invisible="1"/>
                <field name="intake" required="1" options="{'no_create': True, 'no_create_edit':True}" attrs="{'readonly': [('state', '=', 'validated')]}"/>
                <field name="subject_weightage_already_generated" invisible="1" />
              </group>
              <group>
                <field name="pic" required="0" attrs="{'readonly': [('state', '=', 'validated')]}"/>
              </group>
          </group>
          <group>
            <notebook>
              <page name="student" string="Students">
                  <field name="students" attrs="{'readonly': [('state', '=', 'validated')]}" invisible="1">
                    <tree editable="bottom">
                        <field name="student_name" domain="[('id', 'in', related_student_ids)]"/>
                        <field name="related_student_ids" widget="many2many_tags" invisible="1"></field>
                    </tree>
                    <form>
                      <sheet>
                        <group>
                          <field name="student_name" domain="[('id', 'in', related_student_ids)]"/>
                          <field name="related_student_ids" widget="many2many_tags" invisible="1"></field>
                        </group>
                      </sheet>
                    </form>
                  </field>
                  <field name="related_student_ids" widget="many2many_tags" invisible="1"></field>
                  <field name="unselected_student_ids" widget="many2many_tags" invisible="1"></field>
                  <field name="student_ids" domain="[('id', 'in', unselected_student_ids)]" attrs="{'readonly': [('state', '=', 'validated')]}">
                    <tree create="false">
                      <field name="name"></field>
                    </tree>
                  </field>
              </page>
              <page string="Subject">
                <field name='subject_ids' attrs="{'readonly': [('state', '=', 'validated')]}">
                    <tree editable="bottom" string="Subject">
                        <field name="year"/>
                        <field name="subject_id" domain="[('id', 'in', related_subject_ids)]"/>
                        <field name="subject_type"/>
                        <field name="year_id" string="Academic Year"/>
                        <field name="term_id" string="Term" domain="[('year_id', '=', year_id)]"/>
                        <field name="teacher_id" domain="[('subject_id', '=', subject_id)]"/>
                        <field name="subject_status"/>
                        <field name="related_subject_ids" widget="many2many_tags" invisible="1"/>
                    </tree>
                </field>
              </page>
            </notebook>
          </group>
        </sheet>
      </form>
    </field>
  </record>
  
  <!-- group.class tree view -->
  <record id="group_class_view_tree" model="ir.ui.view">
    <field name="name">Group Class List</field>
    <field name="model">group.class</field>
    <field name="arch" type="xml">
      <tree>
        <field name="name"/>
        <field name="active" invisible="1"/>
        <field name="intake"/>
        <field name="pic"/>
        <field name="students"/>        
      </tree>
    </field>
  </record>

  <!-- group.class action window -->
  <record id="group_class_action" model="ir.actions.act_window">
    <field name="name">Group Class</field>
    <field name="type">ir.actions.act_window</field>
    <field name="res_model">group.class</field>
    <field name="view_mode">tree,form</field>
  </record>

  <!-- This is group class Menu Item -->
  <menuitem id="group_class_menu_act" 
          name="Group Class"
          parent="school.menu_school_standard_form"
          action="group_class_action"
          sequence="11"/>
</odoo>