<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="exam_result_tree_inherit1" model="ir.ui.view">
        <field name="name">exam.result.tree.inherit1</field>
        <field name="model">exam.result</field>
        <field name="inherit_id" ref="exam.view_exam_result_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="replace">
                <tree string="Exam Result" create="0">     
                    <field name="exam_name"/>
                    <field name="student_id"/>
                    <field name="exam_type"/>
                    <field name="teacher_id"/>
                    <field name="intake_id"/>
                    <field name="subject_id"/>
                    <field name="start_time"/>
                    <field name="end_time"/>
                    <field name="exam_date"/>
                    <field name="state" widget="badge" decoration-info="state in ('draft')" decoration-success="state in ('running','finished','done','confirm')" decoration-danger="state in ('cancelled','reject')"/>
                </tree>
            </xpath>
        </field>
    </record>
    <record id="exam_result_view_form_custom2" model="ir.ui.view">
        <field name="name">exam_result.view.form.custom2</field>
        <field name="model">exam.result</field>
        <field name="priority">1</field>
        <field name="arch" type="xml">
            <form string="" create="false">
                <header>
                    <button name="done_exam" string="Done" type="object" class="oe_highlight" help="done assigment" states="active"/>
                    <button name="reassign_exam" string="Reassign" class="oe_highlight" type="object" help="Re-assign assigment" states="reject"/>
                    <button name="reject_exam" string="Reject" help="reject assignment" type="object" states="active"/>
                    <field name="state" widget="statusbar" statusbar_visible="active,done,reject" readonly="1" default="active"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_show_answer" type="object" class="oe_stat_button" icon="fa-pencil-square-o" attrs="{'invisible': [('exam_type', '!=', 'online')]}">
                            <field string="Answers" name="count_answer" widget="statinfo"/>
                        </button>
                    </div>
                    <group string="Exam Details">
                        <group>
                            <field name="student_id"/>
                            <field name="exam_code"/>
                            <field name="exam_name"/>
                            <field name="school_id"/>
                            <field name="program_id"/>
                            <field name="intake_id"/>
                            <field name="group_class" required="1" widget="many2many_tags"/>
                            <field name="academic_year"/>
                            <field name="term_id"/>
                            <field name="grade_system"/>
                            <field name="exam_type"/>
                            <field name="exam_attachment" filename="file_name" attrs="{'invisible': [('exam_type', 'not in', ['softcopy', 'hardcopy'])], 'required': [('exam_type','in', ['softcopy', 'hardcopy'])]}"/>
                            <field name="file_name" invisible="1"/>
                        </group>
                        <group>
                            <field name="subject_id"/>
                            <field name="teacher_id"/>
                            <field name="classroom_id"/>
                            <field name="exam_date"/>
                            <field name="exam_day"/>
                            <field name="start_time" widget="float_time"/>
                            <field name="end_time" widget="float_time"/>
                            <field name="timetable_type"/>
                            <field name="exam_percentage" widget="percentage"/>
                            <field name="question_id" attrs="{'invisible': [('exam_type', '!=', 'online')], 'required': [('exam_type','=', 'online')]}"/>
                            <field name="exam_submission" filename="submission_file_name" attrs="{'invisible': [('exam_type', '!=', 'softcopy')], 'required': [('exam_type','=', 'softcopy')]}"/>
                            <field name="submission_file_name" invisible="1"/>
                            <field name="branch_id" invisible="1"/>
                        </group>
                    </group>
                    <field name="result_ids" nolabel="1" colspan="4">
                        <tree string="Subjects" editable="bottom" create="false" delete="false">
                            <field name="subject_id" placeholder="Select Subject" options="{'no_create': True, 'no_open': True}" readonly="1" required="1"/>
                            <field name="obtain_marks" attrs="{'readonly':[('state','in',['confirm','re-evaluation','re-evaluation_confirm'])]}" string="Score"/>
                            <field name="state" invisible="1"/>
                            <field name="grade" readonly="1" string="Grade"/>
                            <field name="result" readonly="1"/>
                        </tree>
                    </field>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="exam.action_exam_result_form" model="ir.actions.act_window">
        <field name="name">Exam Results</field>
        <field name="res_model">exam.result</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="context">{'search_default_intake': 1, 'search_default_subject':1, 'search_default_name':1}</field>
    </record>

    <record id="view_exam_result_search_inherit" model="ir.ui.view">
        <field name="name">exam.result.search.inherit</field>
        <field name="model">exam.result</field>
        <field name="inherit_id" ref="exam.view_exam_result_search"/>
        <field name="arch" type="xml">
            <xpath expr="//search/group" position="inside">
                <filter name="intake" string="Intake" help="By Name" domain="[]" context="{'group_by':'intake_id'}"/>
                <filter name="subject" string="subject" help="By Name" domain="[]" context="{'group_by':'subject_id'}"/>
                <filter name="name" string="Name" help="By Name" domain="[]" context="{'group_by':'exam_name'}"/>
            </xpath>
        </field>
    </record>

    <record id="exam.action_stu_result_form" model="ir.actions.act_window">
        <field name="domain">[('student_id', '=', active_id)]</field>
        <field name="context">{}</field>
    </record>
</odoo>
