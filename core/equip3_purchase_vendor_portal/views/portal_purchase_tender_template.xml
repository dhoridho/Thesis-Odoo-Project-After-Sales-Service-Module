<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="portal_purchase_tender_template" name="My Tenders">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs_searchbar" t-value="True" />

                <t t-call="portal.portal_searchbar">
                    <t t-set="title">Purchase Tenders</t>
                </t>
                <t t-if="not tenders">
                    <p>There are currently no Tenders for your account.</p>
                </t>
                <div class="vendor_portal_table_scroll">
                    <t t-if="tenders" t-call="portal.portal_table">
                        <t t-foreach="grouped_purchase_tender" t-as="g_purchase_tender">
                            <thead>
                                <tr class="thead-light" t-if="groupby and groupby != 'none'">
                                    <th colspan="8">
                                        <t t-if="groupby == 'status'">
                                            <em class="font-weight-normal text-muted"></em>
                                            <span t-field="g_purchase_tender[0].pt_state"/>
                                        </t>
                                        <t t-if="groupby == 'period_by_day'">
                                            <em class="font-weight-normal text-muted"></em>
                                            <span t-field="g_purchase_tender[0].create_date" t-options='{"widget": "date","format": "d MMMM Y"}'/>
                                        </t>
                                        <t t-if="groupby == 'period_by_month'">
                                            <em class="font-weight-normal text-muted"></em>
                                            <span t-field="g_purchase_tender[0].create_date" t-options='{"widget": "date","format": "MMMM Y"}'/>
                                        </t>
                                        <t t-if="groupby == 'period_by_year'">
                                            <em class="font-weight-normal text-muted"></em>
                                            <span t-field="g_purchase_tender[0].create_date" t-options='{"widget": "date","format": "Y"}'/>
                                        </t>
                                    </th>
                                </tr>
                                <tr class="active">
                                    <th>Tender</th>
                                    <th class="text-right">Tender Type</th>
                                    <th class="text-right">Tender Scope</th>
                                    <th class="text-right">Purchase Representative</th>
                                    <th class="text-right">Create Date</th>
                                    <th class="text-right">Tender Deadline</th>
                                    <th class="text-right">Status</th>
                                    <th>Action</th>
                                    <th style="display:none;"></th>
                                </tr>
                            </thead>
                                <t t-foreach="g_purchase_tender" t-as="tender">
                                <tr>
                                    <td>
                                        <a t-att-href="'/my/tender/'+str(tender.id)">
                                            <t t-esc="tender.name" />
                                        </a>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="tender.sh_agreement_type.name" />
                                    </td>
                                    <td class="text-right">
                                        <span t-field="tender.tender_scope"/>
                                    </td>
                                    <t t-if="tender.sh_purchase_user_id">
                                        <td class="text-right">
                                            <span t-field="tender.sh_purchase_user_id.name" />
                                        </td>
                                    </t>
                                    <t t-if="not tender.sh_purchase_user_id">
                                        <td class="text-right"></td>
                                    </t>
                                    <td class="text-right">
                                        <span t-field="tender.create_date" t-options="{'widget':'date'}"/>
                                    </td>
                                    <t t-if="tender.sh_agreement_deadline">
                                        <td class="text-right">
                                            <span t-field="tender.sh_agreement_deadline" />
                                        </td>
                                    </t>
                                    <t t-if="not tender.sh_agreement_deadline">
                                        <td class="text-right"></td>
                                    </t>
                                    <td class="text-right">
                                        <span t-field="tender.pt_state"/>
                                    </td>

                                    <t t-if="tender.pt_state == 'bid_submission'">
                                        <td>
                                            <button class="btn_add_bid btn btn-secondary">Add/Update
                                Bid</button>
                                        </td>
                                    </t>
                                    <t t-else="">
                                        <td>
                                        </td>
                                    </t>
                                    <td style="display:none;">
                                        <input type="hidden" id="tender_id" name="tender_id" t-att-value="tender.id" t-att-tender_id="tender.id" />
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </t>
                </div>
            </t>
        </template>
    </data>
</odoo>