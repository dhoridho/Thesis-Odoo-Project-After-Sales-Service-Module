<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <template id="tender_dashboard_form_view">
        <t name="Tender Dashboard" t-name="website.vendor_pricelist">
            <t t-call="website.layout">
                <div id="wrap">
                    <div class="oe_structure">
                        <section id='tender_dashboard_form_section'>
                            <div class='container'>
                                <div class='heading mt-4 mb-4'>
                                    <span>Tender Portal Dashboard</span>
                                </div>
                                <div class="first-table mb-4">
                                    <div class="main_div d-flex">
                                        <div class="parent_div_1 ">
                                            <div class="d-flex child_div_1 mt-5">
                                                <div class="d-flex child_child_div_1 tender_dashboard_box_button_top" onclick="location.href='/open_tender?tender_dashboard_selection=active_tender';">
                                                    <div class="child_child_div_1_img">
                                                        <img src="/equip3_purchase_vendor_portal/static/src/img/active_tender.png"/>
                                                    </div>
                                                    <div class="child_child_div_1_title ml-3">
                                                        <div class="title">Active Tender</div>
                                                        <div class="count"><t t-esc="active_tender"/></div>
                                                    </div>
                                                </div>
                                                <div class="d-flex child_child_div_2 tender_dashboard_box_button_top" onclick="location.href='/open_tender?tender_dashboard_selection=doc_submit_tender';">
                                                    <div class="child_child_div_2_title">
                                                        <div class="title">Document Submitted</div>
                                                        <div class="count d-flex pull-right"><span class="big_count"><t t-esc="document_submitted"/></span><span class="small_count">/ <t t-esc="total_tender"/></span></div>
                                                    </div>
                                                    <div class="child_child_div_2_img">
                                                        <img src="/equip3_purchase_vendor_portal/static/src/img/document_submitted.png"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="d-flex child_div_2">
                                                <div class="d-flex child_child_div_1 tender_dashboard_box_button_top" onclick="location.href='/open_tender?tender_dashboard_selection=total_tender';">
                                                    <div class="child_child_div_1_img">
                                                        <img src="/equip3_purchase_vendor_portal/static/src/img/total_tender.png"/>
                                                    </div>
                                                    <div class="child_child_div_1_title">
                                                        <div class="title">Total Tender</div>
                                                        <div class="count"><t t-esc="total_tender"/></div>
                                                    </div>
                                                </div>
                                                <div class="d-flex child_child_div_2 tender_dashboard_box_button_top" onclick="location.href='/open_tender?tender_dashboard_selection=won_tender';">
                                                    <div class="child_child_div_2_title">
                                                        <div class="title">Won Tender</div>
                                                        <div class="count pull-right"><t t-esc="won_tender"/></div>
                                                    </div>
                                                    <div class="child_child_div_2_img">
                                                        <img src="/equip3_purchase_vendor_portal/static/src/img/won_tender.png"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="parent_div_2">
                                            <div class="child_picture">
                                                <img src="/equip3_purchase_vendor_portal/static/src/img/tender_dashboard_business.png"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="second-table mb-4 mt-5">
                                    <div class="title">
                                        <span>Active Tenders ending this week</span>
                                    </div>
                                    <div class="active_tenders">
                                        <table class="table table-striped">
                                            <thead>
                                                <th>Reference</th>
                                                <th>Tender Name</th>
                                                <th>Purchase Representative</th>
                                                <th>Tender Deadline</th>
                                                <th>Total</th>
                                                <th>Tender Scope</th>
                                                <th>Status</th>
                                            </thead>
                                            <tbody>
                                                <t t-foreach="week_tenders" t-as="week_tender_line">
                                                    <tr>
                                                        <td>
                                                            <a t-att-href="'/open_tender/'+str(week_tender_line.id)+'?tender_dashboard_selection=Active Tenders ending this week'"><span t-esc="week_tender_line.name"/></a>
                                                        </td>
                                                        <td>
                                                            <span t-esc="week_tender_line.tender_name"/>
                                                        </td>
                                                        <td>
                                                            <span t-esc="week_tender_line.sh_purchase_user_id.name"/>
                                                        </td>
                                                        <td>
                                                            <span t-esc="week_tender_line.sh_agreement_deadline.strftime('%Y-%m-%d %H:%M')"/>
                                                        </td>
                                                        <td>
                                                            <span t-esc="week_tender_line.amount_total" t-options='{"widget": "monetary", "display_currency": week_tender_line.currency_id}'/>
                                                        </td>
                                                        <td>
                                                            <span t-esc="dict(week_tender_line.fields_get(allfields=['tender_scope'])['tender_scope']['selection'])[week_tender_line.tender_scope]"/>
                                                        </td>
                                                        <td>
                                                            <span style="background-color:#00B012 !important" t-if="week_tender_line.state2 == 'bid_selection'" class="badge badge-secondary"><t t-esc="dict(week_tender_line.fields_get(allfields=['state2'])['state2']['selection'])[week_tender_line.state2]"/></span>
                                                            <span style="background-color: #0500FF !important" t-if="week_tender_line.state2 == 'bid_submission'" class="badge badge-secondary"><t t-esc="dict(week_tender_line.fields_get(allfields=['state2'])['state2']['selection'])[week_tender_line.state2]"/></span>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="third-table mb-4 mt-5">
                                    <div class="title">
                                        <span>Overdue Tender</span>
                                    </div>
                                    <div class="active_tenders">
                                        <table class="table table-striped">
                                            <thead>
                                                <th>Reference</th>
                                                <th>Tender Name</th>
                                                <th>Purchase Representative</th>
                                                <th>Tender Deadline</th>
                                                <th>Total</th>
                                                <th>Tender Scope</th>
                                                <th>Status</th>
                                            </thead>
                                            <tbody>
                                                <t t-foreach="overdue_tenders" t-as="overdue_tender_line">
                                                    <tr>
                                                        <td>
                                                            <a t-att-href="'/open_tender/'+str(overdue_tender_line.id)+'?tender_dashboard_selection=Overdue Tender'"><span t-esc="overdue_tender_line.name"/></a>
                                                        </td>
                                                        <td>
                                                            <span t-esc="overdue_tender_line.tender_name"/>
                                                        </td>
                                                        <td>
                                                            <span t-esc="overdue_tender_line.sh_purchase_user_id.name"/>
                                                        </td>
                                                        <td>
                                                            <span t-esc="overdue_tender_line.sh_agreement_deadline.strftime('%Y-%m-%d %H:%M')"/>
                                                        </td>
                                                        <td>
                                                            <span t-esc="overdue_tender_line.amount_total" t-options='{"widget": "monetary", "display_currency": overdue_tender_line.currency_id}'/>
                                                        </td>
                                                        <td>
                                                            <span t-esc="dict(overdue_tender_line.fields_get(allfields=['tender_scope'])['tender_scope']['selection'])[overdue_tender_line.tender_scope]"/>
                                                        </td>
                                                        <td>
                                                            <span style="background-color: #0500FF !important" class="badge badge-secondary"><t t-esc="dict(overdue_tender_line.fields_get(allfields=['state2'])['state2']['selection'])[overdue_tender_line.state2]"/></span>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </t>
        </t>
    </template>
 
    <template id="user_dropdown" inherit_id="portal.user_dropdown">
        <xpath expr="//li" position="after">
            <t t-if="request.env.user.partner_id.is_customer and request.env.user.has_group('equip3_purchase_vendor_portal.group_vendor_user')">
                <li>
                    <a href="#" class="btn btn-primary mt-1 customer_portal_button">Customer Portal</a>
                </li>
            </t>
            <t t-else="">
                <li>
                    <a href="#" class="btn btn-primary mt-1 vendor_portal_button">Vendor Portal</a>
                </li>
            </t>
            <!-- <li t-if="request.env.user.partner_id.is_customer and request.env.user.has_group('equip3_purchase_vendor_portal.group_vendor_user')">
                <a href="#" class="btn btn-primary mt-1 customer_portal_button">Customer Portal</a>
            </li>
            <li t-if="request.env.user.partner_id.is_vendor and request.env.user.has_group('equip3_purchase_vendor_portal.group_customer_user')">
                <a href="#" class="btn btn-primary mt-1 vendor_portal_button">Vendor Portal</a>
            </li> -->
        </xpath>
    </template>

</odoo>
