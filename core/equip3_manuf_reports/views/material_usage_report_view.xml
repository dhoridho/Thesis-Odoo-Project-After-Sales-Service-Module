<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_material_usage_report_pivot" model="ir.ui.view">
         <field name="name">material.usage.report.pivot</field>
         <field name="model">material.usage.report</field>
         <field name="arch" type="xml">
             <pivot string="Material Usage Report" disable_linking="True">
                 <field name="plan_id" string="Production Plan"/>
                 <field name="workorder_id" string="Production Work Order"/>
                 <field name="consumption_id"/>
                 <field name="company_id"/>
                 <field name="branch_id"/>
                 <field name="create_date" interval="month" type="row"/>
                 <field name="warehouse_id" type="row"/>
                 <field name="create_uid"/>
                 <field name="product_id" type="row"/>
                 <field name="production_id" string="Production Order" type="row"/>
                 <field name="product_uom"/>
                 <field name="to_consume" type="measure"/>
                 <field name="consumed" type="measure"/>
                 <field name="difference" type="measure"/>
                 <field name="value" type="measure"/>
             </pivot>
         </field>
    </record>

    <record id="view_material_usage_report_search" model="ir.ui.view">
            <field name="name">material.usage.report.search</field>
            <field name="model">material.usage.report</field>
            <field name="arch" type="xml">
                <search string="Material Usage Report">
                    <field name="product_id"/>
                    <field name="plan_id" string="Production Plan"/>
                    <field name="production_id" string="Production Order"/>
                    <field name="workorder_id" string="Production Work Order"/>
                    <field name="consumption_id"/>

                    <filter string="Last 30 days" name="last_30_days" domain="[('create_date','&lt;=',context_today().strftime('%Y-%m-%d')), ('create_date','&gt;',(context_today()-relativedelta(days=30)).strftime('%Y-%m-%d'))]"/>
                    <filter string="This Month" name="current_month" domain="[('create_date','&lt;',(context_today()+relativedelta(months=1)).strftime('%%Y-%%m-01')), ('create_date','&gt;=',time.strftime('%%Y-%%m-01'))]"/>
                    <filter string="This Year" name="current_year" domain="[('create_date','&lt;',(context_today()+relativedelta(years=1)).strftime('%%Y-01-01')), ('create_date','&gt;=',time.strftime('%%Y-01-01'))]"/>
                    <filter string="Last Month" name="last_month" domain="[('create_date','&lt;',time.strftime('%%Y-%%m-01')), ('create_date','&gt;=',(context_today()-relativedelta(months=1)).strftime('%%Y-%%m-01'))]"/>
                    <filter string="Last Year" name="last_year" domain="[('create_date','&lt;',time.strftime('%%Y-01-01')), ('create_date','&gt;=',(context_today()-relativedelta(years=1)).strftime('%%Y-01-01'))]"/>
                    <group expand="0" string="Group By...">
                        <filter string="Product" name="product_id" domain="[]" context="{'group_by': 'product_id'}"/>
                        <filter string="Production Plan" name="plan_id" domain="[]" context="{'group_by': 'plan_id'}"/>
                        <filter string="Production Order" name="production_id" domain="[]" context="{'group_by': 'production_id'}"/>
                        <filter string="Production Work Order" name="workorder_id" domain="[]" context="{'group_by': 'workorder_id'}"/>
                        <filter string="Production Record" name="consumption_id" domain="[]" context="{'group_by': 'consumption_id'}"/>
                        <filter string="Warehouse" name="groupby_warehouse_id" domain="[]" context="{'group_by': 'warehouse_id'}"/>
                    </group>
                </search>
            </field>
    </record>
    
    <record id="view_material_usage_report_graph" model="ir.ui.view">
        <field name="name">material.usage.report</field>
        <field name="model">material.usage.report</field>
        <field name="arch" type="xml">
            <graph string="Material Usage Report" sample="1">
                <field name="product_id"/>
                <field name="consumed" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="action_material_usage_report" model="ir.actions.act_window">
        <field name="name">Material Usage Report</field>
        <field name="res_model">material.usage.report</field>
        <field name="view_mode">pivot,graph</field>
        <field name="search_view_id" ref="view_material_usage_report_search"/>
        <field name="context">{'search_default_current_month': 1}</field>
        <field name="view_id"></field>  <!-- force empty -->
        <field name="help">This report performs analysis on your Material Usage data.</field>
    </record>

    <record id="action_production_gantt_chart" model="ir.actions.act_window">
        <field name="name">Production Gantt Chart</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">mrp.production</field>
        <field name="view_mode">ks_gantt</field>
        <field name="context">{'search_default_current_month':1}</field>
        <field name="target">current</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No data yet!
            </p>
            <p>
                Create a new Production order
            </p>
        </field>
    </record>

</odoo>
