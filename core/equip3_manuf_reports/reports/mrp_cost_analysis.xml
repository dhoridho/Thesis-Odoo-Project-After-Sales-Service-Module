<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Form Views -->

        <record id="view_mrp_cost_analysis_xlsx_form" model="ir.ui.view">
             <field name="name">mrp.cost.analysis.xlsx.form</field>
             <field name="model">mrp.cost.analysis.xlsx</field>
             <field name="arch" type="xml">
                <form>
                   <group>
                     <field name="file_xlsx" string="Download" filename="hello" colspan="4"/>
                   </group>
                   <footer>
                      <button special="cancel" string="Cancel" class="oe_highlight" />
                   </footer>
                </form>
             </field>
          </record>

        <!-- Templates-->

        <template id="temp_mrp_cost_analysis">
            <t t-call="web.html_container">
                <t t-call="web.external_layout">
                    <div class="page">
                        <h4 class="text-center">Production Cost Analysis</h4>
                        <table class="table table-condensed">
                            <tr>
                                <th>Production Order</th>
                                <th>Production Date</th>
                                <th>Product</th>
                                <th>Unit of Measure</th>
                                <th class="text-right">Quantity</th>
                                <th class="text-right">Material</th>
                                <th class="text-right">Overhead</th>
                                <th class="text-right">Labor</th>
                                <th class="text-right">By-Product</th>
                                <th class="text-right">Total Cost</th>
                                <th class="text-right">Unit Cost</th>
                            </tr>
                            <tr t-foreach="docs" t-as="o">
                                <td><span t-field="o.name"/></td>
                                <td><span t-field="o.date_planned_start"/></td>
                                <td><span t-field="o.product_id.name"/></td>
                                <td class="text-right"><span t-field="o.product_qty"/></td>
                                <td class="text-right"><span t-field="o.total_material"/></td>
                                <td class="text-right"><span t-field="o.total_overhead"/></td>
                                <td class="text-right"><span t-field="o.total_labor"/></td>
                                <td class="text-right"><span t-field="o.total_byproduct"/></td>
                                <td class="text-right"><span t-field="o.svl_cost"/></td>
                                <td class="text-right"><span t-field="o.svl_unit_cost"/></td>
                            </tr>
                        </table>
                    </div>
                </t>
            </t>
        </template>
        <record id="act_mrp_cost_analysis_report" model="ir.actions.report">
            <field name="name">Production Cost Analysis-PDF</field>
            <field name="model">mrp.production</field>
            <field name="report_type">qweb-html</field>
            <field name="report_name">equip3_manuf_reports.temp_mrp_cost_analysis</field>
            <field name="report_file">equip3_manuf_reports.temp_mrp_cost_analysis</field>
            <field name="print_report_name">Production Cost Analysis</field>
            <field name="binding_model_id" ref="mrp.model_mrp_production"/>
            <field name="binding_type">report</field>
            <field name="multi">True</field>
        </record>

        <!-- <record id="mrp_production_xlsx" model="ir.actions.report">
            <field name="name">Print to XLSX</field>
            <field name="model">res.partner</field>
            <field name="report_type">xlsx</field>
            <field name="report_name">report_xlsx.partner_xlsx</field>
            <field name="report_file">mrp_production</field>
        </record> -->
    </data>
</odoo>