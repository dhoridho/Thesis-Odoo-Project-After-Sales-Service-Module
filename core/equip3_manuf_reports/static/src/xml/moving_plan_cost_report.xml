<?xml version="1.0" encoding="UTF-8"?>
<template xml:space="preserve">

    <t t-name="MovingPlanCostReportStatus">
        <span class="o_status_icon" t-att-title="difference ? formatMonetary(difference) : ''">
            <t t-if="status == 'down'">
                <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                width="18px" height="18px" viewBox="0 0 300.000000 300.000000"
                preserveAspectRatio="xMidYMid meet">

                <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)"
                fill="green" stroke="none">
                <path d="M533 2437 c-81 -81 -83 -85 -83 -131 l0 -48 209 -216 c115 -119 330
                -337 478 -483 286 -285 297 -293 368 -269 25 8 157 135 501 483 256 259 470
                482 475 496 18 45 -1 83 -78 163 -80 81 -115 98 -168 78 -15 -6 -194 -173
                -397 -373 -203 -199 -371 -362 -373 -362 -2 0 -174 168 -384 373 -379 371
                -380 372 -422 372 -40 0 -48 -5 -126 -83z"/>
                <path d="M623 1611 c-25 -7 -69 -45 -130 -113 -38 -42 -43 -53 -43 -97 l0 -49
                471 -476 c509 -514 506 -512 582 -487 27 9 149 126 498 479 278 281 468 480
                476 500 21 50 4 87 -75 164 -73 73 -110 92 -155 82 -22 -5 -132 -107 -406
                -376 l-375 -369 -160 158 c-89 87 -258 253 -376 369 -181 178 -221 213 -250
                217 -19 3 -45 2 -57 -2z"/>
                </g>
                </svg>
            </t>
            <t t-elif="status ==  'up'">
                <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                width="18px" height="18px" viewBox="0 0 300.000000 300.000000"
                preserveAspectRatio="xMidYMid meet">

                <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)"
                fill="red" stroke="none">
                <path d="M1415 2606 c-16 -7 -240 -226 -497 -486 l-468 -472 0 -49 c0 -44 5
                -55 43 -96 69 -77 109 -111 136 -116 63 -13 80 -1 301 217 118 116 287 282
                376 369 l160 158 375 -369 c274 -269 384 -371 406 -376 45 -10 82 9 155 82 79
                77 96 114 75 164 -19 44 -921 956 -964 975 -40 16 -59 16 -98 -1z"/>
                <path d="M1415 1706 c-26 -12 -528 -511 -858 -852 -106 -110 -107 -111 -107
                -159 0 -48 2 -51 83 -132 78 -78 86 -83 126 -83 42 0 43 1 422 373 210 204
                383 371 386 370 2 -1 170 -164 373 -362 202 -198 380 -365 395 -371 53 -20 88
                -3 168 78 77 80 96 118 79 163 -14 37 -931 959 -969 976 -40 16 -60 16 -98 -1z"/>
                </g>
                </svg>
            </t>
        </span>
    </t>

    <t t-name="MovingPlanCostReportFilter">
        <div class="dropleft o_filter_date">
            <t t-set="filter_date" t-value="filters['date']"/>
            <a class="btn btn-primary dropdown-toggle o_filter_date_btn" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" t-att-data-filter-date="filter_date['active'][0]">
                <t t-esc="filter_date['active'][1]"/>
            </a>
            <ul class="dropdown-menu o_filter_date_dropdown" aria-labelledby=".o_filter_date_btn">
                <t t-foreach="filter_date['selection']" t-as="selection">
                    <t t-if="selection[0] != 'custom'">
                        <li><a class="dropdown-item o_filter_date_item" href="#" t-att-data-filter-date="selection[0]">
                            <t t-esc="selection[1]"/>
                        </a></li>
                        <t t-if="[0, 2, 4].includes(selection_index)">
                            <li class="dropdown-divider"></li>
                        </t>
                    </t>
                </t>
                <li class="o_filter_date_custom">
                    <a class="dropdown-item o_filter_date_custom_btn" data-toggle="collapse" href="#" role="button" aria-expanded="false">
                        Custom
                    </a>
                    <div class="collapse o_filter_date_custom_collapse">
                        <div class="o_filter_date_custom_container">
                            <div class="o_custom_date_from"></div>
                            <div class="o_custom_date_to mt-2"></div>
                            <button class="btn btn-sm btn-secondary w-100 mt-2 o_apply_custom_date">Apply</button>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </t>

    <t t-name="MovingPlanCostReportLegend">
        <ul class="o_custom_legend">
            <t t-foreach="labels" t-as="label">
                <li class="o_legend" t-att-data-index="label_index">
                    <span class="o_legend_icon" t-attf-style="color: {{ colors[label_index] }};"><span class="o_icon"></span></span>
                    <span class="o_legend_label"><t t-esc="label"/></span>
                </li>
            </t>
        </ul>
    </t>

    <t t-name="MovingPlanCostReport">
        <div class="o_bom_material_table">
            <table class="o_material_table">
                <thead>
                    <tr>
                        <th></th>
                        <t t-foreach="data.plans" t-as="plan">
                            <th t-att-data-plan_id="plan.id">
                                <div class="o_plan_name">
                                    <a class="o_open_record" href="#" data-title="Production Plan" data-res_model="mrp.plan" t-att-data-res_id="plan.id"><t t-esc="plan.display_name"/></a>
                                </div>
                                <div class="o_plan_quantity">
                                    <span><t t-esc="plan.product_qty"/> <t t-esc="plan.product_uom_id.display_name"/></span>
                                </div>
                                <div class="o_plan_date">
                                    <t t-esc="plan.date"/>
                                </div>
                            </th>
                        </t>
                    </tr>
                </thead>
                <tbody>
                    <tr class="o_bom_uom">
                        <td>
                            <div class="d-flex">
                                <span class="o_product_name">
                                    <t t-esc="data.bom_uom.product"/>
                                </span>
                                <span class="o_quantity ml-auto">
                                    <!-- <t t-esc="data.bom_uom.quantity"/> -->
                                </span>
                            </div>
                        </td>
                        <t t-foreach="data.bom_uom.cost" t-as="bom_uom_cost">
                            <td class="o_cost">
                                <div class="d-flex justify-content-end">
                                    <a class="o_open_record o_open_record_icon" href="#" data-title="Production Order" data-res_model="mrp.production" t-att-data-res_id="bom_uom_cost.order.id" t-att-title="bom_uom_cost.order.display_name">
                                        <i class="o-hm-icon o-hm-menu-icon o-hm-sidebar-parent-manufacturing-reporting"/>
                                    </a>
                                    <span class="ml-3" t-esc="formatMonetary(bom_uom_cost.value)"/>
                                    <t t-call="MovingPlanCostReportStatus">
                                        <t t-set="status" t-value="bom_uom_cost.status"/>
                                    </t>
                                </div>
                            </td>
                        </t>
                    </tr>
                    <tr class="o_secondary_uom" t-if="data.secondary_uom.uom">
                        <td>
                            <div class="d-flex">
                                <span class="o_product_name">
                                    <t t-esc="data.secondary_uom.product"/>
                                </span>
                                <span class="o_quantity ml-auto">
                                    <t t-esc="data.secondary_uom.quantity"/>
                                </span>
                            </div>
                        </td>
                        <t t-foreach="data.secondary_uom.cost" t-as="secondary_cost">
                            <td class="o_cost">
                                <t t-esc="formatMonetary(secondary_cost.value)"/>
                                <t t-call="MovingPlanCostReportStatus">
                                    <t t-set="status" t-value="secondary_cost.status"/>
                                </t>
                            </td>
                        </t>
                    </tr>
                    <tr class="o_primary_uom">
                        <td>
                            <div class="d-flex">
                                <span class="o_product_name">
                                    <t t-esc="data.primary_uom.product"/>
                                </span>
                                <span class="o_quantity ml-auto">
                                    <t t-esc="data.primary_uom.quantity"/>
                                </span>
                            </div>
                        </td>
                        <t t-foreach="data.primary_uom.cost" t-as="primary_cost">
                            <td class="o_cost">
                                <t t-esc="formatMonetary(primary_cost.value)"/>
                                <t t-call="MovingPlanCostReportStatus">
                                    <t t-set="status" t-value="primary_cost.status"/>
                                </t>
                            </td>
                        </t>
                    </tr>
                    <t t-foreach="data.materials" t-as="material">
                        <tr>
                            <td>
                                <div class="d-flex">
                                    <span class="o_product_name">
                                        <t t-esc="material.product_id.display_name"/>
                                    </span>
                                    <span class="o_quantity ml-auto">
                                        <t t-esc="material.product_qty"/> <t t-esc="material.uom_id.display_name"/>
                                    </span>
                                </div>
                            </td>
                            <t t-foreach="material.cost" t-as="cost">
                                <td class="o_cost">
                                    <div class="d-flex justify-content-end">
                                        <t t-if="cost.order.id and cost.quantity &gt; 0.0">
                                            <a class="o_open_record o_open_record_icon" href="#" data-title="Production Order" data-res_model="mrp.production" t-att-data-res_id="cost.order.id" t-att-title="cost.order.display_name">
                                                <i class="o-hm-icon o-hm-menu-icon o-hm-sidebar-parent-manufacturing-reporting"/>
                                            </a>
                                        </t>
                                        <span class="ml-3" t-esc="formatMonetary(cost.value)"/>
                                        <t t-call="MovingPlanCostReportStatus">
                                            <t t-set="status" t-value="cost.status"/>
                                            <t t-set="difference" t-value="cost.difference"/>
                                        </t>
                                    </div>
                                </td>
                            </t>
                        </tr>
                    </t>
                </tbody>
            </table>
        </div>
    </t>

</template>