<odoo>

    <data>

        <record id="equip3_view_hr_leave_allocation_inherit" model="ir.ui.view">
            <field name="name">equip3.hr.leave.allocation.inherit</field>
            <field name="model">hr.leave.allocation</field>
            <field name="inherit_id" ref="hr_holidays.hr_leave_allocation_view_tree_my"/>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='action_approve']" position="replace">
                    <button string="Approve" name="action_approve" type="object"
                            invisible="1"
                            groups="equip3_hr_holidays_extend.make_invisible"
                    />
                </xpath>
                <xpath expr="//button[@name='action_refuse']" position="replace">
                    <button string="Refuse" name="action_refuse" type="object"
                            invisible="1"
                            groups="equip3_hr_holidays_extend.make_invisible"/>
                </xpath>
                <xpath expr="//field[@name='state']" position="attributes">
                    <attribute name="decoration-success">state == 'validate'</attribute>
                    <attribute name="decoration-secondary">state == 'cancel'</attribute>
                    <attribute name="decoration-primary">state == 'draft'</attribute>
                    <attribute name="decoration-warning">state == 'confirm'</attribute>
				    <attribute name="decoration-danger">state == 'refuse'</attribute>
                </xpath>
            </field>
        </record>
        <record id="equip3_view_hr_leave_allocation_form_manager_inherit" model="ir.ui.view">
            <field name="name">equip3.hr.leave.allocation.form.inherit</field>
            <field name="model">hr.leave.allocation</field>
            <field name="inherit_id" ref="hr_holidays.hr_leave_allocation_view_form_manager"/>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='action_approve']" position="replace">
                    <button string="Approve" name="action_approve" type="object" class="oe_highlight"
                            attrs="{'invisible': [('is_hide_approve', '=', True)]}"/>
                </xpath>

                <xpath expr="//button[@name='action_refuse']" position="replace">
                    <button string="Refuse" name="action_refuse" type="object"
                            attrs="{'invisible': [('is_hide_approve', '=', True)]}"/>
                </xpath>

                <xpath expr="//field[@name='employee_id']" position="after">
                    <field name="is_hide_approve" invisible="1"/>
                </xpath>

                <xpath expr="//field[@name='allocation_type']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
            </field>
        </record>
        <record id="equip3_view_hr_leave_allocation_form_inherit" model="ir.ui.view">
            <field name="name">equip3.hr.leave.allocation.form.inherit</field>
            <field name="model">hr.leave.allocation</field>
            <field name="inherit_id" ref="hr_holidays.hr_leave_allocation_view_form"/>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="attrs">{'readonly': [('state','!=','draft')]}</attribute>
                </xpath>
                <xpath expr="//field[@name='holiday_status_id']" position="after">
                    <field name="allocation_type_by" widget="radio" attrs="{'readonly': [('state','!=','draft')]}"/>
                    <field name="overtime_id" attrs="{'invisible': [('allocation_type_by', '!=', 'overtime')], 'required': [('allocation_type_by', '=', 'overtime')], 'readonly': [('state','!=','draft')]}"/>
                    <label for="allocation_date_from" string="Dates" attrs="{'invisible': [('allocation_type_by', '=', 'overtime')]}"/>
                    <div attrs="{'invisible': [('allocation_type_by', '=', 'overtime')]}">
                        <div class="o_row o_row_readonly o_hr_holidays_dates">
                            <span class="oe_inline" attrs="{'invisible': [('allocation_half_day', '=', True)]}">
                                From
                            </span>
                            <field name="allocation_date_from" class="oe_inline" nolabel="1" attrs="{'required': [('allocation_type_by', '=', 'dates')], 'readonly': [('state','!=','draft')]}"/>
                            <span class="oe_inline" attrs="{'invisible': [('allocation_half_day', '=', True)]}">
                                To
                            </span>
                            <field name="allocation_date_to" class="oe_inline" attrs="{'invisible': [('allocation_half_day', '=', True)], 'required': [('allocation_type_by', '=', 'dates'),('allocation_half_day', '=', False)], 'readonly': [('state','!=','draft')]}"/>
                            <field name="allocation_date_from_period" class="oe_inline" string="In" options="{'horizontal': True}" attrs="{'invisible': [('allocation_half_day', '=', False)], 'required': [('allocation_half_day', '=', True)], 'readonly': [('state','!=','draft')]}"/>
                        </div>
                        <div class="o_row o_row_readonly oe_edit_only" style="margin-left: -2px;">
                            <field name="allocation_half_day" attrs="{'readonly': [('state','!=','draft')]}"/>
                            <label for="allocation_half_day"/>
                        </div>
                    </div>
                </xpath>
                <xpath expr="//sheet/group/group[1]/div[3]/field[@name='number_of_days_display']" position="attributes">
                    <attribute name="readonly">1</attribute>
                    <attribute name="force_save">1</attribute>
                </xpath>
                <xpath expr="//sheet/group/group[1]/div[3]" position="after">
                    <field name="effective_date" required="1" attrs="{'readonly': [('state','!=','draft')]}"/>
                    <field name="approvers_ids" widget="many2many_tags" invisible="1"/>
                    <field name="approved_user_ids" widget="many2many_tags" invisible="1"/>
                </xpath>
                <xpath expr="/form/sheet/group/group[@name='alloc_right_col']" position="before">
                    <group>
                        <widget name="hr_leave_allocation_stats"/>
                    </group>
                </xpath>
                <xpath expr="//field[@name='notes']" position="attributes">
                    <attribute name="attrs">{'readonly': [('state','!=','draft')]}</attribute>
                </xpath>
                <xpath expr="//field[@name='notes']" position="before">
                    <notebook invisible="1">
                        <page string="Approver User Line">
                            <field name="approver_user_ids" readonly="1" force_save="1">
                                <tree editable="bottom" create="false" delete="false">
                                    <field name="name"/>
                                    <field name="user_ids" widget="many2many_tags"/>
                                    <field name="matrix_user_ids" widget="many2many_tags" invisible="1" readonly="1" force_save="1"/>
                                    <field name="is_delegation_mail_sent" invisible="1"/>
                                    <field name="approved_user_ids" widget="many2many_tags" invisible="1"/>
                                    <field name="is_approve"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </xpath>
            </field>
        </record>
        <record id="equip3_hr_leave_allocation_view_tree_inherit" model="ir.ui.view">
            <field name="name">equip3.hr.leave.allocation.hr/leave.allocation.view_tree.inherit</field>
            <field name="model">hr.leave.allocation</field>
            <field name="inherit_id" ref="hr_holidays.hr_leave_allocation_view_tree"/>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <field name="holiday_status_id" position="before">
                    <field name="sequence"/>
                </field>
                <xpath expr="//button[@name='action_approve']" position="replace">
                    <button string="Approve" name="action_approve" type="object"
                            invisible="1"
                            groups="equip3_hr_holidays_extend.make_invisible"
                    />
                </xpath>
                <xpath expr="//button[@name='action_refuse']" position="replace">
                    <button string="Refuse" name="action_refuse" type="object"
                            invisible="1"
                            groups="equip3_hr_holidays_extend.make_invisible"/>
                </xpath>
                <xpath expr="//button[@name='action_validate']" position="replace">
                    <button string="Refuse" name="action_validate" type="object"
                            invisible="1"
                            groups="equip3_hr_holidays_extend.make_invisible"/>
                </xpath>
                <xpath expr="//field[@name='state']" position="attributes">
                    <attribute name="decoration-success">state == 'validate'</attribute>
                    <attribute name="decoration-secondary">state == 'cancel'</attribute>
                    <attribute name="decoration-primary">state == 'draft'</attribute>
                    <attribute name="decoration-warning">state == 'confirm'</attribute>
				    <attribute name="decoration-danger">state == 'refuse'</attribute>
                    <attribute name="decoration-info"></attribute>
                </xpath>
            </field>
        </record>

        <record id="equip3_hr_leave_allocation_view_kanban_inherit" model="ir.ui.view">
            <field name="name">equip3.hr.leave.allocation.hr/leave.allocation.view_kanban.inherit</field>
            <field name="model">hr.leave.allocation</field>
            <field name="inherit_id" ref="hr_holidays.hr_leave_allocation_view_kanban"/>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='action_approve']" position="replace">
                    <button string="Approve" name="action_approve" type="object"
                            invisible="1"
                            groups="equip3_hr_holidays_extend.make_invisible"
                    />
                </xpath>
                <xpath expr="//button[@name='action_refuse']" position="replace">
                    <button string="Refuse" name="action_refuse" type="object"
                            invisible="1"
                            groups="equip3_hr_holidays_extend.make_invisible"/>
                </xpath>
                <xpath expr="//button[@name='action_validate']" position="replace">
                    <button string="Refuse" name="action_validate" type="object"
                            invisible="1"
                            groups="equip3_hr_holidays_extend.make_invisible"/>
                </xpath>
            </field>
        </record>

        <record id="hr_leave_allocation_view_tree_manager" model="ir.ui.view">
            <field name="name">hr.leave.allocation.view.tree.manager</field>
            <field name="model">hr.leave.allocation</field>
            <field name="priority">16</field>
            <field name="arch" type="xml">
                <tree string="Allocation Requests" sample="1">
                    <field name="employee_id"/>
                    <field name="department_id" optional="hide"/>
                    <field name="holiday_status_id" class="font-weight-bold"/>
                    <field name="name"/>
                    <field name="duration_display" string="Duration"/>
                    <field name="message_needaction" invisible="1"/>
                    <field name="state" widget="badge" decoration-info="state == 'draft'"
                           decoration-warning="state in ('confirm','validate1')"
                           decoration-success="state == 'validate'"/>
                    <field name="activity_exception_decoration" widget="activity_exception"/>
                </tree>
            </field>
        </record>
        <record id="hr_leave_allocation_view_form_manager" model="ir.ui.view">
            <field name="name">hr.leave.allocation.view.form.manager</field>
            <field name="model">hr.leave.allocation</field>
            <field name="priority">16</field>
            <field name="arch" type="xml">
                <form string="Allocation Requests">
                    <field name="can_reset" invisible="1"/>
                    <field name="can_approve" invisible="1"/>
                    <field name="holiday_type" invisible="1"/>
                    <header>
                        <button string="Confirm" name="action_confirm" states="draft" type="object"
                                class="oe_highlight"/>
                        <button string="Approve" name="action_approve" type="object" class="oe_highlight"
                                attrs="{'invisible': ['|',('is_hide_approve', '=', True),('state', '!=', 'confirm')]}"/>
                        <button string="Approve" name="action_validate"
                                attrs="{'invisible': ['|',('is_hide_approve', '=', True),('state', '!=', 'validate1')]}"
                                type="object" class="oe_highlight"/>
                        <button string="Refuse" name="wizard_reject" type="object"
                                attrs="{'invisible': ['|',('is_hide_approve', '=', True),('state', 'not in', ['confirm', 'validate1'])]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirm,validate"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button
                                    class="oe_stat_button"
                                    icon="fa-calendar"
                                    type="action"
                                    attrs="{'invisible': [('holiday_type', '!=', 'employee')]}"
                                    name="%(hr_holidays.hr_leave_action_action_approve_department)d"
                                    context="{'search_default_employee_id': [employee_id], 'search_default_holiday_status_id': [holiday_status_id], 'default_holiday_status_id': holiday_status_id}"
                                    help="Time off Taken/Total Allocated">
                                <div class="o_stat_info">
                                    <span class="o_stat_value">
                                        <field name="leaves_taken" digits="[42,1]"/>/
                                        <field name="max_leaves" digits="[42,1]"/>
                                    </span>
                                    <span class="o_stat_text">
                                        Time Off
                                    </span>
                                </div>
                            </button>
                        </div>
                        <div class="oe_title">
                            <h2>
                                <field name="name" placeholder="e.g. Public Holiday Allocation"
                                       attrs="{'readonly': [('state', '!=', 'draft')]}" required="1"/>
                            </h2>
                        </div>
                        <group>
                            <group>
                                <field name="type_request_unit" invisible="1"/>
                                <field name="employee_id" invisible="0" attrs="{'readonly': [('state','!=','draft')]}" groups="hr_holidays.group_hr_holidays_user"/>
                                <field name="department_id" invisible="0" readonly="1" force_save="1"/>
                                <field name="holiday_status_id" context="{'employee_id':employee_id}" attrs="{'readonly': [('state','!=','draft')]}"/>
                                <field name="feedback_parent" invisible="1"/>

                                <field name="allocation_type" invisible="1" widget="radio"/>
                                <field name="is_hide_approve" invisible="1"/>
                                <field name="allocation_type_by" widget="radio" attrs="{'readonly': [('state','!=','draft')]}"/>
                                <field name="overtime_id" attrs="{'invisible': [('allocation_type_by', '!=', 'overtime')], 'required': [('allocation_type_by', '=', 'overtime')], 'readonly': [('state','!=','draft')]}"/>
                                <label for="allocation_date_from" string="Dates" attrs="{'invisible': [('allocation_type_by', '=', 'overtime')]}"/>
                                <div attrs="{'invisible': [('allocation_type_by', '=', 'overtime')]}">
                                    <div class="o_row o_row_readonly o_hr_holidays_dates">
                                        <span class="oe_inline" attrs="{'invisible': [('allocation_half_day', '=', True)]}">
                                        From
                                    </span>
                                    <field name="allocation_date_from" class="oe_inline" nolabel="1" attrs="{'required': [('allocation_type_by', '=', 'dates')], 'readonly': [('state','!=','draft')]}"/>
                                    <span class="oe_inline" attrs="{'invisible': [('allocation_half_day', '=', True)]}">
                                        To
                                    </span>
                                    <field name="allocation_date_to" class="oe_inline" attrs="{'invisible': [('allocation_half_day', '=', True)], 'required': [('allocation_type_by', '=', 'dates'),('allocation_half_day', '=', False)], 'readonly': [('state','!=','draft')]}"/>
                                    <field name="allocation_date_from_period" class="oe_inline" string="In" options="{'horizontal': True}" attrs="{'invisible': [('allocation_half_day', '=', False)], 'required': [('allocation_half_day', '=', True)], 'readonly': [('state','!=','draft')]}"/>
                                    </div>
                                    <div class="o_row o_row_readonly oe_edit_only" style="margin-left: -2px;">
                                        <field name="allocation_half_day" attrs="{'readonly': [('state','!=','draft')]}"/>
                                        <label for="allocation_half_day"/>
                                    </div>
                                </div>
                                <field name="number_of_days_display" invisible="1"/>
                                <field name="number_of_days" invisible="1"/>
                                <div class="o_td_label">
                                    <label for="number_of_days" string="Duration"
                                           attrs="{'invisible': [('allocation_type', '=', 'accrual')]}"/>
                                    <label for="number_of_days" string="Extra days"
                                           attrs="{'invisible': [('allocation_type', '!=', 'accrual')]}"/>
                                </div>
                                <div>
                                    <!-- <field name="number_of_days_display" class="oe_inline" nolabel="1"
                                           attrs="{'readonly': ['|', ('type_request_unit', '=', 'hour'), ('state', 'not in', ('draft', 'confirm'))], 'invisible': [('type_request_unit', '=', 'hour')]}"/> -->
                                    <field name="number_of_days_display" readonly="1" force_save="1"/>
                                    <field name="number_of_hours_display" class="oe_inline" nolabel="1"
                                           attrs="{'readonly': ['|', ('type_request_unit', '!=', 'hour'), ('state', 'not in', ('draft', 'confirm'))], 'invisible': [('type_request_unit', '!=', 'hour')]}"/>
                                    <span class="ml8" attrs="{'invisible': [('type_request_unit', '=', 'hour')]}">Days
                                    </span>
                                    <span class="ml8" attrs="{'invisible': [('type_request_unit', '!=', 'hour')]}">
                                        Hours
                                    </span>
                                </div>
                                <field name="effective_date" required="1" attrs="{'readonly': [('state','!=','draft')]}"/>
                                <field name="approvers_ids" widget="many2many_tags" invisible="1"/>
                                <field name="approved_user_ids" widget="many2many_tags" invisible="1"/>
                            </group>
                            <group>
                                <widget name="hr_leave_allocation_stats"/>
                            </group>
                        </group>
                        <field name="notes" nolabel="1" placeholder="Add a reason..." attrs="{'readonly': [('state','!=','draft')]}"/>
                        <notebook>
                            <page string="Approver Matrix Line">
                                <field name="approver_user_ids" readonly="1" force_save="1">
                                    <tree editable="bottom" create="false" delete="false">
                                        <field name="name"/>
                                        <field name="user_ids" widget="many2many_tags"/>
                                        <field name="matrix_user_ids" widget="many2many_tags" invisible="1" readonly="1" force_save="1"/>
                                        <field name="is_delegation_mail_sent" invisible="1"/>
                                        <field name="minimum_approver"/>
                                        <field name="approved_user_ids" widget="many2many_tags" invisible="1"/>
                                        <field name="approved_time"/>
                                        <field name="approver_state" invisible="1"/>
                                        <field name="approval_status"/>
                                        <field name="feedback" readonly="1" force_save="1"/>
                                        <field name="is_approve" invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>
        <!-- <record id="hr_holidays.hr_leave_allocation_action_approve_department" model="ir.actions.act_window">
            <field name="name">Allocation Requests</field>
            <field name="res_model">hr.leave.allocation</field>
            <field name="view_mode">tree,form,kanban,activity</field>
            <field name="context">{'search_default_pending_my_approval': 1}</field>
            <field name="domain">[]</field>
            <field name="view_ids"
                   eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('equip3_hr_holidays_extend.hr_leave_allocation_view_tree_manager')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('equip3_hr_holidays_extend.hr_leave_allocation_view_form_manager')})]"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create a new leave allocation
                </p>
                <p>
                    Time Off Officers allocate time off days to employees (e.g. paid time off).
                    <br/>
                    Employees request allocations to Time Off Officers (e.g. recuperation days).
                </p>
            </field>
        </record>
    </data> -->
        <record id="hr_holidays.hr_leave_allocation_action_approve_department" model="ir.actions.server">
            <field name="name">Allocation Requests</field>
            <field name="type">ir.actions.server</field>
            <field name="state">code</field>
            <field name="model_id" ref="equip3_hr_holidays_extend.model_hr_leave_allocation"/>
            <field name="code">action = model.custom_menu()</field>
                
        </record>
    </data>

    <record id="view_hr_leave_allocation_filter_inherit" model="ir.ui.view">
            <field name="name">hr.holidays.filter_allocations.inherit</field>
            <field name="model">hr.leave.allocation</field>
            <field name="inherit_id" ref="hr_holidays.view_hr_leave_allocation_filter"/>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='managed_people']" position="after">
                    <filter string="Pending My Approval" name="pending_my_approval" domain="[('approvers_ids', 'in', uid),('approved_user_ids','not in',uid),('state','=','confirm')]"/>
                </xpath>
            </field>
        </record>

</odoo>