<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data noupdate="0">

        <record id="invoice_recurring_form_inherit" model="ir.ui.view">
            <field name="name">invoice_recurring_form</field>
            <field name="model">invoice.recurring</field>
            <field name="inherit_id" ref="sh_invoice_recurring.sh_invoice_recurring_form_view"/>
            <field name="arch" type="xml">
                <!-- INVOICE ORDER RECURRING FORM VIEW -->
                <!-- <xpath expr="//div[@name='wage'][2]" position="after">
                    <label for="remaining_journal_entry" />
                    <div class="o_row" name="wage">
                        <field name="remaining_journal_entry" nolabel="1" />
                    </div>
                </xpath> -->

                <xpath expr="//header/field[@name='state']" position="attributes">
                    <!-- <attribute name="clickable">0</attribute> -->
                    <!-- <attribute name="readonly">1</attribute> -->
                    <!-- <attribute name="attrs">{'invisible': [('state', '=', 'draft')]}</attribute>
                    <attribute name="statusbar_visible">pending,done,cancel</attribute> -->
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//header/field[@name='state']" position="after">
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm,done,cancel"/>
                </xpath>

                <xpath expr="//sheet/div[2]/h1" position="before">
                    <field name="prepayment_journal" invisible='1'/>
                    <span class="o_form_label" name='rec_out' attrs="{'invisible':[('type','!=','out_invoice')]}">
                        Recurring Invoices
                    </span>
                    <span class="o_form_label" name='rec_in' attrs="{'invisible':[('type','!=','in_invoice')]}">
                        Recurring Bill
                    </span>
                    <span class="o_form_label" name='rec_entry'
                          attrs="{'invisible':['|',('type','!=','entry'), ('prepayment_journal','in',('customer','vendor'))]}">
                        Recurring Journal Entries
                    </span>
                    <span class="o_form_label" name='rec_entry_cust'
                          attrs="{'invisible':[('prepayment_journal','!=','customer')]}">Customer Prepayment Details
                    </span>
                    <span class="o_form_label" name='rec_entry_vend'
                          attrs="{'invisible':[('prepayment_journal','!=','vendor')]}">Vendor Prepayment Details
                    </span>

                </xpath>

                <xpath expr="//header/button[@name='create_order_manually']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//header/button[@name='create_order_manually']" position="after">
                    <!-- <button name="confirm" string="Confirm" type="object" class="oe_highlight" attrs="{'invisible': [('state', '!=', 'draft')]}" /> -->
                    <!-- <button name="pending" string="To Renew" type="object" class="oe_highlight" attrs="{'invisible': [('state', '!=', 'confirm')]}" />
                    <button name="done" string="Expired" type="object" class="oe_highlight" attrs="{'invisible': [('state', '!=', 'pending')]}" /> -->
                    <button name="cancel" string="Cancelled" type="object" class="oe_highlight"
                            attrs="{'invisible': [('state', '!=', 'confirm')]}"/>
                </xpath>

                <xpath expr="//sheet/group/group[1]/field[@name='start_date']" position="after">
                    <label for="end_date"
                           attrs="{'invisible': [('type', 'not in', ('out_invoice','in_invoice','entry'))]}"/>
                    <div class="o_row"
                         attrs="{'invisible': [('type', 'not in', ('out_invoice','in_invoice','entry'))]}">
                        <field name="end_date" nolabel="1" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <span class="text-muted">(If fixed-term contract)</span>
                    </div>
                    <label for="remaining_journal_entry" />
                    <div class="o_row" name="wage">
                        <field name="remaining_journal_entry" nolabel="1" />
                    </div>
                    <!-- <field name="created_by" readonly='1'
                           attrs="{'invisible': [('type', 'not in', ('out_invoice','in_invoice','entry'))]}"/>
                    <field name="created_date" readonly='1'
                           attrs="{'invisible': [('type', 'not in', ('out_invoice','in_invoice','entry'))]}"/> -->
                </xpath>

                <xpath expr="//sheet/group/group[1]/field[@name='partner_id']" position="attributes">
                    <attribute name="attrs">{'required':[('type','in',('in_invoice','out_invoice'))] ,'readonly':
                        [('state','!=','draft')], 'invisible': [('type','in',('in_invoice','entry'))]}
                    </attribute>
                </xpath>

                <xpath expr="//sheet/group/group[1]/field[@name='partner_id']" position="after">
                    <field name="partner_id" string='Vendor'
                           attrs="{'required':[('type','in',('in_invoice','out_invoice'))] ,'readonly': [('state','!=','draft')], 'invisible': [('type','!=','in_invoice')]}"/>
                    <!-- <field name="state" /> -->
                </xpath>

                <xpath expr="//sheet/group/group[1]/field[@name='title']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//sheet/group/group[1]/field[@name='type']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//sheet/group/group[2]/label[3]" position="attributes">
                    <attribute name="attrs">{'invisible': [('type', 'in', ('out_invoice','in_invoice','entry'))]}
                    </attribute>
                </xpath>

                <xpath expr="//sheet/group/group[2]/div[3]" position="attributes">
                    <attribute name="attrs">{'invisible': [('type', 'in', ('out_invoice','in_invoice','entry'))]}
                    </attribute>
                </xpath>

                <xpath expr="//sheet/group/group[2]/div[3]" position="after">
                    <label for="remaining_journal_entry" />
                    <div class="o_row" name="wage">
                        <field name="remaining_journal_entry" nolabel="1" />
                    </div>
                    <field name="company_id" readonly='1'
                           attrs="{'invisible': [('type', 'not in', ('out_invoice','in_invoice','entry'))]}"/>
                    <field name="branch_id"
                           attrs="{'invisible': [('type', 'not in', ('out_invoice','in_invoice','entry'))], 'readonly': [('state','!=','draft')]}" required="1" options="{'no_create': True, 'no_create_edit': True}"/>
                    
                    <field name="analytic_group_ids" widget="many2many_tags"/>
                </xpath>

                <xpath expr="//field[@name='sh_move_line']/tree/field[@name='name']"
                       position="after">
                    <field name="analytic_group_ids" widget="many2many_tags" required="1"/>
                </xpath>

                <xpath expr="//field[@name='order_line']/tree/field[@name='account_id']"
                       position="after">
                    <field name="analytic_group_ids" widget="many2many_tags" required="1"/>
                </xpath>

                <xpath expr="//field[@name='journal_id']" position="before">
                    <field name="reference"/>
                </xpath>

            </field>
        </record>

        <!-- invoice recurring tree view -->
        <record id="eq3_recurring_bill_tree" model="ir.ui.view">
            <field name="name">Recurring Bill</field>
            <field name="model">invoice.recurring</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name" string="Bill Recurring Reference"/>
                    <field name="partner_id" string='Vendor'/>
                    <field name="start_date"/>
                    <field name="end_date"/>
                    <field name="sh_invoice_recurring_count" string="#OF BILL"/>
                    <field name="state" optional="show" widget="badge" decoration-success="state == 'done'"
                    decoration-primary="state =='confirm'" decoration-warning="state == 'pending'" 
                    decoration-muted="state == 'draft'" decoration-danger3="state == 'cancel'"/>
                </tree>
            </field>
        </record>

        <!-- model.name action window -->
        <record id="customer_prepayment_journal_action" model="ir.actions.act_window">
            <field name="name">Customer Prepayment Detail</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">invoice.recurring</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'default_partner_id':1, 'default_prepayment_journal':'customer'}</field>
            <field name="domain">[('type','=','entry'), ('prepayment_journal','=','customer')]</field>
            <field name="view_ids"
                   eval="[(5,0,0),
                    (0,0, {'sequence':1, 'view_mode':'tree', 'view_id':ref('sh_invoice_recurring.sh_invoice_recurring_tree_view')}),
                    (0,0, {'sequence':2, 'view_mode':'form', 'view_id':ref('equip3_accounting_recurring.invoice_recurring_form_inherit')})]
                    "/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>

        <!-- model.name action window -->
        <record id="vendor_prepayment_journal_action" model="ir.actions.act_window">
            <field name="name">Vendor Prepayment Detail</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">invoice.recurring</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'default_partner_id':1, 'default_prepayment_journal':'vendor'}</field>
            <field name="domain">[('type','=','entry'), ('prepayment_journal','=','vendor')]</field>
            <field name="view_ids"
                   eval="[(5,0,0),
                    (0,0, {'sequence':1, 'view_mode':'tree', 'view_id':ref('equip3_accounting_recurring.eq3_recurring_bill_tree')}),
                    (0,0, {'sequence':2, 'view_mode':'form', 'view_id':ref('equip3_accounting_recurring.invoice_recurring_form_inherit')})]
                    "/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>

        <!-- invoice.recurring action window -->
        <record id="invoice_recurring2_action" model="ir.actions.act_window">
            <field name="name">Recurring Invoices</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">invoice.recurring</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'default_type':'out_invoice'}</field>
            <field name="domain">[('type','=','out_invoice')]</field>
            <field name="view_ids"
                   eval="[(5,0,0),
                    (0,0, {'sequence':1, 'view_mode':'tree', 'view_id':ref('sh_invoice_recurring.sh_invoice_recurring_tree_view')}),
                    (0,0, {'sequence':2, 'view_mode':'form', 'view_id':ref('equip3_accounting_recurring.invoice_recurring_form_inherit')})]
                    "/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>

        <!-- invoice.recurring action window -->
        <record id="recurring_bill_action" model="ir.actions.act_window">
            <field name="name">Recurring Bill</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">invoice.recurring</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'default_type':'in_invoice'}</field>
            <field name="domain">[('type','=','in_invoice')]</field>
            <field name="view_ids"
                   eval="[(5,0,0),
                    (0,0, {'sequence':1, 'view_mode':'tree', 'view_id':ref('equip3_accounting_recurring.eq3_recurring_bill_tree')}),
                    (0,0, {'sequence':2, 'view_mode':'form', 'view_id':ref('equip3_accounting_recurring.invoice_recurring_form_inherit')})]
                    "/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>

        <!-- invoice.recurring action window -->
        <record id="recurring_journal_action" model="ir.actions.act_window">
            <field name="name">Recurring Journal Entries</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">invoice.recurring</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'default_type':'entry', 'default_partner_id':1}</field>
            <field name="domain">[('type','=','entry'), ('prepayment_journal','=',False)]</field>
            <field name="view_ids"
                   eval="[(5,0,0),
                    (0,0, {'sequence':1, 'view_mode':'tree', 'view_id':ref('sh_invoice_recurring.sh_invoice_recurring_tree_view')}),
                    (0,0, {'sequence':2, 'view_mode':'form', 'view_id':ref('equip3_accounting_recurring.invoice_recurring_form_inherit')})]
                    "/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>

        <!-- This Menu Item must have a parent and an action -->
        <!-- <menuitem id="recurring_invoice_menu_act" name="Recurring Invoice" parent="menu_efaktur" action="invoice_rec_invoice2_action" sequence="99"/> -->
        <!-- <menuitem action="invoice_recurring2_action" id="recurring_invoice_menu_act" groups="account.group_account_manager" name="Recurring Invoice" sequence="99" parent="equip3_accounting_efaktur.menu_efaktur"/> -->
        <menuitem action="invoice_recurring2_action" id="recurring_invoice_menu_act"
                  groups="account.group_account_invoice" name="Recurring Invoices" sequence="2"
                  parent="account.menu_finance_receivables"/>
        <menuitem action="recurring_bill_action" id="recurring_bill_menu_act" groups="account.group_account_invoice"
                  name="Recurring Bill" sequence="2" parent="account.menu_finance_payables"/>
        <menuitem action="recurring_journal_action" id="recurring_journal_menu_act"
                  groups="account.group_account_invoice" name="Recurring Journal Entries" sequence="15"
                  parent="account.menu_finance_entries_accounting_miscellaneous"/>
        <menuitem action="customer_prepayment_journal_action" id="customer_prepayment_journal_action_menu_act"
                  groups="account.group_account_invoice" name="Customer Prepayment Detail" sequence="16"
                  parent="account.menu_finance_entries_accounting_miscellaneous"/>
        <menuitem action="vendor_prepayment_journal_action" id="vendor_prepayment_action_menu_act"
                  groups="account.group_account_invoice" name="Vendor Prepayment Detail" sequence="17"
                  parent="account.menu_finance_entries_accounting_miscellaneous"/>

    </data>
</odoo>
