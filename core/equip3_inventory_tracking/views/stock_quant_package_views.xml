<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="inherit_view_stock_quant_package_form" model="ir.ui.view">
        <field name="name">stock.quant.package.inherit.form</field>
        <field name="model">stock.quant.package</field>
        <field name="inherit_id" ref="delivery.view_quant_package_weight_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='packaging_id']" position="attributes">
                <attribute name="domain"></attribute>
            </xpath> 
            <xpath expr="//field[@name='shipping_weight']/.." position="replace">
                <div class="o_row" name="Shipping Weight">
                    <field name="shipping_weight"/>
                    <span><field name="weight_uom_name"/></span>
                </div>
            </xpath>

        </field>
    </record>

    <record id="inherit_view_product_packaging_form" model="ir.ui.view">
        <field name="name">stock.quant.package.inherit.form</field>
        <field name="model">stock.quant.package</field>
        <field name="inherit_id" ref="stock.view_quant_package_form"/>
        <field name="arch" type="xml">
            <xpath expr="//form" position="attributes">    
                <attribute name="duplicate">0</attribute>
            </xpath>

            <xpath expr="//field[@name='location_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//field[@name='packaging_id']" position="after">
                <field name="warehouse_id"/>
                <field name="location_id_new" domain="[('id', 'in', filter_location_id_new)]"/>
                <field name="package_expiration_date_time"/>
                <field name="create_automatic"  invisible="1"/>
                <field name="filter_location_id_new" invisible="1"/>
            </xpath>


            <field name="location_id" position="after">
                <field name="package_measure_selection" invisible="1"/>
                <field name='weight' invisible="1"/>
                <label for="weight" attrs = "{'invisible' : [('package_measure_selection', '!=', 'weight')]}"/>
                    <div class="d-flex">
                        <field class="mr-2" name="package_weight" attrs = "{'invisible' : [('package_measure_selection', '!=', 'weight')]}"/>
                        <span class="mr-2" attrs = "{'invisible' : [('package_measure_selection', '!=', 'weight')]}">kg</span>    
                    </div>
                <label for="max_weight" attrs = "{'invisible' : [('package_measure_selection', '!=', 'weight')]}"/>
                    <div class="d-flex">
                        <field class="mr-2" name="max_weight" attrs = "{'invisible' : [('package_measure_selection', '!=', 'weight')]}"/>
                        <span class="mr-2" attrs = "{'invisible' : [('package_measure_selection', '!=', 'weight')]}">kg</span>    
                    </div>
                <field name="package_status" invisible="1"/>
            </field>

            <xpath expr="//div[@name='Shipping Weight']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//label[@for='shipping_weight']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//field[@name='company_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//field[@name='owner_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//field[@name='lot_id']" position="attributes">
                <attribute name="optional">hide</attribute>
            </xpath>

            <xpath expr="//field[@name='quantity']" position="attributes">
                <attribute name="readonly">False</attribute>
            </xpath>

            <xpath expr="//field[@name='product_id']" position="before">
                <field name="stock_quant_sequence" readonly="1"/>
            </xpath>

            <xpath expr="//field[@name='quant_ids']" position="attributes">
                <attribute name="context">{'quant_ids': quant_ids}</attribute>
                <attribute name="attrs">{'readonly': [('create_automatic', '=', True)]}</attribute>
            </xpath>

            <xpath expr="//field[@name='quant_ids']//tree" position="attributes">
                <attribute name="editable">bottom</attribute>
                <attribute name="create">1</attribute>
                <attribute name="delete">1</attribute>
            </xpath>

            <xpath expr="//field[@name='quant_ids']/tree/field[@name='product_id']" position="attributes">
                <attribute name="domain">[('id','in',filter_available_product_ids)]</attribute> 
            </xpath>

            <xpath expr="//field[@name='product_id']" position="after">
                <field name="analytic_account_group_ids" widget="many2many_tags"/>
                <field name="product_description"/>
                <field name="create_automatic" invisible="1"/>
                <field name="total_stock_in_package" invisible="1"/>
                <field name="initial_demand" invisible="1"/>
                <field name="available_quantity" invisible="1"/>
                <field name="quantity" position="move"/>
                <field name="quantity_done"  invisible="1"/>
                <field name="fulfillment" invisible="1"/>
                <field name="location_id" force_save="1" invisible="1"/>
                <field name="filter_available_product_ids" widget="many2many_tags" invisible="1"/>
            </xpath>

            <xpath expr="//group[@id='stock.package_location_group']" position="after">
                <group>
                    <field name="company_id" position="move" readonly="1"/>
                    <field name="owner_id_stock" position="move"  readonly="1"/>

                    <label for="shipping_weight"/>
                    <div class="d-flex">
                        <field class="mr-2" name="shipping_weight" readonly="1"/>
                        <span class="mr-2">kg</span>    
                    </div>
                    
                    <label for="shipping_volume"/>
                    <div class="d-flex">
                        <field class="mr-2" name="shipping_volume" readonly="1"/>
                        <span class="mr-2">cm3</span>    
                    </div>
                    <field name="barcode_packaging" force_save="1" readonly="1"/>
                </group>
            </xpath>

            <xpath expr="//header/button[@name='unpack']" position="attributes">
                <attribute name="attrs">{'invisible':[('package_status','=', 'empty')]}</attribute>
            </xpath>
        </field>
    </record>

    <record id="view_quant_package_kanban_inherited" model="ir.ui.view">
        <field name="name">stock.quant.package.kanban</field>
        <field name="model">stock.quant.package</field>
        <field name="inherit_id" ref="stock.view_quant_package_kanban" />
        <field name="arch" type="xml">

            <xpath expr="//templates" position="inside">
                                <field name="color"/>
            </xpath>
            <xpath expr="//div[hasclass('o_kanban_record_top')]" position="replace">
                        <div  t-attf-class="oe_kanban_color_{{kanban_getcolor(record.color.raw_value)}}"
                              style="text-align:right; margin-left: 110px">
                                <field name="package_status"/>
                            </div>
                         <div class="o_kanban_record_top mb0" style="text-align:top; margin-top: -20px">
                                <strong class="o_kanban_record_title"><field name="name"/></strong>                                
                            </div>
            </xpath>
            <xpath expr="//div[hasclass('oe_kanban_global_click')]" position="inside">
                <div class="o_kanban_record_top">
                                <field name="packaging_id"/>
                            </div>
                <div class="o_kanban_record_top">
                                <field name="location_id"/>
                            </div>
                <div  t-attf-class="oe_kanban_color_{{kanban_getcolor(record.color.raw_value)}}"
                              style="text-align:right; margin-left: 110px;">
                                <field name="qty"/>
                                <field name="uom_id"/>
                            </div>
            </xpath>
        </field>
    </record>


    <record id="view_quant_package_form_inherit" model="ir.ui.view">
        <field name="name">stock.quant.package.search</field>
        <field name="model">stock.quant.package</field>
        <field name="inherit_id" ref="stock.quant_package_search_view"/>
        <field name="arch" type="xml">
            <xpath expr="//search" position="inside">
                <filter string='Product Packaging' name="product_packaging" domain="[('location_id', '!=', False), ('location_id.usage', '=', 'internal')]"/>
                <filter string='Product Packed' name="package_packed" domain="[('package_status', '=', 'packed')]"/>
                <filter string='Product Partial' name="package_partial" domain="[('package_status', '=', 'partial')]"/>
                <filter string='Product Empty' name="package_empty" domain="[('package_status', '=', 'empty')]"/>
            </xpath>
        </field>
    </record>

    <record id="view_quant_package_tree_inherit" model="ir.ui.view">
        <field name="name">stock.quant.package.inherit.view</field>
        <field name="model">stock.quant.package</field>
        <field name="inherit_id" ref="stock.view_quant_package_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree/field[@name='location_id']" position="after">
                <field name="package_expiration_date_time" />
            </xpath>
            <xpath expr="//tree/field[@name='company_id']" position="after">
                <field name="package_status" />
            </xpath>
        </field>
    </record>

    <record id="stock.action_package_view" model="ir.actions.act_window">
        <field name="context">{'search_default_product_packaging': 1}</field>
    </record>

</odoo>
