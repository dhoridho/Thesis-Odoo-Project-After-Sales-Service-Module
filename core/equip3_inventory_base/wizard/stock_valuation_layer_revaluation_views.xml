<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="stock_valuation_layer_revaluation_form_view" model="ir.ui.view">
        <field name="name">stock.valuation.layer.revaluation.form</field>
        <field name="model">stock.valuation.layer.revaluation</field>
        <field name="inherit_id" ref="stock_account.stock_valuation_layer_revaluation_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//label[@for='current_value_svl']" position="before">
                <field name="product_tracking" invisible="1"/>
                <field name="is_cost_per_warehouse" invisible="1"/>

                <field name="lot_id" attrs="{'invisible': [('product_tracking', 'not in', ('lot', 'serial'))], 'required': [('product_tracking', 'in', ('lot', 'serial'))]}"/>
                <field name="warehouse_id" attrs="{'invisible': [('is_cost_per_warehouse', '!=', True)], 'required': [('is_cost_per_warehouse', '=', True)]}"/>
            </xpath>

            <xpath expr="//field[@name='current_value_svl']/parent::span" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='current_value_svl']/parent::span" position="after">
                <field name="current_value_message"/>
            </xpath>

            <xpath expr="//field[@name='added_value']/parent::span" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='added_value']/parent::span" position="after">
                <span><field name="added_value" class="oe_inline"/> <small class="mx-2 font-italic">Use a negative added value to record a decrease in the product value</small></span>
            </xpath>
            <xpath expr="//field[@name='added_value']/parent::span/parent::div" position="after">
                <label for="new_value_message" string="New Value"/>
                <div class="o_row">
                    <field name="new_value_message"/>
                </div>
            </xpath>
        </field>
    </record>

</odoo>