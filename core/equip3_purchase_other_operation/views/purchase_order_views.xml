<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="sh_purchase_order_wizard" model="ir.ui.view">
      <field name="model">purchase.order.wizard</field>
      <field name="inherit_id" ref="sh_so_po.sh_purchase_order_wizard"/>
      <field name="arch" type="xml">
        <xpath expr="//form" position="replace">
          <form string="Genarate Purchase Order">
              <group string="Group By Partner">
                  <group>
                      <field name="sh_group_by_partner" />
                      <field name="sh_create_po" />
                      <field name="sh_cancel_old_rfqs" />
                  </group>
              </group>
              <footer>
                  <button string="Generate Purchase Order" name="action_create_po" type="object" class="btn-primary" />
                  <button string="Cancel" class="btn-default" special="cancel" />
              </footer>
          </form>
        </xpath>
      </field>
    </record>
    
    <record id="sh_po_form_for_pmps_adv" model="ir.ui.view">
        <field name="name">sh.po.form.for.pmps.adv</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"></field>
        <field name="arch" type="xml">
            <button name="sh_pmps_adv_btn" position="after">
                <button name="set_not_editable" string="Request for Amendment" type="object" class="btn-primary" attrs="{'invisible':['|', ('not_editable','=',False), ('state', 'not in', ('draft', 'sent'))]}"/>
                <button name="action_button_confirm" string="Confirm" type="object" class="btn-primary" attrs="{'invisible':['|', ('not_editable','=',False), ('state', '!=', 'request_for_amendment')]}"/>
                <field name="not_editable" invisible="1"/>
                <field name="is_editable" invisible="1"/>
                <field name="hide_cancel" invisible="1"/>
            </button>
            <xpath expr="//field[@name ='order_line']//tree/field[@name='taxes_id']" position="after">
                <field name="requisition_line_id" invisible="1"/>
            </xpath>
            <xpath expr="//button[@name='action_quotation_send_wp']" position="after">
                <button string="Create Purchase Blanket Order" name="create_blanket_order" type="object" class="oe_highlight" attrs="{'invisible':[('is_btn_approval_matrix','=',False)]}"/>
                <field name="is_btn_approval_matrix" invisible="1"/>
            </xpath>
            <xpath expr="//button[@name='action_quotation_send_wp']" position="attributes">
                <attribute name="attrs">{'invisible':[('state','=', 'request_for_amendment')]}</attribute>
            </xpath>
            <xpath expr="//button[@name='sh_cancel']" position="attributes">
                <attribute name="attrs">{'invisible':[('hide_cancel', '=', True)]}</attribute>
            </xpath>
        </field>
    </record>

    <record id="view_report_company_purchase_order_template" model="ir.ui.view">
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="general_template.view_report_company_purchase_order_template"></field>
        <field name="arch" type="xml">
            <field name="report_template_id" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>

    <record id="purchase_order_form_inherit_view_form" model="ir.ui.view">
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="equip3_purchase_operation.purchase_order_form_inherit_view_form"></field>
        <field name="arch" type="xml">
            <field name="partner_id" position="attributes">
                <attribute name="attrs">{'readonly': ['|', '|', ('is_quantity_copy', '=', 'none'), ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
        </field>
    </record>
      
    <record id="purchase_order_view_form" model="ir.ui.view">
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="equip3_purchase_operation.purchase_order_view_form"></field>
        <field name="arch" type="xml">
            <field name="partner_ref" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="currency_id" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="branch_id" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <xpath expr="//field[@name='analytic_account_group_ids']" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('analytic_accounting', '=', False),('show_analytic_tags','=',False)], 'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='date_order']" position="attributes">
              <attribute name="attrs">{'readonly': [('not_editable', '=', True)], 'invisible': [('state', 'in', ['purchase', 'done', 'retreat'])]}</attribute>
          </xpath>
            <xpath expr="//div[@name='date_planned_div']/field[@name='date_planned']" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve']), ('is_editable', '=', True)],'required': [('is_delivery_receipt', '=', True)], 'invisible': [('is_delivery_receipt', '=', False)]}</attribute>
            </xpath>
            <xpath expr="//label[@for='date_planned']" position="attributes">
                <attribute name="attrs">{'invisible': [('is_delivery_receipt', '=', False)],'required': [('is_delivery_receipt', '=', True)]}</attribute>
                <attribute name="string">Expected Date</attribute>
            </xpath>
            <xpath expr="//field[@name='is_delivery_receipt']" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('is_editable', '=', True)]}</attribute>
            </xpath>
            <field name="receipt_reminder_email" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('is_editable', '=', True)]}</attribute>
            </field>
            <xpath expr="//field[@name='origin']" position="attributes">
                <attribute name="attrs">{'readonly': ['|', '|', ('state', 'in', ['retreat']), ('not_editable', '=', True), ('po_state', 'in', ['waiting_for_approve', 'rfq_approved', 'purchase'])]}</attribute>
            </xpath>
            <xpath expr="//page[@name='products']//field[@name='order_line']" position="attributes">
                <attribute name="attrs">{'invisible' : [('state', '=', 'request_for_amendment')], 'readonly': ['|', ('state', 'in', ['done', 'cancel', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </xpath>

            <xpath expr="//page[@name='products']//field[@name='order_line']" position="after"> 
                <field name="tender_order_line" attrs="{'invisible': [('state', '!=', 'request_for_amendment')]}">
                    <tree string="Purchase Order Lines" create="0" editable="bottom">
                        <field name="display_type" invisible="1"/>
                        <field name="currency_id" invisible="1"/>
                        <field name="state" invisible="1" readonly="1"/>
                        <field name="product_type" invisible="1"/>
                        <field name="product_uom_category_id" invisible="1"/>
                        <field name="invoice_lines" invisible="1"/>
                        <field name="sequence" widget="handle"/>
                        <field name="product_id" attrs="{'readonly': [('state', 'in', ('purchase', 'to approve','done', 'cancel'))], 'required': [('display_type', '=', False)]}" context="{'partner_id':parent.partner_id, 'quantity':product_qty,'uom':product_uom, 'company_id': parent.company_id}" force_save="1" domain="[('purchase_ok', '=', True), '|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]" readonly="1"/>
                        <field name="name" widget="section_and_note_text"/>
                        <field name="agreement_id"/>
                        <field name="destination_warehouse_id"/>
                        <field name="analytic_tag_ids" optional="hide" groups="analytic.group_analytic_tags" widget="many2many_tags" options="{'color_field': 'color'}" domain="['|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]"/>
                        <field name="discount_method"/>
                        <field name="discount_amount"/>
                        <field name="sh_tender_note"/>
                        <field name="product_qty"/>
                        <field name="product_uom" string="UoM" groups="uom.group_uom" attrs="{'readonly': [('state', 'in', ('purchase', 'done', 'cancel'))], 'required': [('display_type', '=', False)]}" force_save="1" optional="show"/>
                        <field name="price_unit" attrs="{'readonly': [('invoice_lines', '!=', [])]}"/>
                        <field name="taxes_id" widget="many2many_tags" domain="[('type_tax_use','=','purchase'), ('company_id', '=', parent.company_id)]" context="{'default_type_tax_use': 'purchase', 'search_view_ref': 'account.account_tax_view_search'}" options="{'no_create': True}" optional="show"/>
                        <field name="last_purchased_price"/>
                        <field name="last_customer_purchase_price"/>
                        <field name="price_subtotal" widget="monetary"/>
                        <field name="qty_received_manual" invisible="1"/>
                        <field name="qty_received_method" invisible="1"/>
                    </tree>
                </field>
            </xpath>
            <field name="payment_term_id" position="attributes">
                <attribute name="attrs">{'readonly': ['|', '|', ('invoice_status','=', 'invoiced'), ('state', 'in', ('done', 'rfq_approved', 'retreat')), ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="reminder_date_before_receipt" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']),  ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="notes" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="user_id" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="fiscal_position_id" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="invoice_status" position="attributes">
                <attribute name="attrs">{'invisible': [('state', 'in', ('draft', 'sent', 'to approve', 'cancel'))], 'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <xpath expr="//field[@name='reference_purchase_price']" position="attributes">
                <!-- Add your fields here -->
                <attribute name="attrs">{'column_invisible': [('parent.agreement_id', '!=', False)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='purchase_line_cost_saving']" position="attributes">
                <!-- Add your fields here -->
                <attribute name="attrs">{'column_invisible': [('parent.agreement_id', '!=', False)]}</attribute>
            </xpath>
        </field>

    </record>

    <record id="view_purchase_order_invoice_discount_form" model="ir.ui.view">
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="equip3_purchase_operation.view_purchase_order_invoice_discount_form_inherits"></field>
        <field name="arch" type="xml">
            <field name="discount_method" position="before">
                <field name="not_editable" invisible="1"/>
            </field>
            <field name="discount_type" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve','retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="discount_method" position="before">
                <field name="not_editable" invisible="1"/>
            </field>
            <field name="discount_method" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)], 'invisible': [('discount_type','=','line')]}</attribute>
            </field>
            <field name="discount_amount" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)], 'invisible': [('discount_type','=','line')]}</attribute>
            </field>
            <xpath expr="//page[@name='products']/group[@name='group_disc']/div[1]/field[@name='discount_method']" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)], 'invisible': [('discount_type','=','line')]}</attribute>
            </xpath>
            <xpath expr="//page[@name='products']/group[@name='group_disc']/div[2]/field[@name='discount_amount']" position="attributes">
                <attribute name="attrs">{'readonly': ['|', '|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True), ('multilevel_disc','=',True), ('discount_method', '=', 'per')], 'invisible': [('discount_type','=','line')]}</attribute>
                <attribute name="force_save">1</attribute>
            </xpath>
        </field>
    </record>

    <record id="purchase_order_view_form_inherit" model="ir.ui.view">
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="equip3_purchase_operation.purchase_order_view_form_inherit"></field>
        <field name="arch" type="xml">
            <field name="destination_warehouse_id" position="before">
                <field name="not_editable" invisible="1"/>
            </field>
            <field name='destination_warehouse_id' position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('is_editable', '=', True)], 'invisible': [('is_single_delivery_destination', '!=', True)], 'required': [('is_single_delivery_destination', '=', True)]}</attribute>
            </field>
            <field name="is_single_delivery_destination" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'waiting_for_approve', 'retreat']), ('is_editable', '=', True)]}</attribute>
            </field>
            <field name="incoterm_id" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
        </field>
    </record>

     <record id="sh_purchase_order_history_form_view_inherit_all_tools" model="ir.ui.view">
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="equip3_purchase_operation.sh_purchase_order_history_form_view_inherit_all_tools"></field>
        <field name="arch" type="xml">
            <field name="order_history_line" position="before">
                <field name="not_editable" invisible="1"/>
            </field>
            <field name="order_history_line" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
        </field>
    </record>

    <record id="view_purchase_order_team_form" model="ir.ui.view">
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="equip3_purchase_operation.view_purchase_order_team_form"></field>
        <field name="arch" type="xml">
            <field name="team_id" position="before">
                <field name="not_editable" invisible="1"/>
            </field>
            <field name="team_id" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
        </field>
    </record>

    <record id="purchase_order_view_form_inherite_from_sh" model="ir.ui.view">
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="equip3_purchase_operation.purchase_order_view_form_inherite_from_sh"></field>
        <field name="arch" type="xml">
            <field name="custom_checklist_template_ids" position="before">
                <field name="not_editable" invisible="1"/>
            </field>
            <field name="custom_checklist_template_ids" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
            <field name="custom_checklist_ids" position="attributes">
                <attribute name="attrs">{'readonly': ['|', ('state', 'in', ['purchase', 'done', 'cancel', 'rfq_approved', 'retreat']), ('not_editable', '=', True)]}</attribute>
            </field>
        </field>
    </record>

    <function model="purchase.order" name="action_approval_matrix_menu"/>

    <record id="sh_bidline_tree_view_inherit" model="ir.ui.view">
        <field name="name">sh.bidline.tree.view.inherit</field>
        <field name="model">purchase.order.line</field>
        <field name="inherit_id" ref="sh_po_tender_management.sh_bidline_tree_view"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="company_size"/>
                <field name="capital_revenue" options="{'currency_field': 'company_currency'}"/>
            </xpath>
            <xpath expr="//field[@name='price_unit']" position="before">
                <field name="discount_amount"/>
                <field name="base_price" readonly="True" force_save="1"/>
            </xpath>
            <xpath expr="//field[@name='price_unit']" position="after">
<!--                <field name="bid" readonly="True" force_save="1"/>-->
                <field name="cost_saving" readonly="True" force_save="1"/>
                <field name="cost_saving_percentage" readonly="True" force_save="1"/>
            </xpath>
            <xpath expr="//field[@name='product_qty']" position="before">
                <field name="base_quantity" readonly="True" force_save="1"/>
            </xpath>
            <xpath expr="//field[@name='product_qty']" position="after">
                <field name="product_uom" string="UoM"/>
            </xpath>
            <xpath expr="//field[@name='price_subtotal']" position="after">
                <field name="lead_time"/>
                <field name="payment_term_id"/>
                <field name="feedback"/>
            </xpath>
            <xpath expr="//button[@name='action_update_qty']" position="replace">
                <!-- Add your fields here -->
                <!-- <attribute name="invisible">1</attribute> -->
            </xpath>
            <xpath expr="//button[@name='action_cancel']" position="attributes">
                <!-- Add your fields here -->
                <attribute name="name">%(act_open_purchase_line_wiz)d</attribute>
                <attribute name="type">action</attribute>
            </xpath>
            <field name="status" position="after">
                <field name="company_id" optional="hide"/>
                <field name="branch_id" optional="hide"/>
            </field>


            <!-- OPTIONAL COLUMN -->
            <field name="order_id" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="name" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="partner_id" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="company_size" position="attributes">
                <attribute name="optional">hide</attribute>
            </field>
            <field name="capital_revenue" position="attributes">
                <attribute name="optional">hide</attribute>
            </field>
            <field name="product_id" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="discount_amount" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="base_price" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="base_quantity" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="price_unit" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="cost_saving" position="attributes">
                <attribute name="optional">hide</attribute>
            </field>
            <field name="cost_saving_percentage" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="product_qty" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="product_uom" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="price_subtotal" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
            <field name="lead_time" position="attributes">
                <attribute name="optional">hide</attribute>
            </field>
            <field name="payment_term_id" position="attributes">
                <attribute name="optional">hide</attribute>
            </field>
            <field name="feedback" position="attributes">
                <attribute name="optional">hide</attribute>
            </field>
            <field name="status" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
        </field>
    </record>

    <record id="purchase_order_line_form2_sub_inherit" model="ir.ui.view">
        <field name="name">purchase.order.line.form2.inherit</field>
        <field name="model">purchase.order.line</field>
        <field name="inherit_id" ref="purchase_request.purchase_order_line_form2_sub"/>
        <field name="arch" type="xml">
            <xpath expr="//group/group/field[@name='price_unit']" position="before">
                <field name="discount_amount" readonly="True" force_save="1"/>
                <field name="base_price" readonly="True" force_save="1"/>
            </xpath>
            <xpath expr="//group/group/field[@name='price_unit']" position="after">
<!--                <field name="bid" readonly="True" force_save="1"/>-->
                <field name="cost_saving" readonly="True" force_save="1"/>
<!--                <field name="price_subtotal2" readonly="True" force_save="1"/>-->
                <field name="payment_term_id"/>
                <field name="lead_time"/>
            </xpath>
        </field>
    </record>

<!--    <record id="direct_purchase_form_view_inherit" model="ir.ui.view">-->
<!--        <field name="name">direct.purchase.form.view.inherit</field>-->
<!--        <field name="model">purchase.order</field>-->
<!--        <field name="inherit_id" ref="equip3_purchase_other_operation_cont.direct_purchase_form_view"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <xpath expr="//sheet/notebook/page[@name='products']/field[@name='order_line']/tree/field[@name='price_unit']" position="after">-->
<!--                <field name="bid" readonly="True" force_save="1"/>-->
<!--                <field name="cost_saving" readonly="True" force_save="1"/>-->
<!--            </xpath>-->
<!--            <xpath expr="//sheet/notebook/page[@name='products']/field[@name='order_line']/tree/field[@name='price_subtotal']" position="after">-->
<!--                <field name="price_subtotal2" readonly="True" force_save="1"/>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

    <record id="purchase_form_view_inherit" model="ir.ui.view">
        <field name="name">purchase.form.view.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"/>
        <field name="arch" type="xml">
            <field name="state" position="attributes">
                <attribute name="statusbar_visible">draft,sent,purchase,retreat</attribute>
            </field>
            <xpath expr="//sheet/notebook/page[@name='products']/field[@name='order_line']/tree/field[@name='price_unit']" position="before">
                <field name="base_price" readonly="True" force_save="1" attrs="{'column_invisible': [('parent.agreement_id', '==', False)]}"/>
            </xpath>
            <xpath expr="//sheet/notebook/page[@name='products']/field[@name='order_line']/tree/field[@name='product_qty']" position="before">
                <field name="base_quantity" readonly="True" force_save="1" attrs="{'column_invisible': [('parent.agreement_id', '==', False)]}"/>
            </xpath>
            <xpath expr="//sheet/notebook/page[@name='products']/field[@name='order_line']/tree/field[@name='price_unit']" position="after">
                <field name="cost_saving" readonly="True" force_save="1" attrs="{'column_invisible': [('parent.agreement_id', '==', False)]}"/>
            </xpath>
            
<!--            <xpath expr="//sheet/notebook/page[@name='products']/field[@name='order_line']/tree/field[@name='price_subtotal']" position="after">-->
<!--                <field name="price_subtotal2" readonly="True" force_save="1" attrs="{'column_invisible': [('parent.agreement_id', '==', False)]}"/>-->
<!--            </xpath>-->
            <xpath expr="//field[@name='origin']" position="after">
                <field name="product_template_id" position="move"/>
            </xpath>
            <xpath expr="//field[@name='sh_purchase_barcode_mobile']" position="attributes">
              <attribute name="attrs">{'readonly': ['|', '|', ('state', 'in', ['retreat']), ('not_editable', '=', True), ('po_state', 'in', ['waiting_for_approve', 'rfq_approved', 'purchase'])]}</attribute>
            </xpath>
            <xpath expr="//field[@name='product_template_id']" position="attributes">
              <attribute name="attrs">{'readonly': ['|', '|', ('state', 'in', ['retreat']), ('not_editable', '=', True), ('po_state', 'in', ['waiting_for_approve', 'rfq_approved', 'purchase'])]}</attribute>
            </xpath>
            <!-- <xpath expr="//field[@name='order_line']" position="attributes">
                <attribute name="string">Purchase Order Lines</attribute>
            </xpath>     -->
        </field>
    </record>
    <record id="purchase_tree_view_inherit_po" model="ir.ui.view">
        <field name="name">purchase.form.view.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_view_tree"/>
        <field name="arch" type="xml">
            <field name="state" position="replace">
                <field name="state" widget="badge" optional="show" 
                    decoration-warning2="state == 'request_for_amendment'" 
                    decoration-primary="state in ('draft', 'purchase')"
                    decoration-primary2="state == 'sent'" 
                    decoration-warning="state in ('to approve', 'waiting_for_approve')"
                    decoration-success="state in ('rfq_approved', 'closed')"
                    decoration-danger="state == 'reject'" 
                    decoration-success2="state == 'done'"
                    decoration-warning3="state == 'on_hold'"
                    decoration-muted="state == 'retreat'"
                    decoration-secondary="state == 'cancel'"
                    decoration-primary3="state == 'blanket_ordered'"
                       />
            </field>
            <xpath expr="//button[@name='action_create_invoice']" position="attributes">
                <attribute name="attrs">{'invisible' : 1}</attribute>
            </xpath>
        </field>
    </record>

    <record id="purchase_tree_view_inherit_rfq" model="ir.ui.view">
        <field name="name">purchase.form.view.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_kpis_tree"/>
        <field name="arch" type="xml">
            <field name="state" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="state" position="after">
                <field name="state" widget="badge" optional="show" 
                    decoration-warning2="state == 'request_for_amendment'" 
                    decoration-primary="state in ('draft', 'purchase')"
                    decoration-primary2="state == 'sent'" 
                    decoration-warning="state in ('to approve', 'waiting_for_approve')"
                    decoration-success="state == 'rfq_approved'" 
                    decoration-danger="state == 'reject'" 
                    decoration-success2="state == 'done'"
                    decoration-warning3="state == 'on_hold'"
                    decoration-muted="state == 'retreat'"
                    decoration-secondary="state == 'cancel'"
                    decoration-primary3="state == 'blanket_ordered'"/>
            </field>
            <xpath expr="//button[@name='action_create_invoice']" position="attributes">
                <attribute name="attrs">{'invisible' : 1}</attribute>
            </xpath>
            <field name="date_planned" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="date_planned" position="after">
                <field name="date_planned" optional="hide"/>
            </field>
            <xpath expr="//field[@name='name']" position="after">
                <field name="agreement_id" optional="hide"/>
            </xpath>
            <field name="date_approve" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="date_approve" position="after">
                <field name="date_approve" optional="hide"/>
            </field>
        </field>
    </record>
  
    <record id="purchase_tree_view_inherit_rfq_tender_submission" model="ir.ui.view">
        <field name="name">purchase.form.view.inherit</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="attributes">
                <attribute name="create">false</attribute>
            </xpath>
            <xpath expr="//tree" position="inside">
                <field name="branch_id" optional="hide"/>
                <field name="company_id" position="move"/>
            </xpath>
            <xpath expr="//field[@name='agreement_id']" position="attributes">
                <attribute name="optional">hide</attribute>
            </xpath>
            <xpath expr="//field[@name='date_approve']" position="attributes">
                <attribute name="optional">hide</attribute>
            </xpath>
            <xpath expr="//field[@name='name']" position="after">
                <field name="purchase_tag_ids" widget="many2many_tags" optional="hide"/>
            </xpath>
            <xpath expr="//field[@name='user_id']" position="after">
                <field name="date_order" optional="hide"/>
                <field name="activity_ids" optional="hide"/>
            </xpath>
            <xpath expr="//field[@name='amount_total']" position="after">
                <field name="custom_checklist" optional="hide"/>
            </xpath>
        </field>
    </record>

    <record id="equip3_purchase_operation.purchase_rfq_orders" model="ir.actions.act_window">
      <field name="domain">[('name', 'ilike', 'RFQ'), ('dp', '=', False),('agreement_id','=',False)]</field>
    </record>
    <record id="purchase.purchase_rfq" model="ir.actions.act_window">
        <field name="domain">[('dp', '=', False), (
            'state', 'in', ['draft', 'sent', 'cancel', 'waiting_for_approve', 'reject', 'rfq_approved', 'blanket_ordered']),
                              ('po', '=', False), ('is_goods_orders', '=', True),('agreement_id','=',False)]</field>
    </record>

    <record model="ir.ui.view" id="other_operation_purchase_order_tree">
        <field name="name">app.purchase.order.view</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="attributes">
                <attribute name="decoration-muted">state in ('cancel','retreat')</attribute> 
            </xpath>
            <field name="state" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="state" position="after">
                <field name="state" widget="badge" optional="show"
                decoration-primary="state in ('draft', 'purchase')"
                decoration-primary2="state == 'sent'" 
                decoration-primary3="state == 'blanket_ordered'" 
                decoration-warning="state == 'waiting_for_approve'" 
                decoration-success="state == 'rfq_approved'" 
                decoration-secondary="state == 'cancel'" 
                decoration-muted="state == 'retreat'" 
                decoration-warning2="state == 'request_for_amendment'" 
                decoration-danger="state == 'reject'" 
                decoration-warning3="state == 'on_hold'"/>
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="other_operation_purchase_order_view_tree">
        <field name="name">other.operation.purchase.order.view.tree</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_view_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='date_planned']" position="attributes">
                <attribute name="string">Expected Date</attribute>
            </xpath>
        </field>
    </record>

    <record id="purchase_form_dev_purchase_down_payment_inherited2" model="ir.ui.view">
        <field name="name">purchase.form.dev.purchase.down.payment.inherited2</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="equip3_purchase_operation.purchase_form_dev_purchase_down_payment_inherited"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_dev_purchase_down_payment']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', '|', '|',('total_down_payment_amount','=',0), ('amount_total', '=', 0), ('state', '!=', 'purchase'), ('hide_create_bill', '=', True)]}</attribute>
            </xpath>
        </field>
    </record>

</odoo>

