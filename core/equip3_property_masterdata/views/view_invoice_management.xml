<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        <!-- account.move tree view -->
        <record id="invoice_management_tree_inherit" model="ir.ui.view">
          <field name="name">account.move.view.tree.inherit</field>
          <field name="model">account.move</field>
          <field name="inherit_id" ref="account.view_out_invoice_tree"/>
          <field name="arch" type="xml">
            <xpath expr="//tree" position="attributes">
              <attribute name="create">true</attribute>
              <attribute name="delete">true</attribute>
              <attribute name="edit">true</attribute>
            </xpath>
          </field>
        </record>

        <!-- Invoice Management tree view -->
        <record id="property_invoice_management_view_tree" model="ir.ui.view">
          <field name="name">account.move.view.tree</field>
          <field name="model">account.move</field>
          <field name="arch" type="xml">
            <tree>
              <field name="name" decoration-bf="1"/>
              <field name="partner_id" string="Customer"/>
              <field name="property_id"/>
              <field name="agreement_id" string="Contract Title"/>
              <field name="invoice_date_due"/>
              <field name="period_id"/>
              <field name="amount_tax"/>
              <field name="activity_ids" widget="list_activity" optional="show"/>
              <field name="amount_untaxed"/>
              <field name="amount_total"/>
              <field name="state" widget="badge" decoration-info="state == 'draft'" decoration-success="state == 'posted'"/>
              <field name="payment_state" widget="badge" decoration-danger="payment_state == 'not_paid'" decoration-warning="payment_state in ('partial', 'in_payment')" decoration-success="payment_state in ('paid', 'reversed')" attrs="{'invisible': [('payment_state', 'in', ('invoicing_legacy'))]}"/>
            </tree>
          </field>
        </record>

        <record id="action_invoice_management" model="ir.actions.act_window">
            <field name="name">Invoices Management</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">tree,kanban</field>
            <field name="view_id" ref="account.view_out_invoice_tree"/>
            <field name="search_view_id" ref="account.view_account_invoice_filter"/>
            <field name="domain">[('property_id', '!=', False)]</field>
            <field name="context">{'default_move_type': 'out_invoice'}</field>
            <field name="view_ids" eval="[(5, 0, 0), 
              (0, 0, {'view_mode': 'tree', 'view_id': ref('property_invoice_management_view_tree')}), 
              (0, 0, {'view_mode': 'form', 'view_id': ref('account.view_move_form')})]"/>
            <field name="help" type="html">
              <p class="o_view_nocontent_smiling_face">
                Create a customer invoice
              </p><p>
                Create invoices, register payments and keep track of the discussions with your customers.
              </p>
            </field>
        </record>

    
        <!-- This Menu Item must have a parent and an action -->
        <menuitem id="menu_invoice_management" name="Invoice Management" parent="equip3_property_masterdata.property_operation_menu" action="action_invoice_management" sequence="20"/>
    
    </data>
    
</odoo>