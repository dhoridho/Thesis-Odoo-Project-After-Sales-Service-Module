<template>
    <t t-name="pettycash_analysis">
        <div class="">
            <div>
                <h1 style="padding:10px">
                    Enterprise Petty Cash Analysis
                </h1>
            </div>
            <div>
                <div class="filter_view_tb" style="overflow: unset; height:30vh;"></div>
            </div>
            <br></br>
            <div>
                <div class="table_view_tb" style="right:20px; width:100%;"></div>
            </div>
        </div>
    </t>

    <t t-name="EntPettycashTableView">
       <div>
            <style>
                /* Default style for the div */
                .table_main_view {
                    overflow: unset;
                    height: 85vh; /* Default height */
                }

                /* Media query for screens with a maximum width of 600 pixels */
                @media screen and (max-width: 600px) {
                    .table_main_view {
                        height: 50vh; /* Adjust the height for screens up to 600 pixels wide */
                    }
                }

                /* Media query for screens with a minimum width of 601 pixels and a maximum width of 1200 pixels */
                @media screen and (min-width: 601px) and (max-width: 1200px) {
                    .table_main_view {
                        height: 60vh; /* Adjust the height for screens between 601 and 1200 pixels wide */
                    }
                }

                /* Media query for screens with a minimum width of 1201 pixels */
                @media screen and (min-width: 1201px) {
                    .table_main_view {
                        height: 70vh; /* Keep the default height for screens wider than 1200 pixels */
                    }
                }
            </style>
            <div class="table_main_view">
                <table cellspacing="0" width="100%">
                    <thead>
                        <tr style="border-bottom: double;">
                            <th colspan="6">Pettycash Account</th>
                            <t t-foreach="list_periode" t-as="periode">
                                <th style="text-align:right;">
                                    <t t-esc="periode"/>
                                </th>
                            </t>
                        </tr>
                    </thead>

                    <tbody>
                        <t t-set="none_value" t-value="_"/>
                        
                        <t t-foreach="report_lines" t-as="account">
                            <t t-set="common_id" t-value="0"/>
                            <tr t-attf-class="plg-line c{{account['id']}}"
                                t-att-data-account-id="account['id']"
                                t-attf-data-target=".a{{account['id']}}"
                                data-toggle="collapse"
                                style="border: 0.5px solid #deb9b9;">
                                <td colspan="6" style="border: 0px solid black;">
                                    <i class="fa fa-caret-down" role="img" aria-label="Unfolded" title="Unfolded"></i>
                                    <span>
                                        <t t-esc="account['name']"/>
                                    </span>
                                </td>

                                <t t-foreach="list_periode" t-as="periode">
                                    <t t-foreach="pettycash_result[periode]" t-as="pattycash_res">
                                        <t t-if="account['id'] == pattycash_res['id']">
                                            <td style="text-align:right;">
                                                <t t-esc="currency[0]"/>
                                                <t t-raw="pattycash_res['amount']"/>
                                            </td>
                                        </t>
                                    </t>
                                </t>
                                <t t-set="common_id" t-value="'a'+account['id']"/>
                            </tr>
                  
                            <tr t-attf-class="collapse a{{account['id']}}">
                                <td colspan="20">
                                    <ul>
                                    </ul>
                                </td>
                            </tr>
                        </t>
                    </tbody>

                    <tfoot>
                        <tr style="border-top: double;border-bottom: 1px solid;">
                            <td colspan="6" style="text-align:left;">
                                <b>Total Amount Pettycash</b>
                            </td>
                            <t t-foreach="list_periode" t-as="periode">
                                <td style="text-align:right;">
                                    <b>
                                        <t t-esc="currency[0]"/>
                                        <t t-esc="list_total_balance[periode]"/>
                                    </b>
                                </td>
                            </t>
                        </tr>
                        
                        <tr style="border-bottom: 1px solid;">
                            <td colspan="6" style="text-align:left;">
                                <b>Total Expenses Pettycash</b>
                            </td>
                            <t t-foreach="list_periode" t-as="periode">
                                <td style="text-align:right;">
                                    <b>
                                        <t t-esc="currency[0]"/>
                                        <t t-esc="list_total_expenses[periode]"/>
                                    </b>
                                </td>
                            </t>
                        </tr>

                        <tr style="border-bottom: double;">
                            <td colspan="6" style="text-align:left;">
                                <b>Total Virtual Balance</b>
                            </td>
                            <t t-foreach="list_periode" t-as="periode">
                                <td style="text-align:right;">
                                    <b>
                                        <t t-esc="currency[0]"/>
                                        <t t-esc="list_total_virtual[periode]"/>
                                    </b>
                                </td>
                            </t>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </t>

    <t t-name="EntPettycashFilterView">
        <div class="">
               <h1 style="padding:10px">
                    <t t-esc="title"/>
                </h1>
        </div>
        <div class="" style="position: relative;">
            <div class="sub_container_right" style="width:50%;height:3%;right:0px;top:0px;position: absolute;">
                <div>
                    <button class="btn btn-primary o_filters_toggler" id="o_equip_filter_dropdown" style="position: absolute; right: 35.63%; top: 17.78%; bottom: 79.17%; height: 30px; padding: 0; width: 20%;">
                        <span style="align-items: center; justify-content: center;"><i class="fa fa-search mr-2" style="font-size: 17px !important;"/></span>
                        <span style="font-size: 17px;">&#160;Filter</span>
                    </button>


                    <div class="filter_content" style="position:relative; top:43px; left:2%; width:67%; display:none; text-align:right; background-color: white; filter: drop-shadow(0px 0px 16px rgba(0, 0, 0, 0.161)); padding: 5px;">
                        <div style="text-align:center;">
                            <button type="button" id="apply_filter" class="btn btn-primary" style="padding: 0; height: 25px; width: 25%;">
                                Apply
                            </button>
                        </div>
                        <br />

                        <div class="time_range" style="">
                            <div class="btn-group o_account_reports_date-filter" style="width:100%;">
                                <a type="button" class="dropdown-toggle dropdown-item" data-toggle="dropdown" style="width:100%;">
                                    <span class="fa fa-calendar filter-content" style="float: left;"></span>
                                    <span class="filter-content" style="float: left;">&#160;Date: </span>
                                    <span class="date_caret"/>
                                </a>
                                <ul class="dropdown-menu o_filters_menu o_date_filter" style="width:100%;" role="menu">
      
                                    <li class="filter_date" title="Today" data-value="today"><a class="dropdown-item">Today</a></li>
                                    <li class="filter_date" title="This Month" data-value="month"><a class="dropdown-item">This Month</a></li>
                                    <li class="filter_date" title="This Quarter" data-value="quarter"><a class="dropdown-item">This Quarter</a></li>
                                    <li class="filter_date" title="This Financial Year" data-value="year"><a class="dropdown-item">This Financial Year</a></li>
                                    <li role="separator" class="dropdown-divider"></li>
                                    <li class="filter_date" title="Last Month" data-value="last_month"><a class="dropdown-item">End of Last Month</a></li>
                                    <li class="filter_date" title="Last Quarter" data-value="last_quarter"><a class="dropdown-item">End of Last Quarter</a></li>
                                    <li class="filter_date" title="Last Financial Year" data-value="last_year"><a class="dropdown-item">End of Last Financial Year</a></li>
                                    <li role="separator" class="dropdown-divider"></li>
                                    <div class="o_generator_menu"><button type="button" aria-expanded="false" class="o_add_custom_filter dropdown-item">Custom</button></div>
                                    <li class="o_account_reports_custom-dates d-none" title="Custom" data-value='custom' style='margin-top: 5px;'>
                                        <div class="o_filter_condition dropdown-item-text">
                                            <label><b>from Date :</b></label>
                                            <div class="">
                                                <div class="" aria-atomic="true" id="">
                                                    <input class="dropdown-item" type="date" id="date_from"></input>
                                                </div>
                                            </div>
                                            <label><b>To Date :</b></label>
                                            <div class="">
                                                <div class="" aria-atomic="true" id="">
                                                    <input class="dropdown-item" type="date" id="date_to"></input>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    
                                </ul>
                            </div>
                        </div>
                        <div class="branch_filter" style="width:100%;">
                            <a type="button" class="dropdown-toggle dropdown-item" data-toggle="dropdown" style="width:100%;">
                                <span class="fa fa-users filter-content" style="float: left;"></span>
                                <span class="filter-content" style="float: left;">&#160;Branch: </span>
                                <span id="branch_res"></span>
                            </a>
                            <select class="dropdown-menu branchs " name="states[]" multiple="multiple" style="width:100%;">
                                <t t-foreach="filter_data.branchs_list" t-as="branch">
                                    <option t-attf-value="{{branch[0]}}">
                                        <t t-esc="branch[1]"/>
                                    </option>
                                </t>
                            </select>
                        </div>
                        <div class="accounts_filter" style="width:100%;">
                            <a type="button" class="dropdown-toggle dropdown-item" data-toggle="dropdown" style="width:100%;">
                                <span class="fa fa-book filter-content" style="float: left;"></span>
                                <span class="filter-content" style="float: left;">&#160;Accounts: </span>
                                <span id="acc_res"></span>
                            </a>
                            <select class="dropdown-menu account" name="states[]" multiple="multiple" style="width:100%;">
                                <t t-foreach="filter_data.accounts_list" t-as="account">
                                    <option t-attf-value="{{account[0]}}">
                                        <t t-esc="account[1]"/>
                                    </option>
                                </t>
                            </select>
                        </div>
                        <div class="top_expenses_filter" style="width:100%;">
                            <a type="button" class="dropdown-toggle dropdown-item" data-toggle="dropdown" style="width:100%;">
                                <span class="fa fa-filter filter-content" style="float: left;"></span>
                                <span class="filter-content" style="float: left;">&#160;Top Expense </span>
                                <span id="top_expenses_res"></span>
                            </a>
                            <select id="top_expenses" class="dropdown-menu top_expenses" name="top_expenses[]" style="width:100%;">
                                <div role="separator" class="dropdown-divider"></div>
                                <option value="off">Off</option>
                                <option value="on">On</option>
                            </select>
                        </div>                        

                        <div class="time_range" style="width:100%;">
                            <div class="btn-group o_account_reports_date-filter" style="width:100%;">
                                <a type="button" class="dropdown-toggle dropdown-item" data-toggle="dropdown" style="width:100%;">
                                    <span class="fa fa-calendar filter-content" style="float: left;"></span>
                                    <span class="filter-content" style="float: left;">&#160;Comparison: </span>
                                    <span class="date_caret_comp"/>
                                </a>
                                <ul class="dropdown-menu o_filters_menu_comp o_date_filter_comp" role="menu" style="width:100%;">
                                    <div class="o_generator_menu"><button type="button" aria-expanded="false" class="o_add_custom_filter_prev dropdown-item">Previous Period</button></div>
                                    <li class="o_account_reports_custom-prev d-none" data-value='prev' style='margin-top: 5px;'>
                                        <div class="o_filter_condition dropdown-item-text">
                                            <div class="">
                                                <div class="" aria-atomic="true" id="">
                                                    <span>Number of Period:</span>
                                                    <input type="text" id="prev" class="o_input"></input>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li role="separator" class="dropdown-divider"></li>
                                    <div class="o_generator_menu"><button type="button" aria-expanded="false" class="o_add_custom_filter_last dropdown-item">Same Period Last Year:</button></div>
                                    <li class="o_account_reports_custom-last d-none" data-value='last' style='margin-top: 5px;'>
                                        <div class="o_filter_condition dropdown-item-text">
                                            <div class="">
                                                <div class="" aria-atomic="true" id="">
                                                    <span>Number of Period:</span>
                                                    <input type="text" id="last" class="o_input"></input>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>


                    </div>
                    <button type="button" class="btn btn-primary" id="pdf"
                            style="position: absolute; right: 25.63%; top: 17.78%; bottom: 79.17%; height: 30px;">
                        PDF
                    </button>
                    <button type="button" class="btn btn-primary" id="xlsx"
                            style="position: absolute; right: 15.42%; top: 17.78%; bottom: 79.17%; height: 30px;">
                        XLSX
                    </button>

                    <button type="button" class="btn btn-primary collapse-all" id="collapse-button"
                            style="position: absolute; right: 1.42%; top: 17.78%; bottom: 79.17%; height: 30px;">
                        Expand
                    </button> 
                </div>
            </div>

            <div class="active-filter" style="margin-left: 2%; display: none;">
                <style>
                    .a-active-filter {
                        border: 1px solid black; 
                        border-radius: 25px; 
                        padding: 0 10px 0 10px; 
                        margin-right:5px;
                        display: none;
                    }
                </style>

                <span class="fa fa-circle" style="color: lightgreen;"></span>
                <span class="">&#160;Active filter</span>
                <br />

                <a class="date-filter a-active-filter">
                    <span class="fa fa-calendar"/>
                    <t>Date: </t>
                    <span class="date_caret"/>
                </a>

                <a class="top-expenses-filter a-active-filter">
                    <span class="fa fa-filter"></span>
                    Top Expenses:
                    <span id="top_expenses_res"></span>
                </a> 

                <a class="branchs-filter a-active-filter">
                    <span class="fa fa-book"></span>
                    <span>Branchs: </span>
                    <span id="branch_res"></span>
                </a>

                <a class="accounts-filter a-active-filter">
                    <span class="fa fa-book"></span>
                    <span>Accounts: </span>
                    <span id="acc_res"></span>
                </a>

                <a class="entities-comparison-filter a-active-filter">
                    <span class="fa fa-filter"></span>
                    Entities Comparison:
                    <span id="entities_comparison_res"></span>
                </a>

            </div>
            <br />
            <div class="clear-filter" style="margin-left: 2%; display: none;">
                <style>
                    .btn-clear-filter {
                        border: 1px solid black !important; 
                        border-radius: 25px !important; 
                        padding: 0 10px 0 10px; 
                        margin-right:5px;
                        color: white !important;
                        background-color: #707070 !important;
                    }
                </style>

                <button class="btn-clear-filter btn-secondary">
                    <t>Clear All Filter</t>
                </button>
            </div>
        </div>
    </t>
 
    <t t-name="SubSectionPetty">
        <div class="pl-table-div show">
            <table class="table table-sm o_main_table"
                   style="border: 0px solid black;display compact;">
                <thead>
                    <tr style="">
                        <th style="width:32%">Entry Label</th>
                        <th>Voucher</th>
                        <th>Account</th>
                        <!-- <th style="text-align:right;">Taxes</th> -->
                        <!-- <th style="text-align:right;">Price</th> -->
                        <th style="text-align:right;">Total</th>
                    </tr>
                </thead>
                <tbody>
                    <t t-set="virtual_balance" t-value="0"/>
                    <t t-set="virtual_expenses" t-value="0"/>
                    <t t-set="balance" t-value="0"/>   
                    <t t-foreach="account_data" t-as="account_line">

                        <t t-set="style" t-value="'text-align:right;'"/>
                        <t t-set="styleleft" t-value="'text-align:left;'"/>
                        <tr>
                            <td>
                                <t t-if="account_line.description">
                                    <div class="dropdown dropdown-toggle">
                                        <a data-toggle="dropdown" href="#">
                                            <span class="caret"></span>
                                            <span>
                                                <t t-esc="account_line.description"/>
                                            </span>
                                        </a>
                                        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
                                            <li>
                                                <a class="view-account-move" tabindex="-1" href="#" t-att-data-move-id="account_line.move_id">
                                                    View Source move
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </t>
                            </td>
                            <td>
                                <span>
                                    <t t-esc="account_line.voucher_name"/>
                                </span>
                            </td>
                            <td t-att-style="styleleft">
                                <t t-esc="account_line.account_name"/>
                            </td>

                            <t t-if="account_line.currency_position == 'before'">
                                <!-- <td t-att-style="style" class="amt">
                                    <t t-raw="account_line.currency_code"/>
                                    <t t-raw="account_line.taxes"/>

                                </td>
                                <td t-att-style="style" class="amt">
                                    <t t-raw="account_line.currency_code"/>
                                    <t t-raw="account_line.price"/>

                                </td> -->
                                <td t-att-style="style" class="amt">
                                    <t t-raw="account_line.currency_code"/>
                                    <t t-raw="account_line.total"/>
                                </td>

                            </t>
                            <t t-else="">
                                <!-- <td t-att-style="style" class="amt">
                                    <t t-raw="account_line.taxes"/>
                                    <t t-raw="account_line.currency_code"/>
                                </td>
                                <td t-att-style="style" class="amt">
                                    <t t-raw="account_line.price"/>
                                    <t t-raw="account_line.currency_code"/>
                                </td> -->
                                <td t-att-style="style" class="amt">
                                    <t t-raw="account_line.total"/>
                                    <t t-raw="account_line.currency_code"/>
                                </td>

                            </t>
                        </tr>
                    </t>

                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" style="padding-left: 50px;">
                            Total Expenses
                        </td>
 
                        <td style="text-align:right;">
                            
                            <t t-if="currency_position == 'before'">
                                <t t-esc="currency[0]"/>
                                <t t-esc="virtual_expenses"/>
                            </t>
                            <t t-else="">
                                <t t-esc="virtual_expenses"/>
                                <t t-esc="currency[0]"/>
                            </t>
                            
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="padding-left: 50px;">
                            Virtual Balance
                        </td>
 
                        <td style="text-align:right;"  class="amt">
                            <t t-if="currency_position == 'before'">
                                <t t-esc="currency[0]"/>
                                <t t-esc="virtual_balance"/>
                            </t>
                            <t t-else="">
                                <t t-esc="virtual_balance"/>
                                <t t-esc="currency[0]"/>
                            </t>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="padding-left: 50px;">
                            Balance
                        </td>
 
                        <td style="text-align:right;"  class="amt">
                            <t t-if="currency_position == 'before'">
                                <t t-esc="currency[0]"/>
                                <t t-esc="balance"/>
                            </t>
                            <t t-else="">
                                <t t-esc="balance"/>
                                <t t-esc="currency[0]"/>
                            </t>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </t>

</template>



                    




