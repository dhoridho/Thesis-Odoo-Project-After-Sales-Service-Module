<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="stock_valuation_layer_tree" model="ir.ui.view">
        <field name="name">stock.valuation.layer.tree</field>
        <field name="model">stock.valuation.layer</field>
        <field name="inherit_id" ref="equip3_inventory_base.stock_valuation_layer_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_revaluation']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>

    <record id="stock_valuation_layer_form" model="ir.ui.view">
        <field name="name">stock.valuation.layer.form</field>
        <field name="model">stock.valuation.layer</field>
        <field name="inherit_id" ref="equip3_inventory_base.stock_valuation_layer_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='other_info']/group[1]/field[@name='stock_valuation_layer_id']" position="after">
        		<field name="sale_id" attrs="{'invisible': [('sale_id', '=', False)]}"/>
                <field name="picking_id" attrs="{'invisible': [('picking_id', '=', False)]}"/>
                <field name="stock_move_type" invisible="1"/>
        	</xpath>

            <xpath expr="//field[@name='remaining_qty']" position="attributes">
                <attribute name="attrs">{'invisible': [('product_cost_method', 'not in', ('fifo', 'average'))]}</attribute>
            </xpath>

            <xpath expr="//field[@name='remaining_qty']" position="after">
                <field name="product_cost_method" invisible="1"/>
                <field name="standard_remaining_qty" attrs="{'invisible': [('product_cost_method', '!=', 'standard')]}" string="Remaining Qty"/>
            </xpath>

            <xpath expr="//page[@name='lines']//field[@name='lot_id']" position="before">
                <field name="stock_move_id" invisible="1"/>
                <field name="stock_move_source_id" invisible="1"/>
                <field name="picking_id"/>
                <field name="picking_source_id" string="Source Receiving Notes" optional="hide"/>
            </xpath>
            <xpath expr="//page[@name='lines']//field[@name='remaining_qty']" position="attributes">
                <attribute name="attrs">{'column_invisible': [('parent.product_cost_method', 'not in', ('fifo', 'average'))]}</attribute>
            </xpath>
            <xpath expr="//page[@name='lines']//field[@name='remaining_qty']" position="after">
                <field name="standard_remaining_qty" optional="hide" attrs="{'column_invisible': [('parent.product_cost_method', '!=', 'standard')]}" string="Remaining Qty"/>
            </xpath>
        </field>
    </record>

    <record id="stock_valuation_layer_source_form" model="ir.ui.view">
        <field name="name">stock.valuation.layer.source.form</field>
        <field name="model">stock.valuation.layer.source</field>
        <field name="inherit_id" ref="equip3_inventory_operation.stock_valuation_layer_form"/>
        <field name="mode">primary</field>
        <field name="arch" type="xml">
            <xpath expr="//form" position="inside">
                <field name="svl_id" invisible="1"/>
            </xpath>
        </field>
    </record>

    <!-- add empty context to remove default groupby -->
    <record id="stock_account.stock_valuation_layer_action" model="ir.actions.act_window">
        <field name="context">{}</field>
    </record>

</odoo>
