<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="invoice_subtotal_tem_custom" inherit_id="general_template.invoice_subtotal_tem">
        <xpath expr="//div[@class='clearfix']/table[@class='pull-right']" position="replace">
            <table class="pull-right" t-att-style="'font-weight:bold; text-transform:capitalize; color: '+ text_color">
                <tr>
                    <td class="left" colspan="2" t-att-style="'padding:9px 10px 7px 0px;'">SubTotal</td>
                    <td align="right" tyle="padding:9px 0px 7px 10px;">
                        <span t-field="o.amount_untaxed" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                    </td>
                </tr>
                <tr>
                    <td colspan="3" style="border-bottom:1px solid #959595"/>
                </tr>
                <t t-as="amount_by_group" t-foreach="o.amount_by_group">
                    <tr >
                        <t t-if="len(o.line_ids.filtered(lambda line: line.tax_line_id)) == 1 and o.amount_untaxed == amount_by_group[2]">
                            <td class="left" colspan="2" t-att-style="'padding:9px 10px 7px 0px;'"><span t-esc="amount_by_group[0]"/></td>
                            <td align="right" tyle="padding:9px 0px 7px 10px;">
                                <span t-esc="amount_by_group[3]" />
                            </td>
                        </t>
                        <t t-else="">
                            <td class="left" colspan="2" t-att-style="'padding:9px 10px 7px 0px;'">
                                <span t-esc="amount_by_group[0]"/>
                            </td>
                            <td align="right" tyle="padding:9px 0px 7px 10px;">
                                <span t-esc="amount_by_group[3]"/>
                            </td>
                        </t>
                    </tr>
                </t>
                <tr>
                    <td colspan="3" style="border-bottom:1px solid #959595"/>
                </tr>
                <tr id="total">
                    <td class="left" colspan="2" t-att-style="'padding:9px 10px 7px 0px;  text-transform:uppercase; '">Total</td>
                    <td align="right" style="padding:9px 0px 7px 10px;text-transform:uppercase; ">
                        <span t-field="o.amount_total" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                    </td>
                </tr>
                <tr t-if="o.amount_residual">
                    <td class="left" colspan="2" t-att-style="'padding:9px 10px 7px 0px; text-transform:capitalize; ' ">
                        <span t-if="o.move_type in ('out_refund', 'in_refund')">Credit Amount</span>
                        <span t-if="o.move_type in ('out_invoice', 'in_invoice')">Amount Due</span>
                    </td>
                    <td align="right" style="padding:9px 0px 7px 0px;text-transform:capitalize; ">
                        <span t-field="o.amount_residual" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                    </td>
                </tr>
            </table>
        </xpath>
    </template>
</odoo>
