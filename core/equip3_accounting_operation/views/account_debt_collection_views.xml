<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
       <record id="view_account_debt_collection_tree" model="ir.ui.view">
            <field name="name">account.debt.collection.tree</field>
            <field name="model">account.debt.collection</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="currency_id" invisible='1'/>
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="date"/>
                    <field name="amount" string="Total Collection Amount" />
                    <field name="start_date" invisible='1'/>
                    <field name="end_date"/>
                    <field name="deadline_date"/>
                </tree>
            </field>
        </record>

        <record id="view_account_debt_collection_form" model="ir.ui.view">
            <field name="name">account.debt.collection.form</field>
            <field name="model">account.debt.collection</field>
            <field name="arch" type="xml">
                <form string="Multi Payment">                
                    <header>
                        <field name="is_pic" invisible="1"/>
                        <button string="Confirm" name="action_confirm" type="object" class="oe_highlight" attrs="{'invisible': [('state', '!=', 'draft')]}"/>
                        <button string="Register Payment" name="action_register_payment" type="object" class="oe_highlight" attrs="{'invisible': ['|',('state', '!=', 'on_progress'),('is_pic', '=', False)]}"/>
                        <button string="Cancel" name="action_cancel" type="object" class="oe_highlight" attrs="{'invisible': ['|',('state', '=', 'canceled'),('is_pic', '=', False)]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,on_progress,wait_for_payment,done"/>
                    </header>
                    <sheet>
                        <field name="currency_id" invisible='1'/>
                        <div class="oe_title">
                            <h1>
                                <span attrs="{'invisible': [('state', '!=', 'draft')]}">Draft</span>
                            </h1>
                            <h1 class="mt0" attrs="{'invisible':[('name', '=', False)]}">
                                <field name="name"/>
                            </h1>
                        </div>

                        <group>
                            <group id="header_left_group">
                                <field name="partner_id" attrs="{'readonly': [('state', '!=', 'draft')]}" domain="[('is_customer','=',True)]"/>
                                <field name="date"  attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="person_in_charge" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="amount" string="Total Collection Amount"/>
                                <field name="create_uid" string="Created By"/>
                                <field name="create_date" string="Created Date"/>
                            </group>
                            <group id="header_right_group">
                                <!-- <field name="start_date" invisible="1" attrs="{'readonly': [('state', '!=', 'draft')]}"/> -->
                                <field name="end_date" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="deadline_date" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                               
                            </group>
                        </group>
                        <notebook>
                            <page name="line_debt_collection_ids" string="Debt Collection Line">
                                <field name="line_debt_collection" force_save="1">
                                    <tree editable="Bottom" string="Debt Collection Line" delete="false">
                                        <field name="invoice_id" force_save="1"/>
                                        <field name="invoice_date" force_save="1" />
                                        <field name="amount_invoice" force_save="1" sum="Total Invoice Amount" />
                                        <field name="amount_residual" force_save="1" sum="Total Debt Amount Due" />
                                        <field name="state" force_save="1" />
                                        <field name="is_pic_line" invisible="1" />
                                        <field name="journal_id" force_save="1" attrs="{'readonly': [('is_pic_line', '=', False)]}"/>
                                        <field name="date" force_save="1" required="1" attrs="{'readonly': [('is_pic_line', '=', False)]}"/>
                                        <field name="amount" force_save="1" attrs="{'readonly': [('is_pic_line', '=', False)]}" sum="Total Collection Amount" />
                                        <field name="is_full_collect" force_save="1" attrs="{'readonly': [('is_pic_line', '=', False)]}" />
                                        <field name="payment_id" optional="hide" force_save="1" attrs="{'readonly': [('is_pic_line', '=', False)]}"/>
                                        <field name="currency_id" optional="hide" force_save="1" attrs="{'readonly': [('is_pic_line', '=', False)]}"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>           
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>                    
                </form>
            </field>
        </record>


        <record id="action_account_debt_collection" model="ir.actions.act_window">
            <field name="name">Debt Collection</field>
            <field name="res_model">account.debt.collection</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="context"></field>
            <field name="domain"></field>
            <field name="view_id" ref="view_account_debt_collection_tree"/>            
        </record>

        <menuitem action="equip3_accounting_operation.action_account_debt_collection" id="menu_action_account_debt_collection" groups="account.group_account_readonly" parent="account.menu_finance_receivables"/>
    </data>
</odoo>