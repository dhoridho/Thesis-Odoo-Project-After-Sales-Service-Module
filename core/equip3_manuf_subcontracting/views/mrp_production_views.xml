<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="view_mrp_production_form_subcon" model="ir.ui.view">
        <field name="name">view.mrp.production.form.subcon</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="equip3_manuf_account.view_mrp_production_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='move_finished_ids']/tree" position="inside">
                <field name="subcon_is_finished_good" invisible="1"/>
            </xpath>

            <xpath expr="//header/button[@name='button_plan']" position="after">
                <field name="can_be_subcontracted" invisible="1"/>
                <field name="is_subcontracted" invisible="1"/>
                <button name="action_subcontracting" string="Subcontracting" class="oe_highlight" type="object" attrs="{'invisible':['|', '|', ('state', '!=', 'confirmed'), ('can_be_subcontracted', '=', False), ('is_subcontracted', '=', True)]}"/>
            </xpath>
            
            <xpath expr="//div[@name='button_box']" position="inside">
                <button type="object" name="action_view_pr_subcon_pending" class="oe_stat_button" icon="fa-truck" attrs="{'invisible': [('subcon_pr_pending_count', '=', 0)]}">
                    <field name="subcon_pr_pending_count" widget="statinfo" string="Subcon Pending"/>
                </button>
                <button type="object" name="action_view_po_subcon_pending" class="oe_stat_button" icon="fa-truck" attrs="{'invisible': [('subcon_po_pending_count', '=', 0), ('subcon_count', '=', 0)]}">
                    <field name="subcon_po_pending_count" widget="statinfo" string="Subcon Pending" attrs="{'invisible': [('subcon_po_pending_count', '=', 0)]}"/>
                    <field name="subcon_count" widget="statinfo" string="Subcontracting" attrs="{'invisible': [('subcon_count', '=', 0)]}"/>
                </button>
                <button type="object" name="action_view_purchase_requisition" class="oe_stat_button" icon="fa-truck" attrs="{'invisible': [('subcon_requisition_count', '=', 0)]}">
                    <field name="subcon_requisition_count" widget="statinfo" string="Blanket Order"/>
                </button>
            </xpath>
            
        </field>
    </record>
    
</odoo>