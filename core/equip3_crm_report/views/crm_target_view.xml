<?xml version="1.0"?>
<odoo>
    <record id="crm_target_report_tree_view" model="ir.ui.view">
        <field name="name">crm.target.report.tree.view</field>
        <field name="model">crm.target</field>
        <field name="type">tree</field>
        <field name="mode">primary</field>
        <field name="inherit_id" ref="equip3_crm_operation.crm_target_tree_view"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='state']" position="before">
                <field name="percentage_target"/>
            </xpath>
        </field>
    </record>

    <record id="crm_target_graph_view" model="ir.ui.view">
        <field name="name">crm.target.graph.view</field>
        <field name="model">crm.target</field>
        <field name="type">graph</field>
        <field name="arch" type="xml">
            <graph string="Target Report" type="bar">
                <field name="salesperson_id"/>
                <field name="main_target" operator="+"/>
                <field name="current_achievement" operator="+"/>
            </graph>
        </field>
    </record>

    <record id="crm_target_pivot_view" model="ir.ui.view">
        <field name="name">crm.target.pivot.view</field>
        <field name="model">crm.target</field>
        <field name="type">pivot</field>
        <field name="arch" type="xml">
            <pivot string="Target Report">
                <field name="salesperson_id" type="row"/>
                <field name="created_on" interval="month" type="col"/>
                <field name="main_target" type="measure"/>
                <field name="current_achievement" type="measure"/>
                <field name="percentage_target" type="measure"/>
            </pivot>
        </field>
    </record>

    <record id="crm_target_report_search_view" model="ir.ui.view">
        <field name="name">crm.target.report.search.view</field>
        <field name="model">crm.target</field>
        <field name="arch" type="xml">
            <search string="Search My Target">
                <field name="salesperson_id"/>
                <field name="sale_team_id"/>
                <field name="team_leader_id"/>
                <separator/>
                <filter name="approved" string="Approved" domain="[('state','=','approved')]"/>
                <filter name="rejected" string="Rejected" domain="[('state','=','rejected')]"/>
                <group expand="0" string="Group By...">
                    <filter string="Salesperson" name="salesperson" domain="[]" context="{'group_by':'salesperson_id'}" />
                    <filter string="Sale Team" name="sale_team" domain="[]" context="{'group_by':'sale_team_id'}" />
                    <filter string="Team Leader" name="team_leader" domain="[]" context="{'group_by':'team_leader_id'}" />
                </group>
                <searchpanel view_types="tree,kanban,pivot,graph">
                    <field name="sale_team_id"/>
                    <field name="salesperson_id" string="Assigned To"/>
                    <field name="company_id" groups="base.group_multi_company" icon="fa-building"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <record id="equip3_crm_operation.action_crm_target" model="ir.actions.act_window">
        <field name="search_view_id" ref="equip3_crm_report.crm_target_report_search_view"/>
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('equip3_crm_operation.crm_target_tree_view')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('equip3_crm_operation.crm_target_form_view')})]"/>
    </record>

    <record id="action_report_crm_target" model="ir.actions.act_window">
        <field name="name">Target Report</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">crm.target</field>
        <field name="domain">[('state', '=', 'approved')]</field>
        <field name="view_mode">graph,pivot,tree</field>
        <field name="search_view_id" ref="equip3_crm_report.crm_target_report_search_view"/>
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'graph', 'view_id': ref('equip3_crm_report.crm_target_graph_view')}),
                (0, 0, {'view_mode': 'pivot', 'view_id': ref('equip3_crm_report.crm_target_pivot_view')}),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('equip3_crm_report.crm_target_report_tree_view')})]"/>
    </record>

    <menuitem id="menu_report_crm_target"
              name="Target Report"
              parent="crm.crm_menu_report"
              action="action_report_crm_target"
              sequence="5"/>
</odoo>