<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-extend="OrderChangeReceipt">
    	<t t-jquery="div:first" t-operation="attributes">
             <attribute name="class" value="pos-receipt OrderChangeReceipt pos-receipt-custom_template" />
             <attribute name="t-attf-style" value="{{ 'width:'+ changes.receipt_template.width +';' }}" />
             <attribute name="t-attf-id" value="{{ changes.receipt_template.element_id }}" />
        </t>
        <t t-jquery="div[class='pos-receipt-order-data']" t-operation="before">
            <div class="change-receipt-header1">
                <div class="change-receipt-floor-table"><t t-esc="changes.floor"/> / <t t-esc="changes.table"/></div>
                <div class="change-receipt-ticket_number">Ticket No : <t t-esc="changes.ticket_number"/></div>

                <t t-if="changes.receipt_type == 'dine-in'">
                	<div class="change-receipt-order_type">**DINE-IN**</div>
                </t>
                <t t-if="changes.receipt_type == 'takeaway'">
                	<div class="change-receipt-order_type">**TAKEAWAY**</div>
                </t>
            </div>

            <div class="change-receipt-separator"></div>

            <div class="change-receipt-header2">
                <div class="change-receipt-no_order">No Order: <t t-esc="changes.name"/></div>
                <div class="change-receipt-date">Date: 
                    <span><t t-esc="moment().format('DD/MM/YY')"/> <t t-esc="changes.time.hours"/>:<t t-esc="changes.time.minutes"/></span>
                </div>
                <div class="change-receipt-server">Server: <t t-esc="changes.user"/></div>
            </div>

            <div class="change-receipt-separator"></div>

            <div class="change-receipt-items">
            	<t t-set="total_item" t-value="0"/>
		            <t t-if="changes.cancelled.length > 0">
		                <div class="pos-order-receipt-cancel">
		                    <!-- <div class="pos-receipt-title">
		                        CANCELLED
		                        <t t-esc='changes.time.hours'/>:<t t-esc='changes.time.minutes'/>
		                    </div>
		                    <br />
		                    <br /> -->
            				<t t-set="total_item" t-value="0"/>
		                    <t t-foreach="changes.cancelled" t-as="change">
            					<t t-set="total_item" t-value="total_item + change.qty"/>

		                        <div class="change-receipt-orderline">
		                            <span class="change-receipt-orderline-qty"><t t-esc="change.qty"/>X </span>
		                            <span class="change-receipt-orderline-name">
			                            <span t-esc="change.name_wrapped[0]" class="pos-receipt-right-align"/>
			                        	<t t-call="NameWrapped"/>
		                            </span>
		                        </div>

		                        <div class="change-modifiers">
			                        <t t-if="change.modifiers">
						                <t t-foreach="change.modifiers" t-as="modifier">
						                    <div class="combo_item">
						                        <span> - </span>
						                        <t t-esc="modifier"/>
						                        <span> : </span>
						                        <t t-esc="change.modifiers[modifier]"/>
						                    </div>
						                </t>
						            </t>
						            <t t-if="change.combo_items">
						                <t t-foreach="change.combo_items" t-as="combo_item">
						                    <div class="combo_item">
						                        <t t-esc="combo_item.quantity"/>
						                        <span> x </span>
						                        <span t-esc="combo_item.product_id[1]"/>
						                    </div>
						                    <t t-if="combo_item.modifiers">
						                        <t t-foreach="combo_item.modifiers" t-as="modifier" t-key="modifier">
						                            <div class="combo_item">
						                                <span> - </span>
						                                <t t-esc="modifier"/>
						                                <span> : </span>
						                                <t t-esc="combo_item.modifiers[modifier]"/>
						                            </div>
						                        </t>
						                    </t>
						                </t>
						            </t>
		                        </div>

		                        <t t-if="change.note">
		                            <div class="change-receipt-note">
		                            	<div>
			                                NOTE
			                                <span class="pos-receipt-right-align">...</span>
			                            </div>
			                            <div><span class="pos-receipt-left-padding">--- <t t-esc="change.note" /></span></div>
		                            </div>
		                        </t>
		                    </t>
		                </div>
		            </t>
		            <t t-if="changes.new.length > 0">
		                <!-- <div class="pos-receipt-title">
		                    NEW
		                    <t t-esc='changes.time.hours'/>:<t t-esc='changes.time.minutes'/>
		                </div>
		                <br />
		                <br /> -->

            			<t t-set="total_item" t-value="0"/>
		                <t t-foreach="changes.new" t-as="change">
							<t t-set="total_item" t-value="total_item + change.qty"/>
		                    <div class="change-receipt-orderline">
	                            <span class="change-receipt-orderline-qty"><t t-esc="change.qty"/>X </span>
	                            <span class="change-receipt-orderline-name">
		                            <span t-esc="change.name_wrapped[0]" class="pos-receipt-right-align"/>
		                        	<t t-call="NameWrapped"/>
	                            </span>
		                    </div>

	                        <div class="change-modifiers">
		                        <t t-if="change.modifiers">
					                <t t-foreach="change.modifiers" t-as="modifier">
					                    <div class="combo_item">
					                        <span> - </span>
					                        <t t-esc="modifier"/>
					                        <span> : </span>
					                        <t t-esc="change.modifiers[modifier]"/>
					                    </div>
					                </t>
					            </t>
					            <t t-if="change.combo_items">
					                <t t-foreach="change.combo_items" t-as="combo_item">
					                    <div class="combo_item">
					                        <t t-esc="combo_item.quantity"/>
					                        <span> x </span>
					                        <span t-esc="combo_item.product_id[1]"/>
					                    </div>
					                    <t t-if="combo_item.modifiers">
					                        <t t-foreach="combo_item.modifiers" t-as="modifier" t-key="modifier">
					                            <div class="combo_item">
					                                <span> - </span>
					                                <t t-esc="modifier"/>
					                                <span> : </span>
					                                <t t-esc="combo_item.modifiers[modifier]"/>
					                            </div>
					                        </t>
					                    </t>
					                </t>
					            </t>
	                        </div>

		                    <t t-if="change.note">
		                        <div class="change-receipt-note">
			                        <div>
			                            NOTE
			                            <span class="pos-receipt-right-align">...</span>
			                        </div>
			                        <div><span class="pos-receipt-left-padding">--- <t t-esc="change.note" /></span></div>
			                    </div>
		                    </t>
		                </t>
		            </t>
            </div>
            <div class="change-receipt-total_items">Total Items: <t t-esc="total_item"/></div>
            <div class="change-receipt-company_name"><t t-esc="changes.company.name"/></div>
        </t>
    </t>

</templates>