<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_rental_order_tree" model="ir.ui.view">
        <field name="name">rental.order.line.form.inherit</field>
        <field name="model">rental.order.line</field>
        <field name="inherit_id" ref="browseinfo_rental_management.view_rental_order_line_form" />
        <field name="arch" type="xml">
            <xpath expr="//sheet/group" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//sheet" position="inside">
                <group name="rental_line">
                    <group name="product_information">
                        <field name="lot_id" required="1" context="{'from_lot_search':True}"
								   domain="[('product_id.rent_ok','=',True), ('is_available_today', '=', True)]" />
                        <field name="com_avail" invisible="1" />
                        <field name="lot_avail_ids" widget="many2many_tags" invisible="1"/>
                        <field name="product_categ_id"
                                readonly="1" />
                        <field name="product_id"
                                domain="[('rent_ok','=',True),('categ_id','=', product_categ_id)]"
                                readonly="1" />
                        <field name="price_unit" readonly="1"/>
                        <field name="tax_id" widget="many2many_tags"/>
                        <field name="name" invisible="1"/>
                        <field name="price_subtotal" invisible="1" />
                        <field name="price_total" invisible="1" />
                        <field name="price_tax" invisible="1" />
                        <div groups="base.group_no_one" invisible="1">
                            <label for="invoice_lines" />
                            <field name="invoice_lines" invisible="1" />
                        </div>
                    </group>
                </group>
            </xpath>
        </field>
    </record>


    <record id="view_rental_order_tree_inherit" model="ir.ui.view">
        <field name="name">rental.order.line.tree.inherit</field>
        <field name="model">rental.order.line</field>
        <field name="inherit_id" ref="browseinfo_rental_management.view_rental_order_line_tree" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="replace">
                <field name="product_id"/>
            </xpath>
            <xpath expr="//field[@name='lot_id']" position="after">
                <field name="partner_shipping_id_new" attrs="{'column_invisible': [('parent.is_single_delivery_address', '=', True)]}" />
            </xpath>
        </field>
    </record>

    <record id="view_rental_order_tree_inherited" model="ir.ui.view">
        <field name="name">rental.order.tree.inherited</field>
        <field name="model">rental.order</field>
        <field name="inherit_id" ref="browseinfo_rental_management.view_rental_order_tree"/>
        <field name="arch" type="xml">
            <field name="agrement_ok" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="state" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="state" position="after">
                <field name="state" 
                    widget="badge" 
                    decoration-info="state == 'draft'" 
                    decoration-success="state == 'confirm'" 
                    decoration-warning="state == 'running'" 
                    decoration-muted="state == 'close'"/>
            </field>
        </field>
    </record>

    <record model="ir.ui.view" id="view_rental_order_kanban">
        <field name="name">rental.order.kanban</field>
        <field name="model">rental.order</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile" sample="1">
                <field name="name"/>
                <field name="partner_id"/>
                <field name="amount_total"/>
                <field name="date_order"/>
                <field name="state"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                            <div class="o_kanban_record_top mb16">
                                <div class="o_kanban_record_headings mt4">
                                    <strong class="o_kanban_record_title"><span><t t-esc="record.partner_id.value"/></span></strong>
                                </div>
                                <strong>Rp <field name="amount_total" widget="monetary"/></strong>
                            </div>
                            <div class="o_kanban_record_bottom">
                                <div class="oe_kanban_bottom_left d-block">
                                    <p class="text-muted"><t t-esc="record.name.value"/></p>
                                    <p><field name="date_order" class="text-muted"/></p>
                                </div>
                                <div class="oe_kanban_bottom_right d-block text-right">
                                    <field name="state"
                                        widget="badge"
                                        decoration-primary="state == 'draft'"
                                        decoration-warning="state == 'running'"
                                        decoration-success="state== 'confirm'"
                                        decoration-mute="state == 'close'"
                                    />
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="view_rental_order_filter" model="ir.ui.view">
            <field name="name">rental.order.list.select</field>
            <field name="model">rental.order</field>
            <field name="priority" eval="15"/>
            <field name="arch" type="xml">
                <search string="Search Rental Order">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="rental_line" string="Product" filter_domain="[('rental_line.product_id', 'ilike', self)]"/>
                    <filter string="This Month" name="this_month"
                        domain="[('date_order', '&gt;=', context_today().strftime('%%Y-%%m-01'))]"/>
                    <filter string="Last 6 Months" name="6months"
                        domain="[('date_order','&gt;=',(context_today()-relativedelta(months=5)).strftime('%Y-%m-01'))]"/>
                    <separator/>    
                    <filter string="My Orders" name="my_orders" domain="[('user_id', '=', uid)]"/>
                    <separator/>
                    <filter string="Create Date" name="filter_create_date" date="create_date"/>
               </search>
            </field>
    </record>

    <record id="view_rental_order_form" model="ir.ui.view">
        <field name="name">rental.order.inherit.form</field>
        <field name="model">rental.order</field>
        <field name="inherit_id" ref="browseinfo_rental_management.view_rental_order_form" />
        <field name="arch" type="xml">
            <field name="state" position="attributes">
                <attribute name="statusbar_visible">draft,waiting,confirm,running,close,canceled</attribute>
                <attribute name="invisible">1</attribute>
            </field>
           <field name="state" position="after">
                <field name="state_default" widget="statusbar" statusbar_visible="draft,waiting,confirm,running,close,canceled" align="right" readonly="1" attrs="{'invisible':[('state','in', ['confirm', 'running', 'close', 'canceled', 'rejected'])]}"/>
                <field name="state_need_approval_hide_waiting" widget="statusbar" statusbar_visible="draft,confirm,running,close,canceled" align="right" readonly="1" attrs="{'invisible':[('state','in', ['draft', 'waiting', 'confirm', 'rejected'])]}"/>
                <field name="state_confirmed" widget="statusbar" statusbar_visible="draft,confirm,running,close,canceled" align="right" readonly="1" attrs="{'invisible':[('state','!=', 'confirm')]}"/>
                <field name="state_rejected" widget="statusbar" statusbar_visible="draft,rejected" align="right" readonly="1" attrs="{'invisible':[('state','!=', 'rejected')]}"/>
            </field>
            <field name="renew_date" position="after">
                <field name="currency_id" readonly="0"/>
                <field name="amount" attrs="{'required':[('is_need_deposit','=',True)],'invisible':[('is_need_deposit','=',False)],'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}" />
                <field name="invoice_deposit_received" invisible="1"/>
                <field name="is_invoice_deposit_return" invisible="1"/>
                <field name="is_checking" invisible="1"/>
                <field name="is_return" invisible="1"/>
                <field name="is_intercompany_transaction"/>
                <field name="is_rental_order_approval_matrix" invisible="1" />
            </field>
            <field name="pricelist_id" position="attributes">
                <attribute name="invisible">1</attribute>
                <attribute name="required">0</attribute>
            </field>
            <field name="partner_id" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="partner_invoice_id" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
                <attribute name="domain">['|', ('id', '=', partner_id), ('parent_id', '=', partner_id)]</attribute>
            </field>
            <field name="partner_shipping_id" position="attributes">
                <attribute name="invisible">1</attribute>
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="partner_shipping_id" position="after">
                <label for="partner_shipping_id">Deliery Address</label>
                <div class="o_row mt-2" name="delivery_address">
                    <field name="is_single_delivery_address" nolabel="1" style="margin-top: 2px;"/>
                    <span>Single Delivery Address</span>
                </div>
                <field name="partner_shipping_id" nolabel="1"
                       attrs="{'invisible': [('is_single_delivery_address', '=', False)]}"
                       domain="['|', ('id', '=', partner_id), ('parent_id', '=', partner_id)]" />
            </field>
            <field name="rental_initial" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="rental_initial_type" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="start_date" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <xpath expr="//label[@for='rental_bill_freq']" position="before">
                <field name="is_reccuring_invoice"/>
                <field name="is_need_deposit" string="Need Deposit ?"/>

            </xpath>
            <xpath expr="//label[@for='rental_bill_freq']" position="attributes">
                <attribute name="attrs">{'invisible': [('is_reccuring_invoice', '=', False)]}</attribute>
            </xpath>
            <field name="rental_bill_freq" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))],'invisible': [('is_reccuring_invoice', '=', False)]}</attribute>
            </field>
            <field name="rental_bill_freq_type" position="before">
                <field name="new_rental_bill_freq_type" nolabel="1" attrs="{'readonly': [('state', 'in', ('confirm', 'close', 'running'))],'invisible': [('is_reccuring_invoice', '=', False)]}"/>
            </field>
            <field name="rental_bill_freq_type" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
            <field name="date_order" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="client_order_ref" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="agrement_ok" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="warehouse_id" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
                <attribute name="domain">[('branch_id', '=', branch_id),('company_id','=',company_id)]</attribute>
            </field>
            <field name="warehouse_id" position="before">
                <field name="branch_id" required="1"/>
            </field>
            <field name="pricelist_id" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>

            <field name="rental_line" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="sale_line" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="origin" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="user_id" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="company_id" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <field name="picking_ids" position="attributes">
                <attribute name="attrs">{'readonly': [('state', 'in', ('confirm', 'close', 'running'))]}</attribute>
            </field>
            <xpath expr="//page[last()]" position="after">
                <page string="Extend Record" name="extend_record">
                    <group string="Extended History">
                        <field name="rental_extend_id" nolabel= "1">
                            <tree create="false" edit="false" delete="false">
                                <field name="start_date"/>
                                <field name="end_date"/>
                                <field name="extend_term_and_type"/>
                                <field name="amount_untaxed"/>
                                <field name="amount_tax"/>
                                <field name="amount_total"/>
                                <field name="state"/>
                                <button name="display_extend" type="object" string="Details" class="btn-primary"/>
                                <button name="confirm_extend" type="object" string="Confirm" class="btn-primary" attrs="{'invisible': True}"/>
                                <button name="reject_extend" type="object" string="Reject" class="btn-outline-success" attrs="{'invisible': True}"/>
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>
            <xpath expr="//field[@name='end_date']" position="after">
                <field name="final_end_date" widget="datetime" force_save="1" readonly="1"/>
            </xpath>
            <xpath expr="//field[@name='final_end_date']" position="after">               
                <label for="is_expiry_date" invisible='1'/>
                <div class="o_row" name="default_expiry_date">
                    <field name="is_expiry_date" style="margin-top: 2px" nolabel="1"/>
                    <span>Use end date as expiry date</span>
                </div>
            </xpath>
            <xpath expr="//field[@name='is_reccuring_invoice']" position="before">
                <field name="expiry_date" widget="datetime" force_save="1" attrs="{'invisible': [('is_expiry_date', '=', True)]}"/>
            </xpath>
            <xpath expr="//field[@name='partner_id']/../.." position="attributes">
                <attribute name="class">d-none</attribute>
            </xpath>
            <xpath expr="//field[@name='partner_invoice_id']" position="before">
                <field name="partner_id" position="move"/>
                <field name="rental_closed" invisible="1"/>
            </xpath>
            <xpath expr="//header" position="after">
                <header>
                    <field name="state2" widget="statusbar" statusbar_visible="pending,picked,returned" align="right" readonly="1" attrs="{'invisible':[('state','in',['draft', 'rejected'])]}"/>
                </header>
            </xpath>
            <xpath expr="//header" position="inside">
                <button name="action_deposite_return"
                    string="Deposit Return"
                    class="oe_highlight"
                    attrs="{'invisible':['|', ('is_invoice_deposit_return','=',True), ('invoice_deposit_received','=',False)]}"
                    type="object"/>
                <button name="action_deposite_receive"
                    string="Deposit Receive" 
                    class="oe_highlight"
                    attrs="{'invisible':['|','|',('state', 'in', ('draft', 'close')),('is_hide_deposit','=',True),('is_need_deposit','=',False)]}"
                    type="object"/>
                <button name="action_close_rental"
                    string="Close Rental" 
                    class="oe_highlight"
                    attrs = "{'invisible': ['|', ('state2', '!=', 'returned'), ('rental_closed', '=', True)]}"
                    type="object"/>
<!--                attrs = "{'invisible' : [('state', 'not in', ('confirm', 'running'))]}"-->

                <button name="action_return"
                    string="Return" 
                    class="oe_highlight"
                    type="object"
                    attrs = "{'invisible' : ['|', ('state', '!=', 'running'), ('is_return', '=', True)]}"
                    />
                <button name="action_button_checking_rental"
                    string="Checking" class="oe_highlight" type="object" invisible="1"/>
                
                <button name="action_open_cancel_wizard"
                    string="Cancel Rental" 
                    class="oe_highlight"
                    type="object"
                    attrs = "{'invisible' : [('state', 'not in', ['confirm'])]}"
                    />
            </xpath>
            <xpath expr="//div[@name='button_box']//button[@name='action_view_invoice_rental']" position="before">
                <button name="action_view_invoice_rental_extend" type="object"
                        class="oe_stat_button" icon="fa-pencil-square-o"
                        attrs="{'invisible': [('extend_invoice_count', '=', 0)]}">
                    <field name="extend_invoice_count" widget="statinfo" string="Extend Invoices" />
                </button>
            </xpath>

            <xpath expr="//div[@name='button_box']" position="inside">
                <button icon="o-hm-smart-crm-cost-revenue" class="oe_stat_button"
                    name="%(action_deposit_invoice)d"
                    type="action" attrs="{'invisible': [('count_deposit', '=', 0)]}">
                    <field name="count_deposit" string="Deposit"
                        widget="statinfo"/>
                </button>
            </xpath>
            <xpath expr="//notebook/page[3]" position="after">
                <page string="Checklist">
                    <group invisible="1">
                        <group>
                            <field name="is_checking" invisible="1"/>
                            <field name="is_verified" invisible="1"/>
                            <field name="is_in_validate" invisible="1"/>
                            <field name="attachment_ids" widget="many2many_binary" class="oe_inline" attrs="{'readonly': [('is_verified', '=', True)]}" invisible="1"/>
                        </group>
                        <group>
                            <field name="damage_order_cost" invisible="1" force_save="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="missing_cost" string="Missing Cost">
                            <group string="Missing Cost">
                                <field name="checklist_line_ids"
                                    attrs="{'readonly': ['|', ('state', 'in', ('confirm', 'running')), ('is_verified', '=', True)]}"
                                    nolabel="1">
                                    <tree editable="bottom">
                                        <field name="lot_ids" invisible="1" />
                                        <field name="lot_id" widget="many2one_tags" string="Serial Number" required="1"/>
                                        <field name="product_id"/>
                                        <field name="item_id" widget="many2one_tags" string="Checklist Item" required="1"/>
                                        <field name="is_outitem" readonly="1" force_save="1"/>
                                        <field name="is_initem" readonly="1" force_save="1"/>
                                        <field name="is_available" invisible="1" />
                                        <field name="price" />
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page name="damage_cost" string="Damage Cost">
                            <group string="Damage Cost">
                                <field name="damage_cost_line_ids" nolabel="1" readonly="1" mode="tree,form" form_view_id="equip3_rental_operation.rental_damage_cost_line_form_view">
                                    <tree editable="bottom">
                                        <field name="lot_ids" invisible="1" />
                                        <field name="lot_id" widget="many2one_tags" string="Serial Number" required="1"/>
                                        <field name="product_id"/>
                                        <field name="damage_notes"/>
                                        <field name="attachment_name" invisible="1"/>
                                        <field name="attachment" widget="binary" filename="attachment_name"/>
                                        <field name="damage_cost" readonly="1" force_save="1"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                    </notebook>
                    <div>
                        <group class="oe_subtotal_footer oe_right">
                            <field name="is_hide_deposit" invisible="1"/>
                            <field name="total_accessories" invisible="1"/>
                            <field name="missing_cost" />
                            <field name="damage_cost" />
                            <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                <label for="total"/>
                            </div>
                            <field name="total" nolabel="1"/>
                            <div>
                                <button name="action_button_verify_rental" string="Verify" class="btn btn-primary col-8 ml-md-5" type="object" attrs="{'invisible': [('is_in_validate', '=', False)]}"/> 
                            </div>
                        </group>
                    </div>
                    <group>
                        <field name="notes" attrs="{'readonly': [('is_verified', '=', True)]}"/>
                    </group>
                </page>
            </xpath>
            <xpath expr="//sheet//h1//span" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//button[@name='action_button_close_rental']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//button[@name='%(browseinfo_rental_management.action_view_rental_product_replace)d']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//button[@name='%(browseinfo_rental_management.action_extend_renew_rental)d']" position="attributes">
                <attribute name="states">running</attribute>
                <attribute name="attrs">{'invisible': ['|',('state', 'in', ('confirm','close','draft','running', 'canceled')),('state2','in',('returned'))]}</attribute>
                <attribute name="string">Extend</attribute>
            </xpath>
            <xpath expr="//field[@name='rental_initial']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='start_date']" position="attributes">
                <attribute name="required">1</attribute>
            </xpath>
            <xpath expr="//field[@name='message_ids']" position="after">
                <field name="activity_ids"/>
            </xpath>
            <xpath expr="//button[@name='action_view_invoice_rental']" position="before">
                <button type="object" name="action_replace_product_delivery"
                        class="oe_stat_button" icon="fa-truck"
                        attrs="{'invisible': [('replace_product_delivery_count', '=', 0)]}" groups="base.group_user">
                    <field name="replace_product_delivery_count" widget="statinfo" string="Replace Product Delivery" />
                </button>
                <button type="object" name="action_return_rental"
                        class="oe_stat_button" icon="fa-truck"
                        attrs="{'invisible': [('return_rental_order_count', '=', 0)]}" groups="base.group_user">
                    <field name="return_rental_order_count" widget="statinfo" string="Return" />
                </button>
            </xpath>
            <xpath expr="//page[@name='extend_record']" position="after">
                <page name="approval_matrix_line" string="Approval Matrix Line" attrs="{'invisible': [('is_rental_order_approval_matrix', '=', False)]}">
                    <group name="approval_matrix_line">
                        <field name="approval_matrix_id" />
                        <br/>            
                        <field name="rental_approval_line_ids" nolabel="1" context="{'rental_approval_line_ids': rental_approval_line_ids}">
                            <tree>
                                <field name="sequence" />
                                <field name="user_ids" widget="many2many_tags" />
                                <field name="minimum_approver" />
                                <field name="approval_status" />
                                <field name="approved_time" />
                                <field name="feedback" />
                            </tree>
                        </field>
                    </group>
                </page>
            </xpath>

            <xpath expr="//button[@name='action_button_confirm_rental']" position="before">
                <field name="is_need_approval" invisible="1" />
                <button 
                    name="action_request_approaval"
                    string="Request Approval" 
                    class="oe_highlight" 
                    type="object" attrs="{'invisible': ['|', ('state', 'not in', ('draft')), ('is_need_approval', '=', False)]}"/>
                <button 
                    name="action_approve"
                    string="Approve" 
                    class="oe_highlight" 
                    type="object" attrs="{'invisible': ['|', ('state', 'not in', ('waiting')), ('is_need_approval', '=', False)]}"/>
                <button 
                    name="action_open_fedback_wizard"
                    string="Reject" 
                    class="oe_highlight" 
                    type="object" attrs="{'invisible': ['|', ('state', 'not in', ('waiting')), ('is_need_approval', '=', False)]}"/>
            </xpath>
            <xpath expr="//button[@name='action_button_confirm_rental']" position="attributes">
                <attribute name="states"></attribute>
                <attribute name="attrs">{'invisible': ['|',('state', 'not in', ['draft']), ('is_rental_order_approval_matrix', '=', True)]}</attribute>
            </xpath>
        </field>
    </record>

    <record id="stock_picking_view_inherit_id" model="ir.ui.view">
        <field name="name">stock.picking.inherit.view.form</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='note']" position="after">
                <field name="rental_id" invisible="1"/>
                <page name="ro_checklist_line" string="Checklist" attrs="{'invisible': [('rental_id', '=', False)]}">
                    <field name="confirm_rental" invisible="1"/>
                    <field name="is_checking_button_clicked" invisible="1"/>
                    <field name="is_confirm" invisible="1"/>
                    <field name="hide_confirm_checklist" invisible="1"/>
                    <div class="d-flex">
                        <label for="damage_cost_initem" style="width:10%;" invisible="1" />
                        <field name="damage_cost_initem" style="width:15%;" invisible="1" />
                    </div>
                    <notebook>
                        <page name="missing_cost" string="Missing Cost">
                            <group string="Missing Cost">
                                <field name="checklist_line_rental" nolabel="1" attrs="{'readonly': [('state', '=', 'done')]}">
                                    <tree editable="bottom" create="0" delete="0">
                                        <field name="picking_type_code" invisible="1"/>
                                        <field name="lot_ids" invisible="1"/>
                                        <field name="lot_id" widget="many2one_tags" string="Serial Number" required="1"/>
                                        <field name="product_id"/>
                                        <field name="item_id" string="Name" readonly="1" force_save="1"/>
                                        <field name="is_outitem" attrs="{'readonly': [('picking_type_code', '!=', 'outgoing')]}"/>
                                        <field name="is_initem" attrs="{'readonly': [('picking_type_code', '=', 'outgoing')]}"/>
                                        <field name="is_available" invisible="1"/>
                                        <field name="price" invisible="1"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page name="damage_cost" string="Damage Cost">
                            <group string="Damage Cost">
                                <field name="damage_cost_line_ids" nolabel="1" attrs="{'readonly': [('picking_type_code', '=', 'outgoing')]}"  mode="tree,form" form_view_id="equip3_rental_operation.rental_damage_cost_line_form_view">
                                    <tree editable="bottom">
                                        <field name="lot_ids" invisible="1" />
                                        <field name="lot_id" widget="many2one_tags" string="Serial Number" required="1"/>
                                        <field name="product_id"/>
                                        <field name="damage_notes"/>
                                        <field name="attachment_name" invisible="1"/>
                                        <field name="attachment" widget="binary" filename="attachment_name"/>
                                        <field name="picking_type_code" invisible="1"/>
                                        <field name="damage_cost" attrs="{'readonly': [('picking_type_code', '!=', 'incoming')]}" force_save="1"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                    </notebook>
                    <group class="oe_right">    
                        <button name="action_confirm_rental"
                            invisible="1"
                            class="btn btn-primary col-8 ml-md-5"
                            type="object"
                            string="Confirm"
                            width="130px"/>
                        <button name="action_verify_rental" attrs="{'invisible': [('is_checking_button_clicked', '=', False)]}" class="btn btn-primary col-8 ml-md-5" type="object" string="Verify" width="130px"/>
                    </group>
                </page>
            </xpath>
            <xpath expr="//header" position="inside">
                <button name="action_checking_rental" type="object" string="Checking" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='origin']" position="after">
                <field name="rental_return"/>
            </xpath>
            <button name="%(stock.act_stock_return_picking)d" position="attributes">
                <attribute name="attrs">{'invisible': ['|','|',('state', '!=', 'done'), ('is_return_orders', '=', True),('rental_return', '=', True)]}</attribute>
            </button>
            <xpath expr="(//button[@name='button_validate'])[1]" position="attributes">
                <attribute name="confirm">Are you sure want to validate DO? 
                Please check the checklist items before validate DO!</attribute>
            </xpath>
            
        </field>
    </record>

    <record id="browseinfo_rental_management.action_rental_orders" model="ir.actions.act_window">
        <field name="context">{'default_rental_bill_freq': 1,'default_rental_initial': 1}</field>
        <field name="view_mode">kanban,tree,form</field>
    </record>

    <record id="view_rental_order_form_inherit" model="ir.ui.view">
        <field name="name">view.rental.renew.wizard.form</field>
        <field name="model">rental.renew</field>
        <field name="inherit_id" ref="browseinfo_rental_management.view_rental_renew_wizard" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='rental_id']" position="after">
                <field name="date" position="move"/>
            </xpath>
            <xpath expr="//field[@name='rental_initial_type']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='rental_initial']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='rental_initial_type']" position="after">
                <field name="date" position="move"/>
            </xpath>
            <xpath expr="//field[@name='rental_initial_type']" position="before">
                <field name="rental_start_date" position="move"/>
                <field name="rental_initial" position="move"/>
            </xpath>
            <xpath expr="//field[@name='rental_start_date']" position="after">
                <field name="rental_initial_and_type" readonly="True" />
            </xpath>
            <xpath expr="//field[@name='date']" position="after">
                <label for="extend_term" />
                <div>
                    <field name="extend_term" class="oe_inline"/>
                    <field name="extend_term_type" class="oe_inline"/>
                </div>
            </xpath>
            <xpath expr="//form/group[1]" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//form" position="inside">
                <sheet>
                    <group name="main_form">
                        <group name="form_left">
                            <field name="rental_start_date" widget="datetime" readonly="1" force_save="1" />
                            <field name="rental_initial_and_type" readonly="True" />
                            <field name="date" widget="datetime" readonly="1" force_save="1" />
                            <label for="extend_term" />
                            <div id="extend_term">
                                <field name="extend_term" class="oe_inline"/>
                                <field name="extend_term_type" class="oe_inline"/>
                            </div>
                        </group>
                        <group name="form_right">
                            <field name="is_recurring_invoice" />
                            <label for="rental_bill_freq" attrs="{'invisible': [('is_recurring_invoice', '!=', True)]}"/>
                            <div id="rental_bill_freq" attrs="{'invisible': [('is_recurring_invoice', '!=', True)]}">
                                <field name="rental_bill_freq" class="oe_inline"/>
                                <field name="rental_bill_freq_type" class="oe_inline"/>
                            </div>
                        </group>
                    </group>
                </sheet>
            </xpath>
        </field>
    </record>

    <record id="view_rental_product_replace_form_inherit" model="ir.ui.view">
        <field name="model">rental.product.replace</field>
        <field name="inherit_id" ref="browseinfo_rental_management.view_rental_product_replace_form"></field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='existing_product_ids']" position="attributes">
                <attribute name="string">Rental Product Replace</attribute>
            </xpath>
            <xpath expr="//field[@name='existing_product_ids']/tree" position="attributes">
                <attribute name="create">0</attribute>
                <attribute name="delete">0</attribute>
            </xpath>
            <xpath expr="//field[@name='existing_product_ids']/tree/field[@name='product_id']" position="attributes">
                <attribute name="force_save">1</attribute>
            </xpath>
            <xpath expr="//field[@name='existing_product_ids']/tree/field[@name='lot_id']" position="attributes">
                <attribute name="force_save">1</attribute>
            </xpath>
            <xpath expr="//field[@name='replace_product_ids']/tree/field[@name='lot_id']" position="after">
                <field name="lot_avail_ids" widget="many2many_tags" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='replace_product_ids']/tree/field[@name='lot_id']" position="attributes">
                <attribute name="domain">[('product_id','=',product_id),('id','in',lot_avail_ids)]</attribute>
            </xpath>
            <xpath expr="//field[@name='existing_product_ids']/tree/field[@name='lot_id']" position="after">
                <field name="product_categ_id" invisible="1" />
                <field name="replace_product_id" />
                <field name="replace_serial_number_id" />
            </xpath>
            <xpath expr="//field[@name='existing_product_ids']/tree/field[@name='product_qty']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='existing_product_ids']/tree/field[@name='replace_item']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='replace_product_ids']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='existing_product_ids']/tree/field[@name='lot_id']" position="after">
                <field name="lot_avail_ids" invisible="1" />
            </xpath>
        </field>
    </record>

    <record id="rental_damage_cost_line_form_view" model="ir.ui.view">
        <field name="name">rental.order.damage.cost.line.form</field>
        <field name="model">rental.order.damage.cost.line</field>
        <field name="arch" type="xml">
            <form string="Damage Cost Lines">
                <sheet>
                    <group>
                        <field name="lot_id"/>
                        <field name="lot_ids" invisible="1"/>
                        <field name="product_id"/>
                        <field name="damage_notes"/>
                        <field name="attachment_name" invisible="1"/>
                        <field name="attachment" widget="binary" filename="attachment_name"/>
                        <field name="rental_order_id"/>
                        <field name="picking_type_code"/>
                        <field name="damage_cost"/>
                        <field name="stock_picking_id"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    

</odoo>