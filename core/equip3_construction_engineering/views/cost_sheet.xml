<?xml version="1.0" encoding="utf-8"?>
<!--
Copyright (C) 2015 DevIntelle Consulting Service Pvt.Ltd (<http://www.devintellecs.com>).

For Module Support : devintelle@gmail.com  or Skype : devintelle
 -->
<odoo>  
    <record id="view_cost_sheet_form_engineering" model="ir.ui.view">
        <field name="name">job.cost.sheet.engineering.form</field>
        <field name="model">job.cost.sheet</field>
        <field name="inherit_id" ref="abs_construction_management.view_job_cost_sheet_menu_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='user_is_approver']" position="after">
                <field name="is_engineering" invisible="1" force_save="1"/>
                <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="type" readonly="1" force_save="1"/>
            </xpath>
            <xpath expr="//page[@name='material_estimation_cons']" position="before">
                <page string="Manufacture Estimation" name="manuf_estimation_cons" attrs="{'invisible': [('is_engineering','=',False)]}">
                    <field name="hide_cascade" invisible="1"/>
                    <field name="hide_undo" invisible="1"/>
                    <button name="cascade_bom_button" type="object" attrs="{'invisible': ['|', ('state', '!=', 'draft'), ('hide_cascade', '!=', False)]}" string="Cascade to child BOM " class="btn btn-primary"/>
                    <button name="undo_cascade_bom" type="object" attrs="{'invisible': ['|', ('state', '!=', 'draft'), ('hide_undo', '!=', False)]}" string="Undo Cascade" class="btn btn-secondary"/>
                    <field name="manufacture_line" nolabel="1" force_save="1" class="o_cost_material_line" attrs="{'readonly': [('state', '!=', 'draft')]}">
                        <tree editable="bottom">
                            <field name="sequence" widget="handle" />
                            <field name="sr_no"/>
                            <field name="date"/>
                            <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]" required="1"/>
                            <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                            <field name="section_name" domain="[('id','in',project_section_computed)]" required="1"/>
                            <field name="variable_ref" optional="hide"/>
                            <field name="final_finish_good_id"/>
                            <field name="finish_good_id" required='True'/>
                            <field name="bom_id" required='True'/>
                            <field name="parent_manuf_line" invisible="1" force_save="1"/>
                            <field name="product_qty" string="Budgeted Quantity"/>
                            <field name="price_unit"/>
                            <field name="cascaded" invisible="1" force_save="1"/>
                            <field name="is_child" readonly="1" force_save="1" attrs="{'column_invisible': [('parent.hide_undo', '!=', False)]}"/>
                            <field name="manuf_amount_total" string="Budgeted Amount"/>
                            <field name="budgeted_qty_left" attrs="{'column_invisible': [('parent.hide_budget_left', '=', True)]}"/>
                            <field name="budgeted_amt_left" attrs="{'column_invisible': [('parent.hide_budget_left', '=', True)]}"/>
                            <field name="unused_qty" readonly="1" optional="hide" force_save="1"/>
                            <field name="unused_amt" readonly="1" optional="hide" force_save="1"/>
                            <field name="rejected_qty" readonly="1"  force_save="1"/>
                            <field name="manuf_create_qty" readonly="1" force_save="1"/>
                            <field name="manuf_create_amt" readonly="1" force_save="1"/>
                            <field name="allocated_budget_qty" readonly="1" optional="hide"/>
                            <field name="allocated_budget_amt" readonly="1" optional="hide"/>
                            <field name="product_qty_na" readonly="1" optional="hide"/>
                            <field name="product_amt_na" readonly="1" optional="hide"/>
                            <field name="actual_used_qty" readonly="1" force_save="1" />
                            <field name="actual_used_amt" readonly="1" force_save="1" />
                        </tree>
                    </field>
                    <group class="oe_subtotal_footer oe_right" colspan="2" name="sale_total">
                        <field name="manuf_budget_created" widget='monetary'
                            options="{'currency_field': 'currency_id'}"/>
                        <field name="manuf_budget_left" widget='monetary'
                            options="{'currency_field': 'currency_id'}"/>
                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                            <label for="amount_manuf" />
                        </div>
                            <field name="amount_manuf" nolabel="1" class="oe_subtotal_footer_separator" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                        <field name="manuf_budget_unused" widget='monetary'
                            options="{'currency_field': 'currency_id'}"/>
                        <field name="manuf_budget_used" widget='monetary'
                            options="{'currency_field': 'currency_id'}"/>
                    </group>
                </page>
            </xpath>
            <xpath expr="//field[@name='material_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='material_gop_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='material_labour_gop_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='material_labour_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='material_overhead_gop_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='material_overhead_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='internal_asset_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='material_equipment_gop_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='material_equipment_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
            <xpath expr="//field[@name='material_subcon_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="final_finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='show'/>
                <field name="bom_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}" optional='hide'/>
            </xpath>
        </field>
    </record>

    <record id="view_job_cost_sheet_smart_buttons_inherit" model="ir.ui.view">
        <field name="name">job.cost.sheet.view.form.smart.button.inherit</field>
        <field name="model">job.cost.sheet</field>
        <field name="inherit_id" ref="equip3_construction_operation.view_job_cost_sheet_smart_buttons"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']/button[@name='action_job_estimate']" position='after'>
                <button name="action_mrp_cons"
                        type="object"
                        class="oe_stat_button"
                        icon="o-hm-smart-all-manufacturing-plan"
                        attrs="{'invisible': ['|',('state', '=' , 'draft'),('count_mrp_cons', '=', 0)]}">
                    <field name="count_mrp_cons" widget="statinfo" string="Production Plan"/>
                </button>
            </xpath>
        </field>
    </record>

    <record id="view_cost_sheet_tree_engineering" model="ir.ui.view">
        <field name="name">job.cost.sheet.engineering.tree</field>
        <field name="model">job.cost.sheet</field>
        <field name="inherit_id" ref="abs_construction_management.view_job_cost_sheet_menu_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='project_id']" position="after">
                <field name="type"/>
            </xpath>
        </field>
    </record>
</odoo>