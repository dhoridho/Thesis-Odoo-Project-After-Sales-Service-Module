<?xml version="1.0" encoding="utf-8"?>
<odoo>  
    <record id="project_budget_engineering_form_view" model="ir.ui.view">
        <field name="name">project.budget.form.engineering.form</field>
        <field name="model">project.budget</field>
        <field name="inherit_id" ref="equip3_construction_operation.project_budget_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='department_type']" position="after">
                <field name="is_engineering" readonly="1" force_save="1"/>
                <field name="project_scope_computed" widget="many2many_tags" invisible="1"/>
            </xpath>
            <xpath expr="//page[@name='budget_material_estimation']" position="after">
                <page string="Manufacture Estimation" attrs="{'invisible': ['|', ('is_engineering','=',False), ('budgeting_method', '=', 'gop_budget')]}">
                    <field name="manufacture_line" class="o_project_budget_line">
                        <tree editable="bottom">
                            <field name="sr_no"/>
                            <field name="cs_manuf_id" optional="hide" force_save="1"/>
                            <field name="date"/>
                            <field name="project_scope" domain="[('id','in',parent.project_scope_computed)]" required="1"/>
                            <field name="project_section_computed" widget="many2many_tags" invisible="1"/>
                            <field name="section_name" domain="[('id','in',project_section_computed)]" required="1"/>                    
                            <field name="variable"/>
                            <field name="company_id" invisible="1"/>
                            <field name="finish_good_id"/>
                            <field name="bom_id"/>
                            <field name="quantity"/>
                            <field name="unallocated_quantity" readonly="1" force_save="1"/>
                            <!-- <field name="on_hand_qty"/> -->
                            <field name="uom_id"/>
                            <field name="amount" readonly="1" force_save="1"/>
                            <field name="amount_total" readonly="1" force_save="1"/>
                            <field name="unallocated_amount" readonly="1" force_save="1"/>
                            <field name="budget_quantity" readonly="1" force_save="1"/>
                            <field name="budget_amount" readonly="1" force_save="1" optional="hide"/>
                            <field name="qty_left" readonly="1" force_save="1"/>
                            <field name="amt_left" readonly="1" force_save="1"/>
                            <field name="qty_created" readonly="1"  force_save="1"/>
                            <field name="amt_created" readonly="1"  force_save="1"/>
                            <field name="unused_qty" readonly="1" force_save="1" optional="hide"/>
                            <field name="unused_amt" readonly="1" force_save="1" optional="hide"/>
                            <field name="dif_qty_used" force_save="1" optional="hide"/>
                            <field name="dif_amt_used" force_save="1" optional="hide"/>
                            <field name="qty_used" force_save="1" readonly="1"/>
                            <field name="amt_used" force_save="1" readonly="1"/>
                            <field name="status" readonly="1"/>
                            <field name="carried_to" force_save="1" readonly="1" attrs="{'invisible': [('status', '!=', False)]}"/>
                            <field name="carried_from" force_save="1" readonly="1" attrs="{'invisible': [('status', '!=', False)]}"/>
                        </tree>
                    </field>
                    <group class="oe_subtotal_footer oe_right" colspan="2">
                        <field name="amount_created_manuf" widget='monetary'
                            options="{'currency_field': 'currency_id'}"/>
                        <field name="amount_left_manuf" widget='monetary'
                            options="{'currency_field': 'currency_id'}"/>
                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                            <label for="amount_manuf"/>
                        </div>
                        <field name="amount_manuf" nolabel="1" class="oe_subtotal_footer_separator"
                                widget='monetary' options="{'currency_field': 'currency_id'}"/>
                        <field name="amount_used_manuf" widget='monetary'
                                options="{'currency_field': 'currency_id'}"/>
                        <field name="amount_unused_manuf" widget='monetary'
                                options="{'currency_field': 'currency_id'}"/>
                    </group>
                </page>
            </xpath>
            <xpath expr="//field[@name='budget_material_ids']/tree/field[@name='variable']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='budget_material_gop_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='budget_labour_gop_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='budget_labour_ids']/tree/field[@name='variable']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='budget_overhead_gop_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='budget_overhead_ids']/tree/field[@name='variable']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='budget_internal_asset_ids']/tree/field[@name='variable_id']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='budget_equipment_gop_ids']/tree/field[@name='variable_ref']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
            <xpath expr="//field[@name='budget_equipment_ids']/tree/field[@name='variable']" position="after">
                <field name="finish_good_id" attrs="{'column_invisible':[('parent.is_engineering','=',False)]}"/>
            </xpath>
        </field>
    </record>
</odoo>