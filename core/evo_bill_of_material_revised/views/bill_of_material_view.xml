<?xml version="1.0" encoding="utf-8"?>
<odoo>

	<record id="mrp_bom_tree_view_inherited" model="ir.ui.view">
		<field name="name">mrp.bom.view.tree.inherited</field>
		<field name="model">mrp.bom</field>
		<field name="inherit_id" ref="mrp.mrp_bom_tree_view" />
		<field name="arch" type="xml">
			<field name="product_tmpl_id" position="before">
				<field name="revision_name" digits="[12,3]"/>
			</field>
			<field name="product_uom_id" position="after">
				<field name="state" />
			</field>
			<xpath expr="//tree" position="attributes">
        		<attribute name="decoration-success">state not in ['revised','draft']</attribute>
        		<attribute name="decoration-danger">state not in ['confirm','draft']</attribute>
        		<attribute name="decoration-primary">state not in ['confirm','revised']</attribute>
        	</xpath>
		</field>
	</record>

	<record id="mrp_bom_form_view_inherited" model="ir.ui.view">
		<field name="name">mrp.bom.view.inherited</field>
		<field name="model">mrp.bom</field>
		<field name="inherit_id" ref="mrp.mrp_bom_form_view" />
		<field name="arch" type="xml">
		
			<xpath expr="//form/sheet" position="before">
				<header>
					<button name="action_go_revised" type="object" string="Revise" groups="base.group_user" class='oe_highlight' attrs="{'invisible':[('state', '!=','confirm')]}"/>
					<button name="action_restore_revised" type="object" string="Restore" groups="base.group_user" class='oe_highlight' attrs="{'invisible':[('state', '!=','revised')]}"/>
					<button name="action_active_revised" type="object" string="Active" groups="base.group_user" class='oe_highlight' attrs="{'invisible':[('state', '!=','draft')]}"/>
					<field name='state' widget='statusbar'/>
				</header>
			</xpath>
			
			<xpath expr="//sheet/div[@name='button_box']" position="after">
                <widget name="web_ribbon" bg_color="bg-primary" title="Draft" attrs="{'invisible':[('state','in',['confirm','revised'])]}"/>
                <widget name="web_ribbon" bg_color="bg-danger" title="Revised" attrs="{'invisible':[('state','in',['confirm','draft'])]}"/>
                <widget name="web_ribbon" bg_color="bg-success" title="Active" attrs="{'invisible':[('state','in',['revised','draft'])]}"/>
            </xpath>
			<!-- <xpath expr="//form/sheet/group[1]" position="before">
				 <div class="oe_button_box" name="button_box">
				 	<img src="/evo_bill_of_material_revised/static/description/revised.png" attrs="{'invisible':[('state','=','confirm')]}" width="35" height="35"/>
				 	<img src="/evo_bill_of_material_revised/static/description/version.png" attrs="{'invisible':[('state','=','revised')]}" width="35" height="35"/>
				 </div>
				 <div class="oe_title">   
                    <h1>
                       <field name="revision_name" readonly="True" digits="[12,3]"/>
                   </h1>
                </div>
			</xpath> -->
                        
			<field name="product_id" position="after">
				<field name="revision_no" invisible="1" />
				<field name="current_revision_id" invisible="1" />
			</field>
			
			<xpath expr="//form/sheet/group[1]/group[1]/div[1]" position="after">
				<field name="revision_name" readonly="True" digits="[12,3]"/>
			</xpath>

			<xpath expr="//form/sheet/notebook/page[2]" position="after">
				<page string="Revision">
					<field name="old_revision_ids">
						<tree>
							<field name="revision_name" digits="[12,3]"/>
							<field name='create_date' string="Bill of Material Date" />
							<field name='create_uid' string="Superseeded by" />
							<field name="state" readonly='1'/>
						</tree>
					</field>
				</page>
			</xpath>
		</field>
	</record>
	
	<record id="view_mrp_bom_filter_inherited" model="ir.ui.view">
		<field name="name">mrp.bom.view.select.inherited</field>
		<field name="model">mrp.bom</field>
		<field name="inherit_id" ref="mrp.view_mrp_bom_filter" />
		<field name="arch" type="xml">
			<field name="product_tmpl_id" position="after">
				<field name="state" invisible="1" />
			</field>
			<xpath expr="//filter[@name='phantom']" position="after">
				<separator/>
                <filter string="Draft" name="state_draft" domain="[('state', '=', 'draft')]"/>
                <filter string="Revised" name="state_draft" domain="[('state', '=', 'revised')]"/>
                <filter string="Active" name="state_draft" domain="[('state', '=', 'confirm')]"/>
			</xpath>
		</field>
	</record>
	
	<record id="mrp.mrp_bom_form_action" model="ir.actions.act_window">
		<field name="context">{'search_default_state': 'confirm'}</field>
	</record>
	
	
</odoo>
