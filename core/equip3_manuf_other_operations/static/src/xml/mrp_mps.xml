<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <div t-name="MPSAction" class="o_action o_mps_action">
        <div class="o_content"/>
    </div>

    <t t-name="equip3_mrp_mps">
        <div class="o_mrp_mps">
            <t t-set="periods" t-value="widget.periods"/>
            <t t-set="state" t-value="widget.state"/>
            <t t-set="formatFloat" t-value="widget.formatFloat"/>
            <!-- <t t-set="warehouseIds" t-value="widget.warehouseIds"/>
            <t t-set="warehouseId" t-value="widget.warehouseId"/> -->
            <div class="text-nowrap mr0 ml0">
                <!-- <div class="row">
                    <div class="mt-2 col-3">
                        <select class="o_mrp_mps_warehouse">
                            <t t-if="warehouseId == 0">
                                <option t-att-value="0" selected="selected">Select Warehouse</option>
                            </t>
                            <t t-foreach="warehouseIds" t-as="warehouse">
                                <t t-if="warehouse.id == warehouseId">
                                    <option t-att-value="warehouse.id" selected="selected"><t t-esc="warehouse.name"/></option>
                                </t>
                                <t t-else="">
                                    <option t-att-value="warehouse.id"><t t-esc="warehouse.name"/></option>
                                </t>
                            </t>
                        </select>
                    </div>
                </div> -->

                <table class="table o_mps_product_table">
                    <thead class="thead-light">
                        <tr>
                            <th/>
                            <th class="text-right pr-4" scope="col" t-foreach="periods" t-as="period">
                                <div><t t-esc="period"/></div>
                            </th>
                        </tr>
                    </thead>
                    <t t-call="equip3_mrp_mps_production_schedule"/>
                </table>
            </div>
        </div>
    </t>

    <t t-name="equip3_mrp_mps_nocontent_helper">
        <div class="o_mrp_mps">
            <div class="o_view_nocontent">
                <div class="o_nocontent_help">
                    <p class="o_view_nocontent_smiling_face">
                        No product yet. Try changing warehouses, remove the filters, or add new one.
                    </p><p>
                        The master schedule translates your sales and demand forecasts into a production and purchase planning for each component.
                        It ensures everything gets scheduled on time, based on constraints such as: safety stock, production capacity, lead times.
                        It's the perfect tool to support your S&amp;OP meetings.
                    </p>
                </div>
            </div>
        </div>
    </t>

    <t t-name="equip3_mrp_mps_production_schedule">
        <t t-foreach="state" t-as="productionSchedule">
            <tbody class="o_mps_content" t-att-data-id="productionSchedule.id" t-att-data-warehouse_id="'warehouse_id' in productionSchedule and productionSchedule.warehouse_id[0]">
                <tr class="bg-light">
                    <th scope="col">
                        <a href="#" class="o_mrp_mps_record_url" t-att-data-res-id="productionSchedule.product_id[0]" t-att-data-model="'product.product'"><t t-esc="productionSchedule.product_id[1]"/></a>
                        <span t-if="'product_uom_id' in productionSchedule" class="text-muted"> by <t t-esc="productionSchedule.product_uom_id[1]"/></span>
                        <span t-if="'warehouse_id' in productionSchedule"> - <t t-esc="productionSchedule.warehouse_id[1]"/></span>
                        <a href="#" class="fa fa-trash-o text-black o_mrp_mps_unlink" role="img" aria-label="Delete" title="Delete"/>
                    </th>
                    <t t-foreach="productionSchedule.forecast_ids" t-as="forecast">
                        <th/>
                    </t>
                </tr>
                <tr name="view_details">
                    <th scope="row">
                        <button class="o_view_details btn btn-primary">View Details</button>
                    </th>
                    <th t-att-colspan="productionSchedule.colspan"/>
                </tr>
                <!-- <tr name="low_stock">
                    <th scope="row">
                        • <span data-toggle="tooltip" data-placement="bottom" title="Low Stock.">Min Stock</span>
                    </th>
                    <t t-foreach="productionSchedule.forecast_ids" t-as="forecast">
                        <th t-attf-class="text-right pr-4">
                            <t t-esc="formatFloat(forecast.low_stock, false, {'digits': [false, productionSchedule.precision_digits]})"/>
                        </th>
                    </t>
                </tr>
                <tr name="max_stock">
                    <th scope="row">
                        • <span data-toggle="tooltip" data-placement="bottom" title="Max Stock.">Max Stock</span>
                    </th>
                    <t t-foreach="productionSchedule.forecast_ids" t-as="forecast">
                        <th t-attf-class="text-right pr-4">
                            <t t-esc="formatFloat(forecast.max_stock, false, {'digits': [false, productionSchedule.precision_digits]})"/>
                        </th>
                    </t>
                </tr> -->
                <tr name="on_hand_qty">
                    <th scope="row">
                        • <span data-toggle="tooltip" data-placement="bottom" title="On Hand Quantity">On Hand</span>
                    </th>
                    <t t-foreach="productionSchedule.forecast_ids" t-as="forecast">
                        <th t-attf-class="text-right pr-4">
                            <t t-esc="formatFloat(forecast.on_hand_qty, false, {'digits': [false, productionSchedule.precision_digits]})"/>
                        </th>
                    </t>
                </tr>
                <tr name="sales">
                    <th scope="row">
                        - <span data-toggle="tooltip" data-placement="bottom" title="Sales.">Sales</span>
                    </th>
                    <t t-foreach="productionSchedule.forecast_ids" t-as="forecast">
                        <th t-attf-class="text-right pr-4">
                            <t t-esc="formatFloat(forecast.sales, false, {'digits': [false, productionSchedule.precision_digits]})"/>
                        </th>
                    </t>
                </tr>
                <tr name="forecasted_demand">
                    <th scope="row">
                        - <span data-toggle="tooltip" data-placement="bottom" title="Forecasted Demand.">Forecasted Demand</span>
                    </th>
                    <t t-foreach="productionSchedule.forecast_ids" t-as="forecast">
                        <th t-attf-class="text-right pr-4">
                            <div class="d-flex">
                                <button t-attf-class="btn btn-sm btn-primary o_5_line_height o_mrp_mps_reset {{ ! forecast.forecasted_demand_edited and 'o_hidden' or 'mr-2'}}"
                                        t-att-data-forecast_id="forecast.forecast_at_date_id"
                                        t-att-data-forecasted_demand_edited="forecast.forecasted_demand_edited"
                                        t-att-data-reset="'forecasted_demand'">Reset</button>
                                <input type="text"
                                       t-att-data-field="'forecasted_demand'"
                                       t-att-data-date_index="forecast_index"
                                       t-attf-class="text-right form-control o_mrp_mps_input_forecasted_demand o_mps_input_inline"
                                       t-att-value="formatFloat(forecast.forecasted_demand, false, {'digits': [false, productionSchedule.precision_digits]})"/>
                            </div>
                        </th>
                    </t>
                </tr>
                <tr name="forecasted_stock">
                    <th scope="row">
                        = <span data-toggle="tooltip" data-placement="bottom" title="Forecasted Stock.">Forecasted Stock</span>
                    </th>
                    <t t-foreach="productionSchedule.forecast_ids" t-as="forecast">
                        <th t-attf-class="text-right pr-4 {{ forecast.forecasted_stock &lt; 0.0 and 'text-danger' or '' }}">
                            <t t-esc="formatFloat(forecast.forecasted_stock, false, {'digits': [false, productionSchedule.precision_digits]})"/>
                        </th>
                    </t>
                </tr>
                <tr name="to_replenish">
                    <th scope="row">
                        = <span data-toggle="tooltip" data-placement="bottom" title="To Replenish.">To Produce</span>
                    </th>
                    <t t-foreach="productionSchedule.forecast_ids" t-as="forecast">
                        <th t-attf-class="text-right pr-4">
                            <div class="d-flex">
                                <button t-attf-class="btn btn-sm btn-primary o_5_line_height o_mrp_mps_reset {{ ! forecast.to_replenish_edited and 'o_hidden' or 'mr-2'}}"
                                        t-att-data-forecast_id="forecast.forecast_at_date_id"
                                        t-att-data-to_replenish_edited="forecast.to_replenish_edited"
                                        t-att-data-reset="'to_replenish'">Reset</button>
                                <input type="text"
                                       t-att-data-field="'to_replenish'"
                                       t-att-data-date_index="forecast_index"
                                       t-attf-class="text-right form-control o_mrp_mps_input_to_replenish o_mps_input_inline"
                                       t-att-value="formatFloat(forecast.to_replenish_qty, false, {'digits': [false, productionSchedule.precision_digits]})"/>
                            </div>
                        </th>
                    </t>
                </tr>
            </tbody>
        </t>
    </t>

    <t t-name="equip3_mrp_mps_control_panel_buttons">
        <table><tbody>
            <tr>
                <td class="pr-2"><button type="button" class='btn btn-secondary o_mrp_mps_create w-100'>Add a Product</button></td>
                <td><button type="button" class="btn btn-primary o_mrp_mps_replenish w-100">Reproduce</button></td>
            </tr>
            <tr><td colspan="2">
                <select class="o_mrp_mps_warehouse mt-2">
                    <t t-if="warehouseId == 0">
                        <option t-att-value="0" selected="selected">Select Warehouse</option>
                    </t>
                    <t t-foreach="warehouseIds" t-as="warehouse">
                        <t t-if="warehouse.id == warehouseId">
                            <option t-att-value="warehouse.id" selected="selected"><t t-esc="warehouse.name"/></option>
                        </t>
                        <t t-else="">
                            <option t-att-value="warehouse.id"><t t-esc="warehouse.name"/></option>
                        </t>
                    </t>
                </select>
            </td></tr>
        </tbody></table>
    </t>


</templates>
