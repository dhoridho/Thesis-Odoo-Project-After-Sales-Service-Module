<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="wizard_student_transcript_tmp">
        <t t-call="web.html_container">
            <t t-call="web.basic_layout">
                <div class="header" t-att-style="'font-family:'+font_family+';font-size:'+str(font_size)+'px;'">
                    <table border="0" cellpadding="0" cellspacing="0" width="100%">
                        <tbody>
                            <tr>
                                <td>
                                    <center>
                                        <table border="0" cellpadding="0" cellspacing="0" style="padding:0px 20px 0px 20px; margin:0; background:#fff; line-height:20px; vertical-align:middle; float:none;" width="100%">
                                            <tr>
                                                <td align="left" colspan="2" t-attf-style="color:#{text_color or '#ffffff'}; padding:0px 0px;" valign="top">
                                                    <table border="0" cellpadding="0" cellspacing="0" width="100%">
                                                        <tr>
                                                            <td align="left" style="color:#4D4D4F; padding: 10px 20px 0px 20px; border-right: 1px solid #D4D1D1;" valign="top">
                                                                <img style="max-height: 50px; margin-top: 8%;" t-att-src="'data:image/png;base64,%s' % to_text(company['logo'])" t-if="company['logo']"/>
                                                                <br/>
                                                            </td>
                                                            <td style="padding: 10px 20px 0px 20px;width:40%" valign="top">
                                                                <p t-attf-style="text-transform:capitalize; color: #{theme_color or '#51565b'}; font-weight:bold;margin:0; margin-bottom:5px;">
                                                                    Address
                                                                </p>
                                                                <span style="text-transform:capitalize; padding:0px; margin:0; color: #51565b;">
                                                                    <t t-if="company and company['is_company_bold']">
                                                                        <strong>
                                                                            <span t-esc="partner"/>
                                                                        </strong>
                                                                    </t>
                                                                    <t t-if="not company['is_company_bold']">
                                                                        <span t-esc="partner"/>
                                                                    </t>
                                                                </span>
                                                                <div style="color: #51565b;">
                                                                    <span t-esc="street"/>
                                                                    <br/>
                                                                    <span t-esc="address"/>
                                                                    <br/>
                                                                </div>
                                                                <div style="color: #51565b;">
                                                                    <t t-if="mobile">
                                                                        <strong>Mobile:</strong>
                                                                        <span t-esc="mobile"/>
                                                                        <br/>
                                                                    </t>
                                                                    <t t-if="email">
                                                                        <strong>Email:</strong>
                                                                        <span t-esc="email"/>
                                                                        <br/>
                                                                    </t>
                                                                    <!--  <t t-if="company.is_show_bank_details"><strong>Bank: </strong><span t-esc="company.report_bank_id.acc_number"/></t>-->
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </td>
                                            </tr>
                                        </table>
                                    </center>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="page">
                    <div class="oe_structure" />
                    <br/>
                    <hr width="100%" color="black"/>
                    <br/>
                    <div style="font-family: 'Helvetica'; text-align:center">                           
                        <h3><b>TRANSCRIPT ACADEMIC</b></h3>
                    </div>
                    <br />
                    <table width="100%">
                        <tr>
                            <td width="15%" style="font-family: 'Helvetica';font-size: 18px;">
                                <b>Student ID</b>
                            </td>
                            <td width="5%">
                                <b>:</b>
                            </td>
                            <td width="80%" style="font-family: 'Helvetica';font-size: 16px;">
                                <span t-esc="student_id"></span>
                            </td>
                        </tr>
                        <tr>
                            <td width="15%" style="font-family: 'Helvetica';font-size: 18px;">
                                <b>Student</b>
                            </td>
                            <td width="5%">
                                <b>:</b>
                            </td>
                            <td width="80%" style="font-family: 'Helvetica';font-size: 16px;">
                                <span t-esc="tracking_id['student'][1]"></span>
                            </td>
                        </tr>
                        <tr>
                            <td width="15%" style="font-family: 'Helvetica';font-size: 18px;">
                                <b>Program</b>
                            </td>
                            <td width="5%">
                                <b>:</b>
                            </td>
                            <td width="80%" style="font-family: 'Helvetica';font-size: 16px;">
                                <span t-esc="program_id"></span>
                            </td>
                        </tr>
                        <tr>
                            <td width="15%" style="font-family: 'Helvetica';font-size: 18px;">
                                <b>Intake</b>
                            </td>
                            <td width="5%">
                                <b>:</b>
                            </td>
                            <td width="80%" style="font-family: 'Helvetica';font-size: 16px;">
                                <span t-esc="tracking_id['intake'][1]"></span>
                            </td>
                        </tr>
                    </table>
                    <br />
                    <hr width="100%" color="black"/>
                    <t t-foreach="data" t-as="d">
                        <t t-set="counter" t-value="1"/>
                        <div style="font-family: 'Helvetica'; text-align:center">
                            <b style="font-size: 20px;">
                                <span t-esc="data[d]['year_id']"></span>
                                -
                                <span t-esc="data[d]['term_id']"></span>
                            </b>
                        </div>
                        <table class="table table-bordered mt-32">
                            <thead>
                                <tr>
                                    <th style="font-family: 'Helvetica';font-size: 13px; width:5%"><strong>No</strong></th>
                                    <th align="center" style="font-family: 'Helvetica';font-size: 13px; width:10%"><strong>Code</strong></th>
                                    <th align="center" style="font-family: 'Helvetica';font-size: 13px; width:65%"><strong>Subject</strong></th>
                                    <th align="center" style="font-family: 'Helvetica';font-size: 13px; width:10%"><strong>Credit</strong></th>
                                    <th align="center" style="font-family: 'Helvetica';font-size: 13px; width:10%"><strong>Grade</strong></th>                                         
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="data[d]['line_ids']" t-as="line">
                                    <tr>
                                        <td>
                                            <span><t t-esc="str(counter) + '.'"></t></span>
                                        </td>
                                        <td align="center" style="font-family: 'Helvetica';font-size: 13px;">
                                            <span t-esc="line[0]"></span>
                                        </td>
                                        <td align="left" style="font-family: 'Helvetica';font-size: 13px;">
                                            <span t-esc="line[1]"></span>
                                        </td>
                                        <td align="center" style="font-family: 'Helvetica';font-size: 13px;">
                                            <span t-esc="line[2]"></span>
                                        </td>
                                        <td align="center" style="font-family: 'Helvetica';font-size: 13px;">
                                            <span t-esc="line[3]"></span>
                                        </td>
                                    </tr>
                                    <t t-set="counter" t-value="counter+1"/>
                                </t>
                            </tbody>
                        </table>
                        <br/>
                    </t>
                </div>
            </t>
        </t>
    </template>

    <template id="wizard_student_transcript_tmp_web">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-set="company" t-value="o.company_id"/>
                <t t-set="partner" t-value="company.partner_id"/>
                <t t-set="address" t-value="o.get_address_details(partner)"/>
                <t t-set="street" t-value="o.get_street(partner)"/>
                <t t-set="data" t-value="o.prepare_data_to_print()"/>
                <t t-call="web.basic_layout">
                    <div class="header"  t-att-style="'font-family:'+company.font_id.family+';font-size:'+str(company.font_size)+'px;'">
                        <table border="0" cellpadding="0" cellspacing="0" width="100%">
                            <tbody>
                                <tr>
                                    <td>
                                        <center>
                                            <table border="0" cellpadding="0" cellspacing="0" style="padding:0px 20px 0px 20px; margin:0; background:#fff; line-height:20px; vertical-align:middle; float:none;" width="100%">
                                                <tr>
                                                    <td align="left" style="color:#4D4D4F; padding: 10px 20px 0px 20px; border-right: 1px solid #D4D1D1;" valign="top">
                                                        <img style="max-height: 50px; margin-top: 8%;" t-att-src="'data:image/png;base64,%s' % to_text(company.logo)" t-if="company.logo"/>
                                                        <br/>
                                                    </td>
                                                    <td style="padding: 10px 20px 0px 20px;width:40%" valign="top">
                                                        <p t-attf-style="text-transform:capitalize; color: #{theme_color or '#51565b'}; font-weight:bold;margin:0; margin-bottom:5px;">
                                                            Address
                                                        </p>
                                                        <span style="text-transform:capitalize; padding:0px; margin:0; color: #51565b;">
                                                            <t t-if="company and company.is_company_bold">
                                                                <strong>
                                                                    <span t-esc="partner.display_name"/>
                                                                </strong>
                                                            </t>
                                                            <t t-if="not company.is_company_bold">
                                                                <span t-esc="partner.display_name"/>
                                                            </t>
                                                        </span>
                                                        <div style="color: #51565b;">
                                                            <span t-esc="street"/>
                                                            <br/>
                                                            <span t-esc="address"/>
                                                            <br/>
                                                        </div>
                                                        <div style="color: #51565b;">
                                                            <t t-if="partner.mobile">
                                                                <strong>Mobile:</strong>
                                                                <span t-esc="partner.mobile"/>
                                                                <br/>
                                                            </t>
                                                            <t t-if="partner.email">
                                                                <strong>Email:</strong>
                                                                <span t-esc="partner.email"/>
                                                                <br/>
                                                            </t>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </center>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="page">
                        <div class="oe_structure">
                            <hr width="100%" color="black"/>
                            <br/>
                            <div style="font-family: 'Helvetica'; text-align:center">                           
                                <h3><b>TRANSCRIPT ACADEMIC</b></h3>
                            </div>
                            <br/>
                            <table width="100%">
                                <tr>
                                    <td width="15%" style="font-family: 'Helvetica';font-size: 18px;">
                                        <b>Student ID</b>
                                    </td>
                                    <td width="5%">
                                        <b>:</b>
                                    </td>
                                    <td width="80%" style="font-family: 'Helvetica';font-size: 16px;">
                                        <span t-esc="o.student.student_id.pid"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td width="15%" style="font-family: 'Helvetica';font-size: 18px;">
                                        <b>Student</b>
                                    </td>
                                    <td width="5%">
                                        <b>:</b>
                                    </td>
                                    <td width="80%" style="font-family: 'Helvetica';font-size: 16px;">
                                        <span t-esc="o.student.student_id.name"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td width="15%" style="font-family: 'Helvetica';font-size: 18px;">
                                        <b>Program</b>
                                    </td>
                                    <td width="5%">
                                        <b>:</b>
                                    </td>
                                    <td width="80%" style="font-family: 'Helvetica';font-size: 16px;">
                                        <span t-esc="o.program.name"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td width="15%" style="font-family: 'Helvetica';font-size: 18px;">
                                        <b>Intake</b>
                                    </td>
                                    <td width="5%">
                                        <b>:</b>
                                    </td>
                                    <td width="80%" style="font-family: 'Helvetica';font-size: 16px;">
                                        <span t-esc="o.intake.name"></span>
                                    </td>
                                </tr>
                            </table>
                            <br />
                            <hr width="100%" color="black"/>
                            <t t-foreach="data" t-as="d">
                                <t t-set="counter" t-value="1"/>
                                <div style="font-family: 'Helvetica'; text-align:center">
                                    <b style="font-size: 24px;">
                                        <span t-esc="data[d]['year_id']"></span>
                                        -
                                        <span t-esc="data[d]['term_id']"></span>
                                    </b>
                                </div>
                                <table class="table table-bordered mt-32">
                                    <thead>
                                        <tr>
                                            <th style="font-family: 'Helvetica';font-size: 13px; width:5%"><strong>No</strong></th>
                                            <th align="center" style="font-family: 'Helvetica';font-size: 13px; width:10%"><strong>Code</strong></th>
                                            <th align="center" style="font-family: 'Helvetica';font-size: 13px; width:65%"><strong>Subject</strong></th>
                                            <th align="center" style="font-family: 'Helvetica';font-size: 13px; width:10%"><strong>Credit</strong></th>
                                            <th align="center" style="font-family: 'Helvetica';font-size: 13px; width:10%"><strong>Grade</strong></th>                                         
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="data[d]['line_ids']" t-as="line">
                                            <tr>
                                                <td>
                                                    <span><t t-esc="str(counter) + '.'"></t></span>
                                                </td>
                                                <td align="center" style="font-family: 'Helvetica';font-size: 13px;">
                                                    <span t-esc="line[0]"></span>
                                                </td>
                                                <td align="center" style="font-family: 'Helvetica';font-size: 13px;">
                                                    <span t-esc="line[1]"></span>
                                                </td>
                                                <td align="center" style="font-family: 'Helvetica';font-size: 13px;">
                                                    <span t-esc="line[2]"></span>
                                                </td>
                                                <td align="center" style="font-family: 'Helvetica';font-size: 13px;">
                                                    <span t-esc="line[3]"></span>
                                                </td>
                                            </tr>
                                            <t t-set="counter" t-value="counter+1"/>
                                        </t>
                                    </tbody>
                                </table>
                                <br/>
                            </t>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>
