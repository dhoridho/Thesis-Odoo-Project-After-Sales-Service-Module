<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="action_purchase_vendor_delay_reports" model="ir.actions.act_window">
        <field name="name">On-time Delivery</field>
        <field name="res_model">vendor.delay.report</field>
        <field name="view_mode">graph</field>
        <field name="search_view_id" ref="purchase_stock.vendor_delay_report_filter"/>
        <field name="help">Vendor On-time Delivery analysis</field>
        <field name="target">current</field>
        <field name="context">{'search_default_later_than_a_year_ago':1}</field>
    </record>

    <record id="vendor_evaluation_view_form_inherit" model="ir.ui.view">
    <field name="name">Vendor Evaluation Form</field>
    <field name="model">vendor.evaluation</field>
    <field name="inherit_id" ref="vendor_evaluation.vendor_evaluation_view_form"/>
    <field name="arch" type="xml">
        <field name="vendor" position="attributes">
            <attribute name="options">{'no_create':True,
                'no_create_edit':True}</attribute>
        </field>
        <xpath expr="//field[@name='business']" position="after">
            <field name="evaluation_template_id" attrs="{'readonly': [('state', 'not in', ['draft'])]}"/>
        </xpath>
        <xpath expr="//div[@name='qualitative_evaluation']" position="inside">
            <field name="evaluation_eval_ids" attrs="{'readonly': [('state', 'not in', ['draft'])]}">
                <tree editable="bottom" create="false">
                    <field name="name"/>
                    <field name="eval_rate" widget="priority" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                    <field name="eval_factor"/>
                    <field name="eval_comment" placeholder="Comments"/>
                    <field name="state" invisible="1"/>
                </tree>
            </field>
        </xpath>
        <xpath expr="//sheet/group[3]" position="attributes">
            <attribute name="string">Qualitative Evaluation</attribute>
        </xpath>
        <field name="date" position="after">
            <field name="fulfillment_avg" invisible="1"/>
            <field name="on_time_rate_avg" invisible="1"/>
            <field name="final_point_avg" invisible="1"/>
        </field>
<!--        <xpath expr="//sheet/group[3]/div[11]" position="attributes">-->
<!--            <attribute name="invisible">1</attribute>-->
<!--        </xpath>-->
        <xpath expr="//group/group[1]" position="inside">
            <!-- Add your fields here -->
            <field name="branch_id" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create':True,'no_create_edit':True}"/>
            <field name="company_id"/>
        </xpath>
        <xpath expr="//sheet/group[2]/group/field[@name='vendor']" position="attributes">
            <attribute name="context">{'res_partner_search_mode': 'supplier', 'show_vat': True, 
                'tree_view_ref': 'equip3_purchase_operation.view_res_partner_line_tree', 
                'default_is_vendor': 1,
                'search_default_supplier': 1}</attribute>
            <attribute name="domain">[('is_vendor', '=', True)]</attribute>
        </xpath>
        <xpath expr="//sheet/group[3]" position="after">
            <group string="Quantitative Evaluation">
                <div>
                    <label for="on_time_rate_check" style="font-weight:bold" class="oe_inline"/>
                    <button name="%(action_purchase_vendor_delay_reports)d" class="oe_link oe_inline" type="action" context="{'search_default_partner_id': vendor}">
                        <span attrs="{'invisible': [('on_time_rate', '&lt;', 0)]}"><field name="on_time_rate" widget="integer" class="oe_inline"/>% On-Time Delivery</span>
                        <span attrs="{'invisible': [('on_time_rate', '&gt;=', 0)]}">No On-time Delivery Data</span>
                    </button>
                </div>
                <div class="o_row border-left" style="padding: 0px 35px 0px 6px;">
                    <field name="on_time_rate_check"/>
                    <field name="on_time_rate_star" widget="priority" attrs="{'invisible': [('on_time_rate_check','!=',True)]}" readonly="True" force_save="1"/>
                    <label for="on_time_rate_factor" attrs="{'invisible': [('on_time_rate_check','!=',True)]}"/>
                    <span><field name="on_time_rate_factor" attrs="{'invisible': [('on_time_rate_check','!=',True)]}" style="width: 25px;"/></span>
                    <field name="on_time_rate_cmt" placeholder="Comments" attrs="{'invisible': [('on_time_rate_check','!=',True)]}"/>
                </div>
                <div>
                    <label for="fulfillment_check" style="font-weight:bold" class="oe_inline"/>
                    <span style="font-weight:bold" ><field name="fulfillment"/> %</span>
                </div>
                <div class="o_row border-left" style="padding: 0px 35px 0px 6px;">
                    <field name="fulfillment_check"/>
                    <field name="fulfillment_star" widget="priority" attrs="{'invisible': [('fulfillment_check','!=',True)]}" readonly="True" force_save="1"/>
                    <label for="fulfillment_factor" attrs="{'invisible': [('fulfillment_check','!=',True)]}"/>
                    <span><field name="fulfillment_factor" attrs="{'invisible': [('fulfillment_check','!=',True)]}" style="width: 25px;"/></span>
                    <field name="fulfillment_cmt" placeholder="Comments" attrs="{'invisible': [('fulfillment_check','!=',True)]}"/>
                </div>
            </group>
            <group>
                <div>
                    <button name="calculate" type="object" string="CALCULATE" class="oe_stat_button"/>
                </div>
            </group>
        </xpath>
    </field>
    </record>

    <!-- vendor.evaluation inherit tree view -->
    <record id="vendor_evaluation_view_tree" model="ir.ui.view">
        <field name="name">vendor.evaluation.inherit.view.tree</field>
        <field name="model">vendor.evaluation</field>
        <field name="inherit_id" ref="vendor_evaluation.vendor_evaluation_view_tree"/>
        <field name="arch" type="xml">
            <!-- Add your xpath here -->
            <xpath expr="//field[@name='state']" position="attributes">
                <attribute name="widget">badge</attribute>
                <attribute name="decoration-info">state in ('draft', 'sent')</attribute>
                <attribute name="decoration-success2">state == 'approved'</attribute>
                <attribute name="decoration-warning">state == 'request'</attribute>
            </xpath>
            <xpath expr="//field[@name='state']" position="after">
                <field name="branch_id"/>
                <field name="company_id"/>
            </xpath>
        </field>
    </record>
</odoo>