<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <data>

        <record id="hr_daily_attendance_paper_format" model="report.paperformat">
            <field name="name">HR Daily Attendance</field>
            <field name="default" eval="True"/>
            <field name="format">A3</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Landscape</field>
            <field name="margin_top">15</field>
            <field name="margin_bottom">0</field>
            <field name="margin_left">10</field>
            <field name="margin_right">10</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">5</field>
            <field name="dpi">80</field>
        </record>

        <record id="action_hr_daily_attendance_report" model="ir.actions.report">
            <field name="name">HR Daily Attendance</field>
            <field name="model">hr.attendance</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">equip3_hr_attendance_extend.hr_daily_attendance_report_pdf</field>
            <field name="report_file">equip3_hr_attendance_extend.hr_daily_attendance_report_pdf</field>
            <field name="paperformat_id" ref="equip3_hr_attendance_extend.hr_daily_attendance_paper_format"/>
            <field name="binding_model_id" eval="False"/>
		    <field name="binding_type">report</field>
        </record>

        <template id="hr_daily_attendance_report_pdf">
            <t t-call="web.html_container">
                <div class="page">
                    <style>
                        body, header, footer {
                        font-family: Arial,Helvetica,sans-serif !important;
                        font-size: 14px;
                        line-height: 1.25 !important;
                        }

                        table, th, td {
                            border-collapse: collapse;
                        }

                        .table th, .table td {
                            padding: 6px !important;
                        }
                    </style>

                    <table class="table" style="width:100%;">
                        <tbody>
                            <tr>
                                <th style="text-align: center; padding: 0; border-top: 0;">Daily Attendance Report</th>
                            </tr>
                            <tr>
                                <th style="text-align: center; padding: 0; border-top: 0;">Period: <span t-esc="period"/></th>
                            </tr>
                            <tr>
                                <th style="text-align: center; padding: 0; border-top: 0;">Attendance Status: <span t-esc="text_att_status"/></th>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-bordered" style="width:100%;">
                        <tbody>
                            <tr>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Date</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Employee</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Employee ID</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Job Position</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Department</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Working Schedule</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Work From</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Work To</th>
                                <th colspan="6" style="border:1px solid black; text-align: center;">Actual Attendance</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Break From</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Break To</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Worked Hours</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Overtime</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Coefficient hours</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Meal Allowance</th>
                                <th rowspan="2" style="border:1px solid black; text-align: center;">Attendance Status</th>
                            </tr>
                            <tr>
                                <th style="border:1px solid black; text-align: center;">Check In</th>
                                <th style="border:1px solid black; text-align: center;">Check In Status</th>
                                <th style="border:1px solid black; text-align: center;">Check In Difference</th>
                                <th style="border:1px solid black; text-align: center;">Check Out</th>
                                <th style="border:1px solid black; text-align: center;">Check Out Status</th>
                                <th style="border:1px solid black; text-align: center;">Check Out Difference</th>
                            </tr>
                            <t t-foreach="attendance_data" t-as="att">
                                <tr>
                                    <td style="border:1px solid black; text-align: center;"><span t-esc="att['date'].strftime('%d/%m/%Y')"/></td>
                                    <td style="border:1px solid black; text-align: left;"><span t-esc="att['employee']"/></td>
                                    <td style="border:1px solid black; text-align: center;"><span t-esc="att['employee_id']"/></td>
                                    <td style="border:1px solid black; text-align: left;"><span t-esc="att['job_position']"/></td>
                                    <td style="border:1px solid black; text-align: left;"><span t-esc="att['department']"/></td>
                                    <td style="border:1px solid black; text-align: left;"><span t-esc="att['working_schedule']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['work_from']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['work_to']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['check_in']"/></td>
                                    <td style="border:1px solid black; text-align: left;"><span t-esc="att['checkin_status']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['check_in_diff']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['check_out']"/></td>
                                    <td style="border:1px solid black; text-align: left;"><span t-esc="att['checkout_status']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['check_out_diff']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['break_from']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['break_to']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['worked_hours']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['overtime']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="att['coefficient_hours']"/></td>
                                    <td style="border:1px solid black; text-align: right;"><span t-esc="'{:,}'.format(att['meal_allowance'])"/></td>
                                    <td style="border:1px solid black; text-align: left;"><span t-esc="att['attendance_status']"/></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </div>
            </t>
        </template>

        <record id="view_hr_daily_attendance_report_attachment" model="ir.ui.view">
            <field name="name">hr.daily.attendance.report.attachment</field>
            <field name="model">hr.daily.attendance.report.attachment</field>
            <field name="arch" type="xml">
                <form string="Attendance Report">
                    <group>
                        <field name="attachment_file" readonly="1" filename="attachment_name"/>
                        <field name="attachment_name" invisible="1"/>
                    </group>
                    <footer>
                        <button special="cancel" string="Close" class="oe_highlight" />
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_hr_daily_attendance_report_attachment" model="ir.actions.act_window">
            <field name="name">Daily Attendance Report Attachment</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.daily.attendance.report.attachment</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref='view_hr_daily_attendance_report_attachment'/>
            <field name="target">new</field>
        </record>

        <record id="view_hr_daily_attendance_report_form" model="ir.ui.view">
            <field name="name">hr.daily.attendance.report.form</field>
            <field name="model">hr.daily.attendance.report</field>
            <field name="arch" type="xml">
                <form string="Daily Attendance Report">
                    <group>
                        <label for="start_date" string="Period"/>
                        <div>
                            <field name="start_date" class="oe_inline"/> -
                            <field name="end_date" class="oe_inline"/>
                        </div>
                        <field name="all_attendance_status"/>
                        <field name="attendance_status" attrs="{'invisible': [('all_attendance_status','=',True)],'required': [('all_attendance_status','=',False)]}"/>
                        <field name="specify_by"/>
                        <field name="all_department" attrs="{'invisible': [('specify_by','!=','department')]}"/>
                        <field name="department_ids" widget="many2many_tags" attrs="{'required': [('specify_by','=','department'),('all_department','=',False)],'invisible': ['|',('specify_by','!=','department'),('all_department','=',True)]}" options="{'no_open': True, 'no_create': True, 'no_create_edit': True}"/>
                        <field name="all_job_position" attrs="{'invisible': [('specify_by','!=','job_position')]}"/>
                        <field name="job_position_ids" widget="many2many_tags" attrs="{'required': [('specify_by','=','job_position'),('all_job_position','=',False)],'invisible': ['|',('specify_by','!=','job_position'),('all_job_position','=',True)]}" options="{'no_open': True, 'no_create': True, 'no_create_edit': True}"/>
                        <field name="all_employee" attrs="{'invisible': [('specify_by','!=','employee')]}"/>
                        <field name="employee_ids" widget="many2many_tags" attrs="{'required': [('specify_by','=','employee'),('all_employee','=',False)],'invisible': ['|',('specify_by','!=','employee'),('all_employee','=',True)]}" options="{'no_open': True, 'no_create': True, 'no_create_edit': True}"/>
                        <field name="file_type"/>
                    </group>
                    <footer>
                        <button name="action_print" string="Print" type="object" class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_view_hr_daily_attendance_report" model="ir.actions.act_window">
            <field name="name">Daily Attendance Report</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.daily.attendance.report</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <menuitem name="Daily Attendance Report" id="hr_daily_attendance_report_menu"
                  parent="hr_attendance.menu_hr_attendance_report"
                  action="action_view_hr_daily_attendance_report"
                  groups="hr_attendance.group_hr_attendance_manager,equip3_hr_employee_access_right_setting.group_hr_attendance_hr_manager"
                  sequence="39"
                  />

    </data>
</odoo>
